from aiohttp import web

import asyncio
import logging
import os
import random
import re
import json
from datetime import datetime, timedelta
from contextlib import asynccontextmanager
from typing import Optional, List, Tuple, Dict

import aiosqlite
from aiogram import Bot, Dispatcher, F
from aiogram.filters import CommandStart, Command
from aiogram.types import (
    Message, CallbackQuery,
    InlineKeyboardMarkup, InlineKeyboardButton,
    ReplyKeyboardMarkup, KeyboardButton,
    FSInputFile,
)
from aiogram.fsm.state import StatesGroup, State
from aiogram.fsm.context import FSMContext

# =========================
# –ù–ê–°–¢–†–û–ô–ö–ò (—á–µ—Ä–µ–∑ ENV ‚Äî –±–µ–∑–æ–ø–∞—Å–Ω–æ –¥–ª—è GitHub/Render)
# =========================
BOT_TOKEN = os.getenv("BOT_TOKEN", "PASTE_NEW_TOKEN_HERE")
ADMIN_ID = int(os.getenv("ADMIN_ID", "0"))

# –Æ–ö–∞—Å—Å–∞ ‚Äî API —á–µ—Ä–µ–∑ REST (shop_id + secret_key –∏–∑ –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞ yukassa.ru)
YUKASSA_SHOP_ID  = os.getenv("YUKASSA_SHOP_ID", "")
YUKASSA_SECRET   = os.getenv("YUKASSA_SECRET", "")

# –ü—É–±–ª–∏—á–Ω—ã–π URL –±–æ—Ç–∞ (Render/ngrok) –¥–ª—è return_url –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã
BOT_PUBLIC_URL = os.getenv("BOT_PUBLIC_URL", "https://t.me/")  # https://t.me/your_bot

DB_PATH = os.getenv("DB_PATH", "bot.db")
WELCOME_IMAGE = os.getenv("WELCOME_IMAGE", "media/welcome.jpg")

# =========================
# –°–õ–û–í–ê–†–ò –ú–ï–î–ò–ê-–§–ê–ô–õ–û–í
# =========================
IMAGE_PATHS = {
    "welcome":      "media2/tech/welcome.jpg",
    "restart":      "media2/tech/restart.jpg",
    "profile":      "media2/tech/profile.jpg",
    "menu":         "media2/tech/menu.jpg",
    # ‚îÄ‚îÄ –†–∞–∑–¥–µ–ª—ã (media/sections/) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    "workouts":     "media2/tech/workouts.jpg",
    "nutrition":    "media2/tech/nutrition.jpg",
    "diary":        "media2/tech/diary.jpg",
    "measurements": "media2/tech/measurements.jpg",
    # ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    "upgrade":      "media2/tech/upgrade.jpg",
    "faq":          "media2/tech/faq.jpg",
}

TECH_GIFS = {
    # ‚îÄ‚îÄ –ù–æ–≥–∏ / –Ω–∏–∂–Ω–∏–π –±–ª–æ–∫ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    "squat":             "media/tech/squat.gif",
    "squat_barbell":     "media/tech/squat_barbell.gif",   # fix: –±—ã–ª squat_barbel.gif
    "squat_sumo":        "media/tech/squat_sumo.gif",
    "squat_bodyweight":  "media/tech/squat_bodyweight.gif",
    "goblet":            "media/tech/goblet.gif",
    "hack_squat":        "media/tech/hack_squat.gif",
    "bulgarian":         "media/tech/bulgarian.gif",
    "lunge":             "media/tech/lunge.gif",
    "lunge_barbell":     "media/tech/lunge_barbell.gif",
    "lunge_dumbbell":    "media/tech/lunge_dumbbell.gif",
    "lunge_walking":     "media/tech/lunge_walking.gif",
    "legpress":          "media/tech/legpress.gif",
    "legcurl":           "media/tech/legcurl.gif",
    "hyperext":          "media/tech/hyperext.gif",
    "hinge":             "media/tech/hinge.gif",
    "calves":            "media/tech/calves.gif",
    # ‚îÄ‚îÄ –ì—Ä—É–¥—å / –∂–∏–º ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    "bench":             "media/tech/bench.gif",
    "bench_dumbbell":    "media/tech/bench_dumbbell.gif",
    "bench_machine":     "media/tech/bench_machine.gif",
    "incline_press":     "media/tech/incline_press.gif",
    "incline_press_barbell":  "media/tech/incline_press_barbell.gif",
    "incline_press_dumbbell": "media/tech/incline_press_dumbbell.gif",
    "chest_fly":         "media/tech/chest_fly.gif",
    "crossover":         "media/tech/crossover.gif",
    # ‚îÄ‚îÄ –°–ø–∏–Ω–∞ / —Ç—è–≥–∞ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    "latpulldown":       "media/tech/latpulldown.gif",
    "latpulldown_wide":  "media/tech/latpulldown_wide.gif",
    "latpulldown_narrow": "media/tech/latpulldown_narrow.gif",
    "pullup":            "media/tech/pullup.gif",
    "pullup_chinup":     "media/tech/pullup_chinup.gif",
    "pullup_wide":       "media/tech/pullup_wide.gif",
    "rowtrain":          "media/tech/rowtrain.gif",
    "dumbbell_row":      "media/tech/dumbbell_row.gif",
    "barbell_row":       "media/tech/barbell_row.gif",
    "band_row":          "media/tech/band_row.gif",
    "band_pull":         "media/tech/band_pull.gif",
    "face_pull":         "media/tech/face_pull.gif",
    "rear_delt":         "media/tech/rear_delt.gif",
    # ‚îÄ‚îÄ –¢—è–≥–∞ / –ø–æ—è—Å–Ω–∏—Ü–∞ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    "rdl":               "media/tech/rdl.gif",
    "rdl_barbell":       "media/tech/rdl_barbell.gif",
    "rdl_dumbbell":      "media/tech/rdl_dumbbell.gif",
    "deadlift":          "media/tech/deadlift.gif",
    "deadlift_sumo":     "media/tech/deadlift_sumo.gif",
    "good_morning":      "media/tech/good_morning.gif",
    # ‚îÄ‚îÄ –ü–ª–µ—á–∏ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    "ohp":               "media/tech/ohp.gif",
    "ohp_barbell":       "media/tech/ohp_barbell.gif",
    "ohp_dumbbell":      "media/tech/ohp_dumbbell.gif",
    "ohp_machine":       "media/tech/ohp_machine.gif",
    "band_ohp":          "media/tech/band_ohp.gif",
    "lateralraise":      "media/tech/lateralraise.gif",
    "pike_pushup":       "media/tech/pike_pushup.gif",
    # ‚îÄ‚îÄ –ë–∏—Ü–µ–ø—Å / —Ç—Ä–∏—Ü–µ–ø—Å ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    "biceps":            "media/tech/biceps.gif",
    "biceps_barbell":    "media/tech/biceps_barbell.gif",
    "hammer":            "media/tech/hammer.gif",
    "triceps":           "media/tech/triceps.gif",
    "triceps_oh":        "media/tech/triceps_oh.gif",
    "narrow_pushup":     "media/tech/narrow_pushup.gif",
    # ‚îÄ‚îÄ –ö–æ—Ä / –ø—Ä–µ—Å—Å ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    "core":              "media/tech/core.gif",
    "side_plank":        "media/tech/side_plank.gif",
    "hanging_leg_raise": "media/tech/hanging_leg_raise.gif",
    "leg_raise_lying":   "media/tech/leg_raise_lying.gif",
    "elbow_leg_raise":   "media/tech/elbow_leg_raise.gif",
    "ab_crunch":         "media/tech/ab_crunch.gif",
    "ab_rollout":        "media/tech/ab_rollout.gif",
    # ‚îÄ‚îÄ –†–∞–∑–Ω–æ–µ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    "pushup":            "media/tech/pushup.gif",  # "row" = –æ—Ç–∂–∏–º–∞–Ω–∏—è (—Ç–∞–∫ –≤ —Ñ–∞–π–ª–µ)
}

# =========================
# –ö–ê–ù–û–ù–ò–ß–ï–°–ö–ò–ï –ù–ê–ó–í–ê–ù–ò–Ø –£–ü–†–ê–ñ–ù–ï–ù–ò–ô
# =========================
EXERCISE_NAMES = {
    # –ù–æ–≥–∏ / –Ω–∏–∂–Ω–∏–π –±–ª–æ–∫
    "squat":             "–ü—Ä–∏—Å–µ–¥",
    "squat_barbell":     "–ü—Ä–∏—Å–µ–¥ —Å–æ —à—Ç–∞–Ω–≥–æ–π",
    "squat_bodyweight":  "–ü—Ä–∏—Å–µ–¥ (—Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–µ—Å)",
    "squat_sumo":        "–ü—Ä–∏—Å–µ–¥ —Å—É–º–æ",
    "goblet":            "–ì–æ–±–ª–µ—Ç-–ø—Ä–∏—Å–µ–¥",
    "hack_squat":        "–•–∞–∫–∫-–ø—Ä–∏—Å–µ–¥",
    "bulgarian":         "–ë–æ–ª–≥–∞—Ä—Å–∫–∏–µ –≤—ã–ø–∞–¥—ã",
    "lunge":             "–í—ã–ø–∞–¥—ã",
    "lunge_barbell":     "–í—ã–ø–∞–¥—ã —Å–æ —à—Ç–∞–Ω–≥–æ–π",
    "lunge_dumbbell":    "–í—ã–ø–∞–¥—ã —Å –≥–∞–Ω—Ç–µ–ª—è–º–∏",
    "lunge_walking":     "–í—ã–ø–∞–¥—ã —Ö–æ–¥—å–±–æ–π",
    "legpress":          "–ñ–∏–º –Ω–æ–≥–∞–º–∏",
    "legcurl":           "–°–≥–∏–±–∞–Ω–∏—è –Ω–æ–≥",
    "hyperext":          "–ì–∏–ø–µ—Ä—ç–∫—Å—Ç–µ–Ω–∑–∏—è",
    "hinge":             "–Ø–≥–æ–¥–∏—á–Ω—ã–π –º–æ—Å—Ç",
    "calves":            "–ü–æ–¥—ä—ë–º—ã –Ω–∞ –Ω–æ—Å–∫–∏",
    # –ì—Ä—É–¥—å / –∂–∏–º
    "bench":             "–ñ–∏–º –ª—ë–∂–∞",
    "bench_dumbbell":    "–ñ–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π –ª—ë–∂–∞",
    "bench_machine":     "–ñ–∏–º –≤ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–µ (–≥—Ä—É–¥—å)",
    "incline_press":     "–ñ–∏–º –ø–æ–¥ —É–≥–ª–æ–º (incline)",
    "incline_press_barbell":  "–ñ–∏–º –ø–æ–¥ —É–≥–ª–æ–º (—à—Ç–∞–Ω–≥–∞)",
    "incline_press_dumbbell": "–ñ–∏–º –ø–æ–¥ —É–≥–ª–æ–º (–≥–∞–Ω—Ç–µ–ª–∏)",
    "chest_fly":         "–†–∞–∑–≤–µ–¥–µ–Ω–∏—è –Ω–∞ –≥—Ä—É–¥—å",
    "crossover":         "–ö—Ä–æ—Å—Å–æ–≤–µ—Ä",
    # –°–ø–∏–Ω–∞ / —Ç—è–≥–∞
    "latpulldown":       "–¢—è–≥–∞ –≤–µ—Ä—Ö–Ω–µ–≥–æ –±–ª–æ–∫–∞",
    "latpulldown_wide":  "–¢—è–≥–∞ –≤–µ—Ä—Ö–Ω–µ–≥–æ –±–ª–æ–∫–∞ —à–∏—Ä–æ–∫–∏–º —Ö–≤–∞—Ç–æ–º",
    "latpulldown_narrow":"–¢—è–≥–∞ –≤–µ—Ä—Ö–Ω–µ–≥–æ –±–ª–æ–∫–∞ —É–∑–∫–∏–º —Ö–≤–∞—Ç–æ–º",
    "pullup":            "–ü–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è",
    "pullup_chinup":     "–ü–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è –æ–±—Ä–∞—Ç–Ω—ã–º —Ö–≤–∞—Ç–æ–º",
    "pullup_wide":       "–ü–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è —à–∏—Ä–æ–∫–∏–º —Ö–≤–∞—Ç–æ–º",
    "rowtrain":          "–¢—è–≥–∞ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –±–ª–æ–∫–∞",
    "dumbbell_row":      "–¢—è–≥–∞ –≥–∞–Ω—Ç–µ–ª–∏",
    "barbell_row":       "–¢—è–≥–∞ —à—Ç–∞–Ω–≥–∏ –≤ –Ω–∞–∫–ª–æ–Ω–µ",
    "band_row":          "–¢—è–≥–∞ —Ä–µ–∑–∏–Ω–∫–∏",
    "band_pull":         "–¢—è–≥–∞ —Ä–µ–∑–∏–Ω–∫–∏ —Å–≤–µ—Ä—Ö—É",
    "face_pull":         "Face Pull",
    "rear_delt":         "–ó–∞–¥–Ω—è—è –¥–µ–ª—å—Ç–∞",
    # –¢—è–≥–∞ / –ø–æ—è—Å–Ω–∏—Ü–∞
    "rdl":               "–†—É–º—ã–Ω—Å–∫–∞—è —Ç—è–≥–∞",
    "rdl_barbell":       "–†—É–º—ã–Ω—Å–∫–∞—è —Ç—è–≥–∞ —Å–æ —à—Ç–∞–Ω–≥–æ–π",
    "rdl_dumbbell":      "–†—É–º—ã–Ω—Å–∫–∞—è —Ç—è–≥–∞ —Å –≥–∞–Ω—Ç–µ–ª—è–º–∏",
    "deadlift":          "–°—Ç–∞–Ω–æ–≤–∞—è —Ç—è–≥–∞",
    "deadlift_sumo":     "–°—Ç–∞–Ω–æ–≤–∞—è —Ç—è–≥–∞ —Å—É–º–æ",
    "good_morning":      "Good Morning",
    # –ü–ª–µ—á–∏
    "ohp":               "–ñ–∏–º –≤–≤–µ—Ä—Ö",
    "ohp_barbell":       "–ñ–∏–º —à—Ç–∞–Ω–≥–∏ —Å—Ç–æ—è (OHP)",
    "ohp_dumbbell":      "–ñ–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π —Å—Ç–æ—è/—Å–∏–¥—è",
    "ohp_machine":       "–ñ–∏–º –≤ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–µ –≤–≤–µ—Ä—Ö",
    "band_ohp":          "–ñ–∏–º —Ä–µ–∑–∏–Ω–∫–∏ –≤–≤–µ—Ä—Ö",
    "lateralraise":      "–†–∞–∑–≤–µ–¥–µ–Ω–∏—è –≤ —Å—Ç–æ—Ä–æ–Ω—ã",
    "pike_pushup":       "–ü–∞–π–∫-–æ—Ç–∂–∏–º–∞–Ω–∏—è",
    # –ë–∏—Ü–µ–ø—Å / —Ç—Ä–∏—Ü–µ–ø—Å
    "biceps":            "–ë–∏—Ü–µ–ø—Å —Å–≥–∏–±–∞–Ω–∏—è",
    "biceps_barbell":    "–°–≥–∏–±–∞–Ω–∏—è —Å–æ —à—Ç–∞–Ω–≥–æ–π (–±–∏—Ü–µ–ø—Å)",
    "hammer":            "–ú–æ–ª–æ—Ç–∫–∏",
    "triceps":           "–¢—Ä–∏—Ü–µ–ø—Å –Ω–∞ –±–ª–æ–∫–µ",
    "triceps_oh":        "–†–∞–∑–≥–∏–±–∞–Ω–∏–µ —Ç—Ä–∏—Ü–µ–ø—Å–∞ –∏–∑-–∑–∞ –≥–æ–ª–æ–≤—ã",
    "narrow_pushup":     "–û—Ç–∂–∏–º–∞–Ω–∏—è —É–∑–∫–∏–µ",
    # –ö–æ—Ä / –ø—Ä–µ—Å—Å
    "core":              "–ü–ª–∞–Ω–∫–∞",
    "side_plank":        "–ë–æ–∫–æ–≤–∞—è –ø–ª–∞–Ω–∫–∞",
    "hanging_leg_raise": "–ü–æ–¥—ä—ë–º—ã –Ω–æ–≥ –≤ –≤–∏—Å–µ",
    "leg_raise_lying":   "–ü–æ–¥—ä—ë–º—ã –Ω–æ–≥ –ª—ë–∂–∞",
    "elbow_leg_raise":   "–ü–æ–¥—ä—ë–º—ã –Ω–æ–≥ –≤ —É–ø–æ—Ä–µ –Ω–∞ –ª–æ–∫—Ç—è—Ö",
    "ab_crunch":         "–°–∫—Ä—É—á–∏–≤–∞–Ω–∏—è (–ø—Ä–µ—Å—Å)",
    "ab_rollout":        "–†–æ–ª–∏–∫ –¥–ª—è –ø—Ä–µ—Å—Å–∞",
    # –†–∞–∑–Ω–æ–µ
    "row":               "–û—Ç–∂–∏–º–∞–Ω–∏—è",  # "row" –≤ —ç—Ç–æ–º —Ñ–∞–π–ª–µ = –æ—Ç–∂–∏–º–∞–Ω–∏—è
}

# –¢–ê–†–ò–§–´
TARIFFS = {
    "trial": {"title": "–ü—Ä–æ–±–Ω—ã–π –¥–æ—Å—Ç—É–ø (3 –¥–Ω—è)", "days": 3,    "price": 1,    "plan_regens": 1},
    "t1":    {"title": "1 –º–µ—Å—è—Ü",                "days": 30,   "price": 2,  "plan_regens": 3},
    "t3":    {"title": "3 –º–µ—Å—è—Ü–∞",               "days": 90,   "price": 3,  "plan_regens": 10},
    "life":  {"title": "–ù–∞–≤—Å–µ–≥–¥–∞",               "days": None, "price": 1990, "plan_regens": None},
}

# –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø (–ø–∏—Ç–∞–Ω–∏–µ + –≤—Å–µ —Ü–µ–ª–∏ + —Å–º–µ–Ω–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã) —Ç–æ–ª—å–∫–æ –Ω–∞ t3 –∏ life
FULL_ACCESS_TARIFFS = {"t3", "life"}

TG_SAFE_MSG_LEN = 3800

MIN_DAYS = 3
MAX_DAYS = 5

logging.basicConfig(level=logging.INFO)
logger = logging.getLogger("trainer_bot")


# =========================
# FSM
# =========================
class PaymentFlow(StatesGroup):
    choose_tariff = State()
    waiting_receipt = State()


class DiaryFlow(StatesGroup):
    choosing_exercise = State()
    enter_sets = State()


class MeasureFlow(StatesGroup):
    choose_type = State()
    enter_value = State()


class PostFlow(StatesGroup):
    waiting_content = State()
    waiting_confirm = State()


class ProfileWizard(StatesGroup):
    goal = State()
    sex = State()
    age = State()
    height = State()
    weight = State()
    place = State()
    exp = State()
    freq = State()
    meals = State()
    limits = State()


class ProfileFieldEdit(StatesGroup):
    """–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—è –ø—Ä–æ—Ñ–∏–ª—è."""
    age = State()
    height = State()
    weight = State()
    limits = State()


# =========================
# ‚úÖ –¢–ï–•–ù–ò–ö–ò –í–´–ü–û–õ–ù–ï–ù–ò–Ø
# =========================
TECH = {
    "squat": {
        "title": "–ü—Ä–∏—Å–µ–¥",
        "img": "media/tech/squat.jpg",
        "text": (
            "üìö –ü—Ä–∏—Å–µ–¥ (–±–µ–∑–æ–ø–∞—Å–Ω–æ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ)\n\n"
            "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞\n"
            "‚Ä¢ –°—Ç–æ–ø—ã: —à–∏—Ä–∏–Ω–∞ –ø–ª–µ—á, –Ω–æ—Å–∫–∏ —Å–ª–µ–≥–∫–∞ –Ω–∞—Ä—É–∂—É.\n"
            "‚Ä¢ –ö–æ—Ä–ø—É—Å: –≤–¥–æ—Ö ¬´–≤ –∂–∏–≤–æ—Ç¬ª, –ø—Ä–µ—Å—Å –≤ —Ç–æ–Ω—É—Å–µ.\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –£–≤–æ–¥–∏ —Ç–∞–∑ –Ω–∞–∑–∞–¥ –∏ –≤–Ω–∏–∑ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.\n"
            "2) –ö–æ–ª–µ–Ω–∏ –∏–¥—É—Ç –ø–æ –ª–∏–Ω–∏–∏ –Ω–æ—Å–∫–æ–≤ (–Ω–µ –∑–∞–≤–∞–ª–∏–≤–∞—é—Ç—Å—è –≤–Ω—É—Ç—Ä—å).\n"
            "3) –°–ø–∏–Ω–∞ —Ä–æ–≤–Ω–∞—è, –≤–µ—Å –Ω–∞ –ø—è—Ç–∫–µ/—Å–µ—Ä–µ–¥–∏–Ω–µ —Å—Ç–æ–ø—ã.\n"
            "4) –í–Ω–∏–∑—É ‚Äî –∫–æ–Ω—Ç—Ä–æ–ª—å, –±–µ–∑ ¬´–ø—Ä–æ–≤–∞–ª–∞¬ª.\n"
            "5) –í—Å—Ç–∞–≤–∞–π, —Ç–æ–ª–∫–∞—è –ø–æ–ª –Ω–æ–≥–∞–º–∏ (–∫–æ–ª–µ–Ω–∏ –Ω–µ ¬´–∑–∞–º–∫–æ–º¬ª).\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –ö–æ–ª–µ–Ω–∏ –≤–Ω—É—Ç—Ä—å ‚Üí —Å–Ω–∏–∑—å –≤–µ—Å, –¥—É–º–∞–π ¬´—Ä–∞–∑–¥–≤–∏–≥–∞—é –ø–æ–ª¬ª.\n"
            "‚Ä¢ –ü—è—Ç–∫–∏ –æ—Ç—Ä—ã–≤–∞—é—Ç—Å—è ‚Üí —á—É—Ç—å —à–∏—Ä–µ —Å—Ç–æ–π–∫–∞/–º–µ–Ω—å—à–µ –≥–ª—É–±–∏–Ω–∞.\n"
            "‚Ä¢ –ü–æ—è—Å–Ω–∏—Ü–∞ –æ–∫—Ä—É–≥–ª—è–µ—Ç—Å—è ‚Üí –º–µ–Ω—å—à–µ –≥–ª—É–±–∏–Ω–∞, —Å–∏–ª—å–Ω–µ–µ –∫–æ—Ä–ø—É—Å.\n\n"
            "üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞\n"
            "–ï—Å–ª–∏ –¥–∏—Å–∫–æ–º—Ñ–æ—Ä—Ç –≤ –∫–æ–ª–µ–Ω—è—Ö/—Å–ø–∏–Ω–µ ‚Äî –¥–µ–ª–∞–π –≤–∞—Ä–∏–∞–Ω—Ç: –≥–æ–±–ª–µ—Ç-–ø—Ä–∏—Å–µ–¥ –∏–ª–∏ –∂–∏–º –Ω–æ–≥–∞–º–∏."
        )
    },
    "bench": {
        "title": "–ñ–∏–º –ª—ë–∂–∞",
        "img": "media/tech/bench.jpg",
        "text": (
            "üìö –ñ–∏–º –ª—ë–∂–∞ (–≥—Ä—É–¥—å + —Ç—Ä–∏—Ü–µ–ø—Å, –±–µ–∑ –±–æ–ª–∏ –≤ –ø–ª–µ—á–∞—Ö)\n\n"
            "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞\n"
            "‚Ä¢ –õ–æ–ø–∞—Ç–∫–∏: —Å–≤—ë–ª –∏ –ø—Ä–∏–∂–∞–ª –∫ –ª–∞–≤–∫–µ.\n"
            "‚Ä¢ –°—Ç–æ–ø—ã: —É—Å—Ç–æ–π—á–∏–≤–æ –Ω–∞ –ø–æ–ª—É.\n"
            "‚Ä¢ –•–≤–∞—Ç: —Ç–∞–∫, —á—Ç–æ–±—ã –≤–Ω–∏–∑—É –ø—Ä–µ–¥–ø–ª–µ—á—å—è –±—ã–ª–∏ –ø–æ—á—Ç–∏ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã.\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –°–Ω–∏–º–∏ —à—Ç–∞–Ω–≥—É, —É–¥–µ—Ä–∂–∏–≤–∞–π –ª–æ–ø–∞—Ç–∫–∏ —Å–≤–µ–¥—ë–Ω–Ω—ã–º–∏.\n"
            "2) –û–ø—É—Å–∫–∞–π –∫ –Ω–∏–∂–Ω–µ–π —á–∞—Å—Ç–∏ –≥—Ä—É–¥–∏ –ø–æ–¥ –∫–æ–Ω—Ç—Ä–æ–ª–µ–º.\n"
            "3) –õ–æ–∫—Ç–∏ –¥–µ—Ä–∂–∏ ~45¬∞ –∫ –∫–æ—Ä–ø—É—Å—É (–Ω–µ 90¬∞ –≤ —Å—Ç–æ—Ä–æ–Ω—ã).\n"
            "4) –ñ–º–∏ –≤–≤–µ—Ä—Ö –∏ —á—É—Ç—å –Ω–∞–∑–∞–¥ (–∫ —Å—Ç–æ–π–∫–∞–º), –±–µ–∑ —Ä—ã–≤–∫–∞.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –ü–ª–µ—á–∏ ¬´–≤–ø–µ—Ä—ë–¥¬ª ‚Üí —Å–Ω–æ–≤–∞ —Å–≤–µ–¥–∏ –ª–æ–ø–∞—Ç–∫–∏.\n"
            "‚Ä¢ –û—Ç–±–∏–≤ –æ—Ç –≥—Ä—É–¥–∏ ‚Üí –∑–∞–º–µ–¥–ª–∏ –Ω–µ–≥–∞—Ç–∏–≤.\n"
            "‚Ä¢ –°–ª–∏—à–∫–æ–º —à–∏—Ä–æ–∫–∏–π —Ö–≤–∞—Ç ‚Üí –ø–ª–µ—á–∏ —á–∞—â–µ –±–æ–ª—è—Ç.\n\n"
            "üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞\n"
            "–ï—Å–ª–∏ –ø–ª–µ—á–æ –∫–∞–ø—Ä–∏–∑–Ω–∏—á–∞–µ—Ç ‚Äî –ø–æ–ø—Ä–æ–±—É–π –∂–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π –∏–ª–∏ —Ç—Ä–µ–Ω–∞–∂—ë—Ä."
        )
    },
    "row": {
        "title": "–û—Ç–∂–∏–º–∞–Ω–∏—è",
        "img": "media/tech/pushup.jpg",
        "text": (
            "üìö –û—Ç–∂–∏–º–∞–Ω–∏—è (–∫–æ—Ä–ø—É—Å + –≥—Ä—É–¥—å, –ø—Ä–∞–≤–∏–ª—å–Ω–æ)\n\n"
            "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞\n"
            "‚Ä¢ –õ–∞–¥–æ–Ω–∏ –ø–æ–¥ –ø–ª–µ—á–∞–º–∏ (–º–æ–∂–Ω–æ —á—É—Ç—å —à–∏—Ä–µ).\n"
            "‚Ä¢ –ö–æ—Ä–ø—É—Å ¬´–¥–æ—Å–∫–æ–π¬ª: –ø—Ä–µ—Å—Å + —è–≥–æ–¥–∏—Ü—ã –≤–∫–ª—é—á–µ–Ω—ã.\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –û–ø—É—Å–∫–∞–π—Å—è, —Å–æ—Ö—Ä–∞–Ω—è—è –ø—Ä—è–º—É—é –ª–∏–Ω–∏—é —Ç–µ–ª–∞.\n"
            "2) –õ–æ–∫—Ç–∏ –∏–¥—É—Ç –Ω–∞–∑–∞–¥ –ø–æ–¥ —É–≥–ª–æ–º (–Ω–µ —Ä–∞–∑–≤–æ–¥–∏ –≤ —Å—Ç–æ—Ä–æ–Ω—ã).\n"
            "3) –í–Ω–∏–∑—É ‚Äî –∫–æ—Ä–æ—Ç–∫–∞—è –ø–∞—É–∑–∞, –∑–∞—Ç–µ–º –≤—ã–∂–∏–º–∞–π –ø–æ–ª.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –ü—Ä–æ–≤–∞–ª –≤ –ø–æ—è—Å–Ω–∏—Ü–µ ‚Üí –Ω–∞–ø—Ä—è–≥–∏ –ø—Ä–µ—Å—Å/—è–≥–æ–¥–∏—Ü—ã.\n"
            "‚Ä¢ –ì–æ–ª–æ–≤–∞ –≤–Ω–∏–∑ ‚Üí —Å–º–æ—Ç—Ä–∏ —á—É—Ç—å –≤–ø–µ—Ä–µ–¥.\n\n"
            "üí° –£–ø—Ä–æ—â–µ–Ω–∏–µ/—É—Å–ª–æ–∂–Ω–µ–Ω–∏–µ\n"
            "‚Ä¢ –õ–µ–≥—á–µ: –æ—Ç –ª–∞–≤–∫–∏/—Å—Ç–æ–ª–∞.\n"
            "‚Ä¢ –¢—è–∂–µ–ª–µ–µ: –Ω–æ–≥–∏ –Ω–∞ –æ–ø–æ—Ä—É –∏–ª–∏ –ø–∞—É–∑–∞ 1‚Äì2 —Å–µ–∫ –≤–Ω–∏–∑—É."
        )
    },
    "latpulldown": {
        "title": "–¢—è–≥–∞ –≤–µ—Ä—Ö–Ω–µ–≥–æ –±–ª–æ–∫–∞",
        "img": "media/tech/latpulldown.jpg",
        "text": (
            "üìö –¢—è–≥–∞ –≤–µ—Ä—Ö–Ω–µ–≥–æ –±–ª–æ–∫–∞ (—Å–ø–∏–Ω–∞, –Ω–µ –±–∏—Ü–µ–ø—Å)\n\n"
            "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞\n"
            "‚Ä¢ –°—è–¥—å —É—Å—Ç–æ–π—á–∏–≤–æ, –≥—Ä—É–¥—å ¬´–≤–ø–µ—Ä—ë–¥¬ª, –ø–ª–µ—á–∏ –æ–ø—É—Å—Ç–∏ –≤–Ω–∏–∑.\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –ù–∞—á–Ω–∏ –¥–≤–∏–∂–µ–Ω–∏–µ –ª–æ–ø–∞—Ç–∫–∞–º–∏: –≤–Ω–∏–∑/–∫ –∫–∞—Ä–º–∞–Ω–∞–º.\n"
            "2) –¢—è–Ω–∏ –ª–æ–∫—Ç–∏ –≤–Ω–∏–∑ –∏ –Ω–∞–∑–∞–¥.\n"
            "3) –ì—Ä–∏—Ñ –∫ –≤–µ—Ä—Ö–Ω–µ–π —á–∞—Å—Ç–∏ –≥—Ä—É–¥–∏ (–±–µ–∑ —Ä–∞—Å–∫–∞—á–∫–∏).\n"
            "4) –í–≤–µ—Ä—Ö ‚Äî –º–µ–¥–ª–µ–Ω–Ω–æ, –¥–æ —Ä–∞—Å—Ç—è–∂–µ–Ω–∏—è —à–∏—Ä–æ—á–∞–π—à–∏—Ö.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –¢—è–Ω–µ—à—å —Ä—É–∫–∞–º–∏ ‚Üí –¥—É–º–∞–π ¬´–ª–æ–∫—Ç–∏ –≤–Ω–∏–∑¬ª.\n"
            "‚Ä¢ –†–∞—Å–∫–∞—á–∫–∞ –∫–æ—Ä–ø—É—Å–æ–º ‚Üí —Å–Ω–∏–∑—å –≤–µ—Å.\n\n"
            "üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞\n"
            "–ï—Å–ª–∏ –Ω–µ —á—É–≤—Å—Ç–≤—É–µ—à—å —Å–ø–∏–Ω—É ‚Äî —Å–¥–µ–ª–∞–π –ø–∞—É–∑—É 1 —Å–µ–∫ –≤–Ω–∏–∑—É."
        )
    },
    "pullup": {
        "title": "–ü–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è",
        "img": "media/tech/pullup.jpg",
        "text": (
            "üìö –ü–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è (—á–∏—Å—Ç–æ, –±–µ–∑ —á–∏—Ç–∏–Ω–≥–∞)\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –°—Ç–∞—Ä—Ç: –ø–ª–µ—á–∏ –≤–Ω–∏–∑ (–æ—Ç —É—à–µ–π), –ª–æ–ø–∞—Ç–∫–∏ –≤–∫–ª—é—á–∏–ª–∏—Å—å.\n"
            "2) –¢—è–Ω–∏ –ª–æ–∫—Ç–∏ –∫ —Ä—ë–±—Ä–∞–º, –≥—Ä—É–¥—å –∫ –ø–µ—Ä–µ–∫–ª–∞–¥–∏–Ω–µ.\n"
            "3) –í–≤–µ—Ä—Ö –±–µ–∑ —Ä—ã–≤–∫–∞, –≤–Ω–∏–∑ ‚Äî –º–µ–¥–ª–µ–Ω–Ω–æ 2‚Äì3 —Å–µ–∫.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –î—ë—Ä–≥–∞–µ—à—å—Å—è –∫–æ—Ä–ø—É—Å–æ–º ‚Üí –¥–µ–ª–∞–π –º–µ–¥–ª–µ–Ω–Ω–µ–µ/—Ä–µ–∑–∏–Ω–∫–∞.\n"
            "‚Ä¢ –ü–ª–µ—á–∏ –≤–≤–µ—Ä—Ö ‚Üí —Å–Ω–∞—á–∞–ª–∞ –ª–æ–ø–∞—Ç–∫–∏ –≤–Ω–∏–∑.\n\n"
            "üí° –ï—Å–ª–∏ –ø–æ–∫–∞ —Ç—è–∂–µ–ª–æ\n"
            "–†–µ–∑–∏–Ω–∫–∞/–≥—Ä–∞–≤–∏—Ç—Ä–æ–Ω –∏–ª–∏ –Ω–µ–≥–∞—Ç–∏–≤—ã: –∑–∞–ø—Ä—ã–≥–Ω—É–ª ‚Äî –º–µ–¥–ª–µ–Ω–Ω–æ –æ–ø—É—Å—Ç–∏–ª—Å—è."
        )
    },
    "rdl": {
        "title": "–†—É–º—ã–Ω—Å–∫–∞—è —Ç—è–≥–∞",
        "img": "media/tech/rdl.jpg",
        "text": (
            "üìö –†—É–º—ã–Ω—Å–∫–∞—è —Ç—è–≥–∞ (–∑–∞–¥–Ω—è—è –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å –±–µ–¥—Ä–∞)\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –ö–æ–ª–µ–Ω–∏ —Å–ª–µ–≥–∫–∞ —Å–æ–≥–Ω—É—Ç—ã –∏ –ø–æ—á—Ç–∏ –Ω–µ –º–µ–Ω—è—é—Ç—Å—è.\n"
            "2) –î–≤–∏–∂–µ–Ω–∏–µ ‚Äî —Ç–∞–∑ –Ω–∞–∑–∞–¥, —Å–ø–∏–Ω–∞ —Ä–æ–≤–Ω–∞—è.\n"
            "3) –°–Ω–∞—Ä—è–¥ –∏–¥—ë—Ç –±–ª–∏–∑–∫–æ –∫ –Ω–æ–≥–∞–º.\n"
            "4) –û–ø—É—Å–∫–∞–π—Å—è –¥–æ —Å–∏–ª—å–Ω–æ–≥–æ –Ω–∞—Ç—è–∂–µ–Ω–∏—è –≤ –±—ë–¥—Ä–∞—Ö.\n"
            "5) –í–≤–µ—Ä—Ö ‚Äî —Ç–∞–∑ –≤–ø–µ—Ä—ë–¥, –±–µ–∑ –ø–µ—Ä–µ–≥–∏–±–∞ –ø–æ—è—Å–Ω–∏—Ü—ã.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –ö—Ä—É–≥–ª–∞—è —Å–ø–∏–Ω–∞ ‚Üí —É–∫–æ—Ä–æ—Ç–∏ –∞–º–ø–ª–∏—Ç—É–¥—É.\n"
            "‚Ä¢ –ü—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –ø—Ä–∏—Å–µ–¥ ‚Üí –º–µ–Ω—å—à–µ —Å–≥–∏–±–∞–π –∫–æ–ª–µ–Ω–∏.\n\n"
            "üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞\n"
            "–ß—É–≤—Å—Ç–≤—É–µ—à—å –±—ë–¥—Ä–∞/—è–≥–æ–¥–∏—Ü—ã ‚Äî –≤—Å—ë –ø—Ä–∞–≤–∏–ª—å–Ω–æ. –ï—Å–ª–∏ –ø–æ—è—Å–Ω–∏—Ü—É ‚Äî —Å–Ω–∏–∑—å –≤–µ—Å."
        )
    },
    "ohp": {
        "title": "–ñ–∏–º –≤–≤–µ—Ä—Ö",
        "img": "media/tech/ohp.jpg",
        "text": (
            "üìö –ñ–∏–º –≤–≤–µ—Ä—Ö (–ø–ª–µ—á–∏, –±–µ–∑ –ª–æ–º–∞–Ω–∏—è –ø–æ—è—Å–Ω–∏—Ü—ã)\n\n"
            "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞\n"
            "‚Ä¢ –ü—Ä–µ—Å—Å –Ω–∞–ø—Ä—è–≥, —Ä—ë–±—Ä–∞ ¬´–≤–Ω–∏–∑¬ª.\n"
            "‚Ä¢ –Ø–≥–æ–¥–∏—Ü—ã –≤–∫–ª—é—á–µ–Ω—ã ‚Äî –∫–æ—Ä–ø—É—Å —Å—Ç–∞–±–∏–ª–µ–Ω.\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –ñ–º–∏ –≤–≤–µ—Ä—Ö –∏ —á—É—Ç—å –Ω–∞–∑–∞–¥ (—à—Ç–∞–Ω–≥–∞ –±–ª–∏–∑–∫–æ –∫ –ª–∏—Ü—É).\n"
            "2) –í–≤–µ—Ä—Ö—É –≥–æ–ª–æ–≤–∞ ¬´–≤ –æ–∫–Ω–æ¬ª –ø–æ–¥ —Å–Ω–∞—Ä—è–¥.\n"
            "3) –í–Ω–∏–∑ ‚Äî –º–µ–¥–ª–µ–Ω–Ω–æ, –≤ –∫–æ–Ω—Ç—Ä–æ–ª—å.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –ü—Ä–æ–≥–∏–± –≤ –ø–æ—è—Å–Ω–∏—Ü–µ ‚Üí —Å–Ω–∏–∑—å –≤–µ—Å, —Å–∏–ª—å–Ω–µ–µ –∫–æ—Ä–ø—É—Å.\n"
            "‚Ä¢ –õ–æ–∫—Ç–∏ —É–µ—Ö–∞–ª–∏ –Ω–∞–∑–∞–¥ ‚Üí –¥–µ—Ä–∂–∏ –ø–æ–¥ –≥—Ä–∏—Ñ–æ–º.\n\n"
            "üí° –ï—Å–ª–∏ –ø–ª–µ—á–æ –±–æ–ª–∏—Ç\n"
            "–£–º–µ–Ω—å—à–∏ –∞–º–ø–ª–∏—Ç—É–¥—É, –ø–æ–ø—Ä–æ–±—É–π –≥–∞–Ω—Ç–µ–ª–∏ –∏–ª–∏ –∂–∏–º –≤ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–µ."
        )
    },
    "lateralraise": {
        "title": "–†–∞–∑–≤–µ–¥–µ–Ω–∏—è –≤ —Å—Ç–æ—Ä–æ–Ω—ã",
        "img": "media/tech/lateralraise.jpg",
        "text": (
            "üìö –†–∞–∑–≤–µ–¥–µ–Ω–∏—è –≤ —Å—Ç–æ—Ä–æ–Ω—ã (—Å—Ä–µ–¥–Ω—è—è –¥–µ–ª—å—Ç–∞)\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –ü–ª–µ—á–∏ –≤–Ω–∏–∑, –∫–æ—Ä–ø—É—Å —Å—Ç–∞–±–∏–ª–µ–Ω.\n"
            "2) –õ–æ–∫–æ—Ç—å —Å–ª–µ–≥–∫–∞ —Å–æ–≥–Ω—É—Ç –∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω.\n"
            "3) –ü–æ–¥–Ω–∏–º–∞–π –¥–æ —É—Ä–æ–≤–Ω—è –ø–ª–µ—á.\n"
            "4) –í–Ω–∏–∑ ‚Äî –º–µ–¥–ª–µ–Ω–Ω–æ 2‚Äì3 —Å–µ–∫.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –ú–∞—Ö–∏ –∫–æ—Ä–ø—É—Å–æ–º ‚Üí —Å–Ω–∏–∑—å –≤–µ—Å.\n"
            "‚Ä¢ –ü–æ–¥–Ω–∏–º–∞–µ—à—å –∫–∏—Å—Ç—å—é ‚Üí –¥—É–º–∞–π ¬´–ª–æ–∫–æ—Ç—å –≤–µ–¥—ë—Ç¬ª.\n\n"
            "üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞\n"
            "–õ—É—á—à–µ –ª–µ–≥—á–µ, –Ω–æ —á–∏—Å—Ç–æ ‚Äî —Ç—É—Ç —Ç–µ—Ö–Ω–∏–∫–∞ —Ä–µ—à–∞–µ—Ç."
        )
    },
    "biceps": {
        "title": "–ë–∏—Ü–µ–ø—Å —Å–≥–∏–±–∞–Ω–∏—è",
        "img": "media/tech/biceps.jpg",
        "text": (
            "üìö –°–≥–∏–±–∞–Ω–∏—è –Ω–∞ –±–∏—Ü–µ–ø—Å (–±–µ–∑ —Ä–∞—Å–∫–∞—á–∫–∏)\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –õ–æ–∫—Ç–∏ –ø—Ä–∏–∂–∞—Ç—ã –∫ –∫–æ—Ä–ø—É—Å—É –∏ –Ω–µ –≥—É–ª—è—é—Ç.\n"
            "2) –ü–æ–¥–Ω–∏–º–∞–π –¥–æ –ø–∏–∫–∞, –±–µ–∑ —Ä—ã–≤–∫–æ–≤.\n"
            "3) –í–Ω–∏–∑ ‚Äî –º–µ–¥–ª–µ–Ω–Ω–æ, –Ω–µ –±—Ä–æ—Å–∞–π.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –†–∞—Å–∫–∞—á–∫–∞ —Å–ø–∏–Ω–æ–π ‚Üí —Å–ª–∏—à–∫–æ–º —Ç—è–∂–µ–ª–æ.\n"
            "‚Ä¢ –õ–æ–∫—Ç–∏ —É–µ–∑–∂–∞—é—Ç –≤–ø–µ—Ä—ë–¥ ‚Üí –Ω–∞–≥—Ä—É–∑–∫–∞ —É—Ö–æ–¥–∏—Ç.\n\n"
            "üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞\n"
            "–•–æ—á–µ—à—å —Ä–æ—Å—Ç ‚Äî –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–π –Ω–µ–≥–∞—Ç–∏–≤ –∏ –Ω–µ –≥–æ–Ω–∏—Å—å –∑–∞ –≤–µ—Å–æ–º."
        )
    },
    "triceps": {
        "title": "–¢—Ä–∏—Ü–µ–ø—Å –Ω–∞ –±–ª–æ–∫–µ",
        "img": "media/tech/triceps.jpg",
        "text": (
            "üìö –†–∞–∑–≥–∏–±–∞–Ω–∏—è –Ω–∞ –±–ª–æ–∫–µ (—Ç—Ä–∏—Ü–µ–ø—Å)\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –õ–æ–∫—Ç–∏ –ø—Ä–∏–∂–∞—Ç—ã –∫ –∫–æ—Ä–ø—É—Å—É.\n"
            "2) –†–∞–∑–≥–∏–±–∞–π –¥–æ –∫–æ–Ω—Ü–∞ –±–µ–∑ –±–æ–ª–∏.\n"
            "3) –í–≤–µ—Ä—Ö ‚Äî –º–µ–¥–ª–µ–Ω–Ω–æ, –ø–æ–¥ –∫–æ–Ω—Ç—Ä–æ–ª–µ–º.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –õ–æ–∫—Ç–∏ ¬´–≥—É–ª—è—é—Ç¬ª ‚Üí —Å–Ω–∏–∑—å –≤–µ—Å.\n"
            "‚Ä¢ –ë—Ä–æ—Å–∞–µ—à—å –≤–≤–µ—Ä—Ö ‚Üí —Ç–µ—Ä—è–µ—à—å –Ω–∞–≥—Ä—É–∑–∫—É.\n\n"
            "üí° –ï—Å–ª–∏ –ª–æ–∫–æ—Ç—å –Ω–æ–µ—Ç\n"
            "–£–º–µ–Ω—å—à–∏ –≤–µ—Å –∏ –¥–µ–ª–∞–π –º—è–≥—á–µ, –º–æ–∂–Ω–æ –æ–¥–Ω–æ–π —Ä—É–∫–æ–π."
        )
    },
    "legpress": {
        "title": "–ñ–∏–º –Ω–æ–≥–∞–º–∏",
        "img": "media/tech/legpress.jpg",
        "text": (
            "üìö –ñ–∏–º –Ω–æ–≥–∞–º–∏ (–Ω–æ–≥–∏, –±–µ–∑–æ–ø–∞—Å–Ω–æ)\n\n"
            "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞\n"
            "‚Ä¢ –ü–æ—è—Å–Ω–∏—Ü–∞ –ø—Ä–∏–∂–∞—Ç–∞, —Ç–∞–∑ –Ω–µ –æ—Ç—Ä—ã–≤–∞–π.\n"
            "‚Ä¢ –°—Ç–æ–ø—ã —Ç–∞–∫, —á—Ç–æ–±—ã –∫–æ–ª–µ–Ω–∏ —à–ª–∏ –ø–æ –ª–∏–Ω–∏–∏ –Ω–æ—Å–∫–æ–≤.\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –û–ø—É—Å–∫–∞–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—É –¥–æ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ–π –≥–ª—É–±–∏–Ω—ã.\n"
            "2) –í–Ω–∏–∑—É ‚Äî –∫–æ–Ω—Ç—Ä–æ–ª—å, –±–µ–∑ ¬´—Å–∫–ª–∞–¥—ã–≤–∞–Ω–∏—è¬ª —Ç–∞–∑–∞.\n"
            "3) –ñ–º–∏ –≤–≤–µ—Ä—Ö, –Ω–æ –Ω–µ –≤—ã–ø—Ä—è–º–ª—è–π –∫–æ–ª–µ–Ω–∏ –≤ ¬´–∑–∞–º–æ–∫¬ª.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –¢–∞–∑ –æ—Ç—Ä—ã–≤–∞–µ—Ç—Å—è ‚Üí —Å–ª–∏—à–∫–æ–º –≥–ª—É–±–æ–∫–æ.\n"
            "‚Ä¢ –ö–æ–ª–µ–Ω–∏ –≤–Ω—É—Ç—Ä—å ‚Üí —Å–ª–µ–¥–∏ –∑–∞ —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–µ–π.\n\n"
            "üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞\n"
            "–õ—É—á—à–µ –∏–¥–µ–∞–ª—å–Ω–∞—è —Ç–µ—Ö–Ω–∏–∫–∞, —á–µ–º —Ä–µ–∫–æ—Ä–¥–Ω—ã–π –≤–µ—Å."
        )
    },
    # ‚úÖ –ù–æ–≤—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ –¥–ª—è —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π –±–µ–∑ –ø–æ–∫—Ä—ã—Ç–∏—è
    "hinge": {
        "title": "–Ø–≥–æ–¥–∏—á–Ω—ã–π –º–æ—Å—Ç",
        "img": "media/tech/hinge.jpg",
        "text": (
            "üìö –Ø–≥–æ–¥–∏—á–Ω—ã–π –º–æ—Å—Ç (—è–≥–æ–¥–∏—Ü—ã + –∑–∞–¥–Ω—è—è –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å –±–µ–¥—Ä–∞)\n\n"
            "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞\n"
            "‚Ä¢ –õ—è–≥—å –Ω–∞ —Å–ø–∏–Ω—É, –∫–æ–ª–µ–Ω–∏ —Å–æ–≥–Ω—É—Ç—ã, —Å—Ç–æ–ø—ã –Ω–∞ —à–∏—Ä–∏–Ω–µ –±—ë–¥–µ—Ä.\n"
            "‚Ä¢ –ü—è—Ç–∫–∏ –ø–æ–¥ –∫–æ–ª–µ–Ω—è–º–∏ –∏–ª–∏ —á—É—Ç—å –¥–∞–ª—å—à–µ.\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –ù–∞–ø—Ä—è–≥–∏ —è–≥–æ–¥–∏—Ü—ã –∏ –ø–æ–¥–Ω–∏–º–∞–π —Ç–∞–∑ –≤–≤–µ—Ä—Ö.\n"
            "2) –í –≤–µ—Ä—Ö–Ω–µ–π —Ç–æ—á–∫–µ ‚Äî –ø–∞—É–∑–∞ 1‚Äì2 —Å–µ–∫, —Å–æ–∂–º–∏ —è–≥–æ–¥–∏—Ü—ã.\n"
            "3) –û–ø—É—Å–∫–∞–π –º–µ–¥–ª–µ–Ω–Ω–æ, –Ω–µ –∫–∞—Å–∞—è—Å—å –ø–æ–ª–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –ü–æ—è—Å–Ω–∏—Ü–∞ –ø—Ä–æ–≥–∏–±–∞–µ—Ç—Å—è ‚Üí –º–µ–Ω—å—à–µ –≤—ã—Å–æ—Ç—É –ø–æ–¥—ä—ë–º–∞.\n"
            "‚Ä¢ –ö–æ–ª–µ–Ω–∏ —Ä–∞–∑—ä–µ–∑–∂–∞—é—Ç—Å—è ‚Üí –¥–µ—Ä–∂–∏ –∏—Ö –Ω–∞–¥ –Ω–æ—Å–∫–∞–º–∏.\n\n"
            "üí° –£—Å–ª–æ–∂–Ω–µ–Ω–∏–µ\n"
            "–û–¥–Ω–∞ –Ω–æ–≥–∞ –Ω–∞ –≤–µ—Å—É, –∏–ª–∏ –æ—Ç—è–≥–æ—â–µ–Ω–∏–µ –Ω–∞ –±—ë–¥—Ä–∞."
        )
    },
    "core": {
        "title": "–ü–ª–∞–Ω–∫–∞",
        "img": "media/tech/core.jpg",
        "text": (
            "üìö –ü–ª–∞–Ω–∫–∞ (–∫–æ—Ä ‚Äî —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è)\n\n"
            "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞\n"
            "‚Ä¢ –£–ø–æ—Ä –Ω–∞ –ø—Ä–µ–¥–ø–ª–µ—á—å—è (–∏–ª–∏ –ª–∞–¥–æ–Ω–∏), —Ç–µ–ª–æ ‚Äî –ø—Ä—è–º–∞—è –ª–∏–Ω–∏—è.\n"
            "‚Ä¢ –õ–æ–∫—Ç–∏ –ø–æ–¥ –ø–ª–µ—á–∞–º–∏, –≤–∑–≥–ª—è–¥ –≤ –ø–æ–ª.\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –ù–∞–ø—Ä—è–≥–∏ –ø—Ä–µ—Å—Å, —è–≥–æ–¥–∏—Ü—ã, –∫–≤–∞–¥—Ä–∏—Ü–µ–ø—Å—ã –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.\n"
            "2) –ù–µ –¥–∞–≤–∞–π —Ç–∞–∑—É –ø—Ä–æ–≤–∞–ª–∏–≤–∞—Ç—å—Å—è –∏–ª–∏ –∑–∞–¥–∏—Ä–∞—Ç—å—Å—è.\n"
            "3) –î—ã—à–∏ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ, –Ω–µ –∑–∞–¥–µ—Ä–∂–∏–≤–∞–π –¥—ã—Ö–∞–Ω–∏–µ.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –¢–∞–∑ –≤–≤–µ—Ä—Ö ‚Üí —Å–Ω–∏–∑—å –≤—Ä–µ–º—è, –¥–µ—Ä–∂–∏ —Ä–æ–≤–Ω–æ.\n"
            "‚Ä¢ –ü–æ—è—Å–Ω–∏—Ü–∞ –ø—Ä–æ–≥–∏–±–∞–µ—Ç—Å—è ‚Üí –Ω–∞–ø—Ä—è–≥–∏ –ø—Ä–µ—Å—Å —Å–∏–ª—å–Ω–µ–µ.\n\n"
            "üí° –ü—Ä–æ–≥—Ä–µ—Å—Å–∏—è\n"
            "–ù–∞—á–Ω–∏ —Å 20 —Å–µ–∫, –¥–æ–±–∞–≤–ª—è–π –ø–æ 5‚Äì10 —Å–µ–∫ –∫–∞–∂–¥—É—é –Ω–µ–¥–µ–ª—é."
        )
    },
    "hanging_leg_raise": {
        "title": "–ü–æ–¥—ä—ë–º—ã –Ω–æ–≥ –≤ –≤–∏—Å–µ",
        "img": "media/tech/hanging_leg_raise.jpg",
        "text": (
            "üìö –ü–æ–¥—ä—ë–º—ã –Ω–æ–≥ –≤ –≤–∏—Å–µ (–Ω–∏–∂–Ω–∏–π –ø—Ä–µ—Å—Å)\n\n"
            "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞\n"
            "‚Ä¢ –ü–æ–≤–∏—Å–Ω–∏ –Ω–∞ –ø–µ—Ä–µ–∫–ª–∞–¥–∏–Ω–µ, —Ö–≤–∞—Ç —á—É—Ç—å —à–∏—Ä–µ –ø–ª–µ—á.\n"
            "‚Ä¢ –ü–ª–µ—á–∏ –∞–∫—Ç–∏–≤–Ω—ã ‚Äî –Ω–µ –≤–∏—Å ¬´—Ç—Ä—É–ø–æ–º¬ª, –¥–µ—Ä–∂–∏ –ª–æ–ø–∞—Ç–∫–∏.\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –°–ª–µ–≥–∫–∞ —Å–æ–≥–Ω–∏ –∫–æ–ª–µ–Ω–∏ –∏ –ø–æ–¥–Ω–∏–º–∏ –Ω–æ–≥–∏ –∫ –≥—Ä—É–¥–∏/–∂–∏–≤–æ—Ç—É.\n"
            "2) –°–∫—Ä—É—á–∏–≤–∞–π —Ç–∞–∑ –≤–≤–µ—Ä—Ö –≤ –∫–æ–Ω—Ü–µ ‚Äî —ç—Ç–æ –∫–ª—é—á–µ–≤–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ.\n"
            "3) –ú–µ–¥–ª–µ–Ω–Ω–æ –æ–ø—É—Å–∫–∞–π –Ω–æ–≥–∏ –≤–Ω–∏–∑ ‚Äî 2‚Äì3 —Å–µ–∫.\n"
            "4) –ù–µ —Ä–∞—Å–∫–∞—á–∏–≤–∞–π—Å—è –∏ –Ω–µ –ø–æ–º–æ–≥–∞–π –∏–Ω–µ—Ä—Ü–∏–µ–π.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –ù–æ–≥–∏ –ø—Ä–æ—Å—Ç–æ ¬´–±–æ–ª—Ç–∞—é—Ç—Å—è¬ª ‚Üí –Ω–µ –∑–∞–¥–µ–π—Å—Ç–≤–æ–≤–∞–Ω –Ω–∏–∂–Ω–∏–π –ø—Ä–µ—Å—Å.\n"
            "‚Ä¢ –†–∞—Å–∫–∞—á–∫–∞ –∫–æ—Ä–ø—É—Å–∞ ‚Üí —Å–Ω–∏–∑—å –∞–º–ø–ª–∏—Ç—É–¥—É, –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–π.\n\n"
            "üí° –ü—Ä–æ–≥—Ä–µ—Å—Å–∏—è\n"
            "–°–æ–≥–Ω—É—Ç—ã–µ –∫–æ–ª–µ–Ω–∏ ‚Üí –ø—Ä—è–º—ã–µ –Ω–æ–≥–∏ ‚Üí —É–≥–æ–ª–æ–∫ 90¬∞ ‚Üí –º–µ–¥–ª–µ–Ω–Ω–æ."
        )
    },
    "leg_raise_lying": {
        "title": "–ü–æ–¥—ä—ë–º—ã –Ω–æ–≥ –ª—ë–∂–∞",
        "img": "media/tech/leg_raise_lying.jpg",
        "text": (
            "üìö –ü–æ–¥—ä—ë–º—ã –Ω–æ–≥ –ª—ë–∂–∞ (–Ω–∏–∂–Ω–∏–π –ø—Ä–µ—Å—Å)\n\n"
            "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞\n"
            "‚Ä¢ –õ–µ—á—å –Ω–∞ —Å–ø–∏–Ω—É, —Ä—É–∫–∏ –≤–¥–æ–ª—å —Ç–µ–ª–∞ –∏–ª–∏ –ø–æ–¥ –ø–æ—è—Å–Ω–∏—Ü—É.\n"
            "‚Ä¢ –ü–æ—è—Å–Ω–∏—Ü–∞ –ø—Ä–∏–∂–∞—Ç–∞ –∫ –ø–æ–ª—É –Ω–∞ –ø—Ä–æ—Ç—è–∂–µ–Ω–∏–∏ –≤—Å–µ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è.\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –ü–æ–¥–Ω–∏–º–∏ –ø—Ä—è–º—ã–µ –Ω–æ–≥–∏ –¥–æ 90¬∞ (–∏–ª–∏ –¥–æ —É–≥–ª–∞ —Å –∫–æ–Ω—Ç—Ä–æ–ª–µ–º).\n"
            "2) –ú–µ–¥–ª–µ–Ω–Ω–æ –æ–ø—É—Å–∫–∞–π ‚Äî –Ω–µ –∫–∞—Å–∞—è—Å—å –ø–æ–ª–∞, –æ—Å—Ç–∞–Ω–æ–≤–∏—Å—å –≤ 5‚Äì10 —Å–º.\n"
            "3) –ü—Ä–æ–¥–æ–ª–∂–∞–π –±–µ–∑ –æ—Ç–¥—ã—Ö–∞ –¥–ª—è –Ω–∏–∂–Ω–µ–≥–æ –ø—Ä–µ—Å—Å–∞.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –ü–æ—è—Å–Ω–∏—Ü–∞ –æ—Ç—Ä—ã–≤–∞–µ—Ç—Å—è ‚Üí —Å–æ–≥–Ω–∏ –∫–æ–ª–µ–Ω–∏ –∏–ª–∏ —É–º–µ–Ω—å—à–∏ –∞–º–ø–ª–∏—Ç—É–¥—É.\n"
            "‚Ä¢ –°–ª–∏—à–∫–æ–º –±—ã—Å—Ç—Ä–æ ‚Üí –Ω–µ—Ç –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ –ø—Ä–µ—Å—Å.\n\n"
            "üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞\n"
            "–ß–µ–º –Ω–∏–∂–µ –Ω–æ–≥–∏ –∫ –ø–æ–ª—É –ø—Ä–∏ –æ–ø—É—Å–∫–∞–Ω–∏–∏, —Ç–µ–º —Ç—è–∂–µ–ª–µ–µ ‚Äî –Ω–∞–π–¥–∏ —Å–≤–æ–π —É—Ä–æ–≤–µ–Ω—å."
        )
    },
    "ab_crunch": {
        "title": "–°–∫—Ä—É—á–∏–≤–∞–Ω–∏—è (–ø—Ä–µ—Å—Å)",
        "img": "media/tech/ab_crunch.jpg",
        "text": (
            "üìö –°–∫—Ä—É—á–∏–≤–∞–Ω–∏—è (–≤–µ—Ä—Ö–Ω–∏–π –ø—Ä–µ—Å—Å)\n\n"
            "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞\n"
            "‚Ä¢ –õ–µ—á—å –Ω–∞ —Å–ø–∏–Ω—É, –∫–æ–ª–µ–Ω–∏ —Å–æ–≥–Ω—É—Ç—ã, —Å—Ç–æ–ø—ã –Ω–∞ –ø–æ–ª—É.\n"
            "‚Ä¢ –†—É–∫–∏ –∑–∞ –≥–æ–ª–æ–≤—É (–ª—ë–≥–∫–æ–µ –∫–∞—Å–∞–Ω–∏–µ) –∏–ª–∏ —Å–∫—Ä–µ—â–µ–Ω—ã –Ω–∞ –≥—Ä—É–¥–∏.\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –°–∫—Ä—É—á–∏–≤–∞–π –≤–µ—Ä—Ö–Ω—é—é —á–∞—Å—Ç—å —Ç—É–ª–æ–≤–∏—â–∞, –æ—Ç—Ä—ã–≤–∞—è –ª–æ–ø–∞—Ç–∫–∏ –æ—Ç –ø–æ–ª–∞.\n"
            "2) –ü—É–ø–æ–∫ –∫ –∫–æ–ª–µ–Ω—è–º ‚Äî –Ω–µ –≥–æ–ª–æ–≤–∞ –∫ –∫–æ–ª–µ–Ω—è–º.\n"
            "3) –ü–∞—É–∑–∞ 1 —Å–µ–∫ –≤–≤–µ—Ä—Ö—É, –º–µ–¥–ª–µ–Ω–Ω–æ –≤–Ω–∏–∑.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –¢—è–Ω–µ—à—å –≥–æ–ª–æ–≤—É —Ä—É–∫–∞–º–∏ ‚Üí —à–µ—è –±–æ–ª–∏—Ç, –ø—Ä–µ—Å—Å –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç.\n"
            "‚Ä¢ –ü–æ–ª–Ω—ã–π –ø–æ–¥—ä—ë–º (—Å–∏–¥—è) ‚Üí –ø–æ—è—Å–Ω–∏—Ü–∞ –≤–∫–ª—é—á–∞–µ—Ç—Å—è, –ø—Ä–µ—Å—Å –≤—ã–∫–ª—é—á–∞–µ—Ç—Å—è.\n\n"
            "üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞\n"
            "–°–∫—Ä—É—á–∏–≤–∞–Ω–∏–µ ‚Äî —ç—Ç–æ –∫–æ—Ä–æ—Ç–∫–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ, –Ω–µ –ø–æ–¥—ä—ë–º –∫–æ—Ä–ø—É—Å–∞."
        )
    },
    "ab_rollout": {
        "title": "–†–æ–ª–∏–∫ –¥–ª—è –ø—Ä–µ—Å—Å–∞",
        "img": "media/tech/ab_rollout.jpg",
        "text": (
            "üìö –†–æ–ª–∏–∫ –¥–ª—è –ø—Ä–µ—Å—Å–∞ (ab wheel)\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –°—Ç–æ—è –Ω–∞ –∫–æ–ª–µ–Ω—è—Ö, —Ä–æ–ª–∏–∫ –ø–µ—Ä–µ–¥ —Ç–æ–±–æ–π.\n"
            "2) –ú–µ–¥–ª–µ–Ω–Ω–æ –∫–∞—Ç–∏—Å—å –≤–ø–µ—Ä—ë–¥ ‚Äî —Å–ø–∏–Ω–∞ –ø—Ä—è–º–∞—è, –ø—Ä–µ—Å—Å –Ω–∞–ø—Ä—è–∂—ë–Ω.\n"
            "3) –ö–∞—Ç–∏—Å—å –¥–æ –ø—Ä–µ–¥–µ–ª–∞ —Å —Ä–æ–≤–Ω–æ–π —Å–ø–∏–Ω–æ–π, –ø–∞—É–∑–∞.\n"
            "4) –¢—è–Ω–∏ —Ä–æ–ª–∏–∫ –æ–±—Ä–∞—Ç–Ω–æ –ø—Ä–µ—Å—Å–æ–º, –Ω–µ –ø–æ—è—Å–Ω–∏—Ü–µ–π.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –ü–æ—è—Å–Ω–∏—Ü–∞ –ø—Ä–æ–≤–∏—Å–∞–µ—Ç ‚Üí –∫–∞—Ç–∏—Å—å –º–µ–Ω—å—à–µ, –ø–æ–∫–∞ –ø—Ä–µ—Å—Å –Ω–µ –æ–∫—Ä–µ–ø–Ω–µ—Ç.\n"
            "‚Ä¢ –†—ã–≤–æ–∫ –æ–±—Ä–∞—Ç–Ω–æ ‚Üí –º–µ–¥–ª–µ–Ω–Ω–µ–µ, –∏—Å–ø–æ–ª—å–∑—É–π –ø—Ä–µ—Å—Å.\n\n"
            "üí° –ü—Ä–æ–≥—Ä–µ—Å—Å–∏—è\n"
            "–ù–∞—á–Ω–∏ —Å –∫–æ—Ä–æ—Ç–∫–æ–π –∞–º–ø–ª–∏—Ç—É–¥–æ–π. –¶–µ–ª—å ‚Äî –ø–æ–ª–Ω–æ–µ –≤—ã–∫–∞—Ç—ã–≤–∞–Ω–∏–µ —Å –ø—Ä—è–º—ã–º —Ç–µ–ª–æ–º."
        )
    },
    "side_plank": {
        "title": "–ë–æ–∫–æ–≤–∞—è –ø–ª–∞–Ω–∫–∞",
        "img": "media/tech/side_plank.jpg",
        "text": (
            "üìö –ë–æ–∫–æ–≤–∞—è –ø–ª–∞–Ω–∫–∞ (–∫–æ—Å—ã–µ –º—ã—à—Ü—ã + —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è)\n\n"
            "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞\n"
            "‚Ä¢ –£–ø–æ—Ä –Ω–∞ –ø—Ä–µ–¥–ø–ª–µ—á—å–µ (–ª–æ–∫–æ—Ç—å –ø–æ–¥ –ø–ª–µ—á–æ–º), —Ç–µ–ª–æ ‚Äî –ø—Ä—è–º–∞—è –ª–∏–Ω–∏—è —Å–±–æ–∫—É.\n"
            "‚Ä¢ –ù–æ–≥–∏ –ø—Ä—è–º—ã–µ –∏–ª–∏ –æ–¥–Ω–∞ –Ω–∞ –¥—Ä—É–≥–æ–π –¥–ª—è –±–∞–ª–∞–Ω—Å–∞.\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –ü–æ–¥–Ω–∏–º–∏ —Ç–∞–∑ ‚Äî —Ç–µ–ª–æ –æ—Ç –≥–æ–ª–æ–≤—ã –¥–æ –ø—è—Ç–æ–∫ –æ–¥–Ω–∞ –ª–∏–Ω–∏—è.\n"
            "2) –ù–µ –¥–∞–≤–∞–π —Ç–∞–∑—É –ø—Ä–æ–≤–∞–ª–∏–≤–∞—Ç—å—Å—è –≤–Ω–∏–∑ –∏–ª–∏ –∑–∞–¥–∏—Ä–∞—Ç—å—Å—è.\n"
            "3) –î—ã—à–∏ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ, –¥–µ—Ä–∂–∏ –∑–∞–¥–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –¢–∞–∑ –ø—Ä–æ–≤–∏—Å–∞–µ—Ç ‚Üí —Å–æ–∫—Ä–∞—â–∞–π –≤—Ä–µ–º—è, –¥–µ—Ä–∂–∏ —Ä–æ–≤–Ω–æ.\n"
            "‚Ä¢ –ü–ª–µ—á–æ ¬´—Ç—è–Ω–µ—Ç¬ª ‚Üí –æ–ø—É—Å—Ç–∏ –µ–≥–æ –≤–Ω–∏–∑ –æ—Ç —É—Ö–∞.\n\n"
            "üí° –ü—Ä–æ–≥—Ä–µ—Å—Å–∏—è\n"
            "–°—Ç–∞—Ç–∏–∫–∞ ‚Üí –ø–æ–¥—ä—ë–º—ã –Ω–æ–≥–∏/—Ä—É–∫–∏ ‚Üí –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Å–∫—Ä—É—á–∏–≤–∞–Ω–∏—è."
        )
    },
    "elbow_leg_raise": {
        "title": "–ü–æ–¥—ä—ë–º—ã –Ω–æ–≥ –≤ —É–ø–æ—Ä–µ –Ω–∞ –ª–æ–∫—Ç—è—Ö",
        "img": "media/tech/elbow_leg_raise.jpg",
        "text": (
            "üìö –ü–æ–¥—ä—ë–º—ã –Ω–æ–≥ –≤ —É–ø–æ—Ä–µ –Ω–∞ –ª–æ–∫—Ç—è—Ö (–Ω–∏–∂–Ω–∏–π –ø—Ä–µ—Å—Å)\n\n"
            "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞\n"
            "‚Ä¢ –£–ø–æ—Ä –Ω–∞ –ª–æ–∫—Ç–∏ –∏ –ø—Ä–µ–¥–ø–ª–µ—á—å—è (–∫–∞–∫ –≤ –ø–ª–∞–Ω–∫–µ).\n"
            "‚Ä¢ –°–ø–∏–Ω–∞ –ø—Ä—è–º–∞—è, –ø—Ä–µ—Å—Å –≤–∫–ª—é—á—ë–Ω.\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –ü–æ–¥–Ω–∏–º–∞–π –∫–æ–ª–µ–Ω–∏ –∫ –≥—Ä—É–¥–∏, —Å–∫—Ä—É—á–∏–≤–∞—è —Ç–∞–∑.\n"
            "2) –ü–∞—É–∑–∞ –≤ –≤–µ—Ä—Ö–Ω–µ–π —Ç–æ—á–∫–µ ‚Äî —Å–æ–∂–º–∏ –ø—Ä–µ—Å—Å.\n"
            "3) –ú–µ–¥–ª–µ–Ω–Ω–æ –æ–ø—É—Å–∫–∞–π –Ω–æ–≥–∏, –Ω–µ –∫–∞—Å–∞—è—Å—å –ø–æ–ª–∞.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –ö–∞—á–∞–µ—à—å—Å—è –Ω–∞ –æ–ø–æ—Ä–µ ‚Üí –∑–∞–º–µ–¥–ª–∏—Å—å.\n"
            "‚Ä¢ –°–ø–∏–Ω–∞ –ø—Ä–æ–≥–∏–±–∞–µ—Ç—Å—è ‚Üí –Ω–∞–ø—Ä—è–≥–∏ –∫–æ—Ä–ø—É—Å —Å–∏–ª—å–Ω–µ–µ.\n\n"
            "üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞\n"
            "–£–¥–æ–±–Ω–µ–µ —á–µ–º –ø–æ–¥—ä—ë–º—ã –≤ –≤–∏—Å–µ ‚Äî —Ö–æ—Ä–æ—à–æ –¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤."
        )
    },
    "calves": {
        "title": "–ü–æ–¥—ä—ë–º—ã –Ω–∞ –Ω–æ—Å–∫–∏",
        "img": "media/tech/calves.jpg",
        "text": (
            "üìö –ü–æ–¥—ä—ë–º—ã –Ω–∞ –Ω–æ—Å–∫–∏ (–∏–∫—Ä—ã)\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –í—Å—Ç–∞–Ω—å –Ω–∞ –∫—Ä–∞–π —Å—Ç—É–ø–µ–Ω–∏ (–∏–ª–∏ —Ä–æ–≤–Ω—ã–π –ø–æ–ª).\n"
            "2) –ü–æ–¥–Ω–∏–º–∞–π—Å—è –Ω–∞ –Ω–æ—Å–∫–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –≤—ã—Å–æ–∫–æ.\n"
            "3) –ü–∞—É–∑–∞ –≤–≤–µ—Ä—Ö—É 1 —Å–µ–∫, –æ–ø—É—Å–∫–∞–π—Å—è –º–µ–¥–ª–µ–Ω–Ω–æ (2‚Äì3 —Å–µ–∫).\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –°–ª–∏—à–∫–æ–º –±—ã—Å—Ç—Ä–æ ‚Üí –Ω–µ—Ç –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ –∏–∫—Ä—ã.\n"
            "‚Ä¢ –ù–µ –ø–æ–ª–Ω–∞—è –∞–º–ø–ª–∏—Ç—É–¥–∞ ‚Üí –º–µ–Ω—å—à–µ —ç—Ñ—Ñ–µ–∫—Ç.\n\n"
            "üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞\n"
            "–ò–∫—Ä—ã –≤—ã–Ω–æ—Å–ª–∏–≤—ã–µ ‚Äî –¥–µ–ª–∞–π 15‚Äì25 –ø–æ–≤—Ç–æ—Ä–æ–≤ –∏–ª–∏ –¥–æ–±–∞–≤—å –≤–µ—Å."
        )
    },
    "goblet": {
        "title": "–ì–æ–±–ª–µ—Ç-–ø—Ä–∏—Å–µ–¥",
        "img": "media/tech/goblet.jpg",
        "text": (
            "üìö –ì–æ–±–ª–µ—Ç-–ø—Ä–∏—Å–µ–¥ (–Ω–æ–≥–∏ + –∫–æ—Ä–ø—É—Å)\n\n"
            "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞\n"
            "‚Ä¢ –î–µ—Ä–∂–∏ –≥–∞–Ω—Ç–µ–ª—å/–≥–∏—Ä—é —É –≥—Ä—É–¥–∏ –¥–≤—É–º—è —Ä—É–∫–∞–º–∏.\n"
            "‚Ä¢ –°—Ç–æ–ø—ã —á—É—Ç—å —à–∏—Ä–µ –ø–ª–µ—á, –Ω–æ—Å–∫–∏ –Ω–∞—Ä—É–∂—É.\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –ü—Ä–∏—Å–µ–¥–∞–π –≥–ª—É–±–æ–∫–æ, –ª–æ–∫—Ç–∏ –¥–∞–≤—è—Ç –Ω–∞ –∫–æ–ª–µ–Ω–∏ –∏–∑–Ω—É—Ç—Ä–∏.\n"
            "2) –°–ø–∏–Ω–∞ –ø—Ä—è–º–∞—è, –≥—Ä—É–¥—å —Å–º–æ—Ç—Ä–∏—Ç –≤–ø–µ—Ä—ë–¥.\n"
            "3) –í—Å—Ç–∞–≤–∞–π, –≤—ã—Ç–∞–ª–∫–∏–≤–∞—è –ø–æ–ª –Ω–æ–≥–∞–º–∏.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –ù–∞–∫–ª–æ–Ω –≤–ø–µ—Ä—ë–¥ ‚Üí –ø–æ–¥–Ω–∏–º–∏ –≤–µ—Å –≤—ã—à–µ, –∫ –≥—Ä—É–¥–∏.\n"
            "‚Ä¢ –ü—è—Ç–∫–∏ –æ—Ç—Ä—ã–≤–∞—é—Ç—Å—è ‚Üí —á—É—Ç—å —à–∏—Ä–µ —Å—Ç–æ–π–∫–∞.\n\n"
            "üí° –ü–ª—é—Å\n"
            "–û—Ç–ª–∏—á–Ω–∞—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ –æ–±—ã—á–Ω–æ–º—É –ø—Ä–∏—Å–µ–¥—É ‚Äî –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ –¥–ª—è —Å–ø–∏–Ω—ã."
        )
    },
    "lunge": {
        "title": "–í—ã–ø–∞–¥—ã",
        "img": "media/tech/lunge.jpg",
        "text": (
            "üìö –í—ã–ø–∞–¥—ã (–Ω–æ–≥–∏ + —è–≥–æ–¥–∏—Ü—ã)\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –®–∞–≥ –≤–ø–µ—Ä—ë–¥ ‚Äî —à–∏—Ä–æ–∫–∏–π, –∫–æ–ª–µ–Ω–æ –Ω–µ –≤—ã—Ö–æ–¥–∏—Ç –∑–∞ –Ω–æ—Å–æ–∫.\n"
            "2) –ó–∞–¥–Ω–µ–µ –∫–æ–ª–µ–Ω–æ –æ–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–æ—á—Ç–∏ –¥–æ –ø–æ–ª–∞.\n"
            "3) –û—Ç—Ç–æ–ª–∫–Ω–∏—Å—å –ø–µ—Ä–µ–¥–Ω–µ–π –Ω–æ–≥–æ–π –∏ –≤–µ—Ä–Ω–∏—Å—å.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –ü–µ—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–µ–Ω–æ –∑–∞–≤–∞–ª–∏–≤–∞–µ—Ç—Å—è –≤–Ω—É—Ç—Ä—å ‚Üí —Å–ª–µ–¥–∏ –∑–∞ –Ω–∏–º.\n"
            "‚Ä¢ –ö–æ—Ä–ø—É—Å –ø–∞–¥–∞–µ—Ç –≤–ø–µ—Ä—ë–¥ ‚Üí –¥–µ—Ä–∂–∏ –≥—Ä—É–¥—å –ø—Ä—è–º–æ.\n\n"
            "üí° –í–∞—Ä–∏–∞–Ω—Ç—ã\n"
            "–°—Ç–∞—Ç–∏—á–Ω—ã–µ (–Ω–∞ –º–µ—Å—Ç–µ), –æ–±—Ä–∞—Ç–Ω—ã–µ (—à–∞–≥ –Ω–∞–∑–∞–¥), –±–æ–ª–≥–∞—Ä—Å–∫–∏–µ (–Ω–æ–≥–∞ —Å–∑–∞–¥–∏ –Ω–∞ —Å–∫–∞–º—å–µ)."
        )
    },
    "hyperext": {
        "title": "–ì–∏–ø–µ—Ä—ç–∫—Å—Ç–µ–Ω–∑–∏—è",
        "img": "media/tech/hyperext.jpg",
        "text": (
            "üìö –ì–∏–ø–µ—Ä—ç–∫—Å—Ç–µ–Ω–∑–∏—è (–ø–æ—è—Å–Ω–∏—Ü–∞ + —è–≥–æ–¥–∏—Ü—ã)\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –ó–∞—Ñ–∏–∫—Å–∏—Ä—É–π –Ω–æ–≥–∏, –æ–ø—É—Å—Ç–∏—Å—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –ø–æ–ª—É.\n"
            "2) –ü–æ–¥–Ω–∏–º–∞–π—Å—è –¥–æ –ø—Ä—è–º–æ–π –ª–∏–Ω–∏–∏ —Ç–µ–ª–∞ (–Ω–µ –ø–µ—Ä–µ–≥–∏–±–∞–π—Å—è!).\n"
            "3) –ü–∞—É–∑–∞ –≤–≤–µ—Ä—Ö—É ‚Äî —Å–æ–∂–º–∏ —è–≥–æ–¥–∏—Ü—ã.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –ü–µ—Ä–µ—Ä–∞–∑–≥–∏–±–∞–Ω–∏–µ –ø–æ—è—Å–Ω–∏—Ü—ã ‚Üí –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Å—è –Ω–∞ –ø—Ä—è–º–æ–π –ª–∏–Ω–∏–∏.\n"
            "‚Ä¢ –†—É–∫–∏ —Ç—è–Ω—É—Ç —à–µ—é ‚Üí –¥–µ—Ä–∂–∏ –∏—Ö —É –≥—Ä—É–¥–∏ –∏–ª–∏ –∑–∞ –≥–æ–ª–æ–≤–æ–π –±–µ–∑ —É—Å–∏–ª–∏—è.\n\n"
            "üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞\n"
            "–ß—É–≤—Å—Ç–≤—É–µ—à—å —è–≥–æ–¥–∏—Ü—ã –±–æ–ª—å—à–µ, —á–µ–º –ø–æ—è—Å–Ω–∏—Ü—É? –ó–Ω–∞—á–∏—Ç, –¥–µ–ª–∞–µ—à—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ."
        )
    },
    "legcurl": {
        "title": "–°–≥–∏–±–∞–Ω–∏—è –Ω–æ–≥",
        "img": "media/tech/legcurl.jpg",
        "text": (
            "üìö –°–≥–∏–±–∞–Ω–∏—è –Ω–æ–≥ (–±–∏—Ü–µ–ø—Å –±–µ–¥—Ä–∞)\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –õ–µ—á—å –Ω–∞ —Ç—Ä–µ–Ω–∞–∂—ë—Ä, –æ—Å—å –≤—Ä–∞—â–µ–Ω–∏—è ‚Äî –ø–æ–¥ –∫–æ–ª–µ–Ω—è–º–∏.\n"
            "2) –°–≥–∏–±–∞–π –Ω–æ–≥–∏ –¥–æ –º–∞–∫—Å–∏–º—É–º–∞, –ø–∞—É–∑–∞ 1 —Å–µ–∫.\n"
            "3) –û–ø—É—Å–∫–∞–π –º–µ–¥–ª–µ–Ω–Ω–æ (2‚Äì3 —Å–µ–∫).\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –¢–∞–∑ –æ—Ç—Ä—ã–≤–∞–µ—Ç—Å—è ‚Üí —Å–Ω–∏–∑—å –≤–µ—Å.\n"
            "‚Ä¢ –°–ª–∏—à–∫–æ–º –±—ã—Å—Ç—Ä–æ ‚Üí –Ω–µ—Ç –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ –±–∏—Ü–µ–ø—Å –±–µ–¥—Ä–∞.\n\n"
            "üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞\n"
            "–ù–æ—Å–∫–∏ –Ω–∞ —Å–µ–±—è ‚Äî –Ω–µ–º–Ω–æ–≥–æ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –∏–∫—Ä—ã, –æ—Ç —Å–µ–±—è ‚Äî —á–∏—â–µ –±–∏—Ü–µ–ø—Å –±–µ–¥—Ä–∞."
        )
    },
    "rowtrain": {
        "title": "–¢—è–≥–∞ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –±–ª–æ–∫–∞",
        "img": "media/tech/latpulldown.jpg",
        "text": (
            "üìö –¢—è–≥–∞ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –±–ª–æ–∫–∞ (—Å–µ—Ä–µ–¥–∏–Ω–∞ —Å–ø–∏–Ω—ã)\n\n"
            "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞\n"
            "‚Ä¢ –°—è–¥—å, –Ω–æ–≥–∏ —Å–æ–≥–Ω—É—Ç—ã, —Å–ø–∏–Ω–∞ –ø—Ä—è–º–∞—è, –Ω–µ –æ–∫—Ä—É–≥–ª–µ–Ω–∞.\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –ù–∞—á–Ω–∏ —Ç—è–≥—É —Å –ª–æ–ø–∞—Ç–æ–∫: —Å–≤–µ–¥–∏ –∏—Ö –≤–º–µ—Å—Ç–µ.\n"
            "2) –¢—è–Ω–∏ –∫ –ø–æ—è—Å—É, –ª–æ–∫—Ç–∏ –±–ª–∏–∑–∫–æ –∫ —Ç–µ–ª—É.\n"
            "3) –ü–∞—É–∑–∞ 1 —Å–µ–∫ –≤ –∫–æ–Ω—Ü–µ, –∑–∞—Ç–µ–º –º–µ–¥–ª–µ–Ω–Ω–æ –≤–ø–µ—Ä—ë–¥.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –†–∞—Å–∫–∞—á–∫–∞ –∫–æ—Ä–ø—É—Å–æ–º ‚Üí —Å–Ω–∏–∑—å –≤–µ—Å.\n"
            "‚Ä¢ –¢—è–Ω–µ—à—å —Ä—É–∫–∞–º–∏ ‚Üí –¥—É–º–∞–π ¬´—Å–≤–æ–∂—É –ª–æ–ø–∞—Ç–∫–∏¬ª.\n\n"
            "üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞\n"
            "–ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π —Ö–≤–∞—Ç (–ª–∞–¥–æ–Ω–∏ –¥—Ä—É–≥ –∫ –¥—Ä—É–≥—É) ‚Äî –∫–æ–º—Ñ–æ—Ä—Ç–Ω–µ–µ –¥–ª—è –ø–ª–µ—á."
        )
    },
    "dumbbell_row": {
        "title": "–¢—è–≥–∞ –≥–∞–Ω—Ç–µ–ª–∏",
        "img": "media/tech/latpulldown.jpg",
        "text": (
            "üìö –¢—è–≥–∞ –≥–∞–Ω—Ç–µ–ª–∏ –æ–¥–Ω–æ–π —Ä—É–∫–æ–π (—Å–ø–∏–Ω–∞)\n\n"
            "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞\n"
            "‚Ä¢ –£–ø—Ä–∏—Å—å –∫–æ–ª–µ–Ω–æ–º –∏ —Ä—É–∫–æ–π –≤ —Å–∫–∞–º—å—é, —Å–ø–∏–Ω–∞ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞ –ø–æ–ª—É.\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –¢—è–Ω–∏ –≥–∞–Ω—Ç–µ–ª—å –∫ –ø–æ—è—Å—É, –ª–æ–∫–æ—Ç—å –≤–¥–æ–ª—å —Ç–µ–ª–∞.\n"
            "2) –í –≤–µ—Ä—Ö–Ω–µ–π —Ç–æ—á–∫–µ ‚Äî –ª–æ–ø–∞—Ç–∫–∞ —Å–≤–µ–¥–µ–Ω–∞, –ø–∞—É–∑–∞.\n"
            "3) –û–ø—É—Å–∫–∞–π –º–µ–¥–ª–µ–Ω–Ω–æ –¥–æ –ø–æ–ª–Ω–æ–≥–æ —Ä–∞—Å—Ç—è–∂–µ–Ω–∏—è.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –†–æ—Ç–∞—Ü–∏—è –∫–æ—Ä–ø—É—Å–∞ ‚Üí –∑–∞—Ñ–∏–∫—Å–∏—Ä—É–π –∫–æ—Ä–ø—É—Å.\n"
            "‚Ä¢ –¢—è–Ω–µ—à—å –≤–≤–µ—Ä—Ö, –∞ –Ω–µ –∫ –ø–æ—è—Å—É ‚Üí –º–µ–Ω—è–π —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏—é.\n\n"
            "üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞\n"
            "–û—Ç–ª–∏—á–Ω–æ–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –¥–ª—è –∞—Å–∏–º–º–µ—Ç—Ä–∏–π ‚Äî –∫–∞–∂–¥–∞—è —Å—Ç–æ—Ä–æ–Ω–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ."
        )
    },
    "band_row": {
        "title": "–¢—è–≥–∞ —Ä–µ–∑–∏–Ω–∫–∏",
        "img": "media/tech/latpulldown.jpg",
        "text": (
            "üìö –¢—è–≥–∞ —Ä–µ–∑–∏–Ω–∫–∏ –∫ –ø–æ—è—Å—É (—Å–ø–∏–Ω–∞ –¥–æ–º–∞)\n\n"
            "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞\n"
            "‚Ä¢ –ó–∞—Ü–µ–ø–∏ —Ä–µ–∑–∏–Ω–∫—É –∑–∞ –¥–≤–µ—Ä—å –∏–ª–∏ —Å—Ç–æ–π–∫—É –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø–æ—è—Å–∞.\n"
            "‚Ä¢ –í—Å—Ç–∞–Ω—å —Ä–æ–≤–Ω–æ, –ª—ë–≥–∫–∏–π –Ω–∞–∫–ª–æ–Ω –≤–ø–µ—Ä—ë–¥.\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –¢—è–Ω–∏ –ª–æ–∫—Ç–∏ –Ω–∞–∑–∞–¥ –∏ –∫ —Ç–µ–ª—É.\n"
            "2) –°–≤–µ–¥–∏ –ª–æ–ø–∞—Ç–∫–∏ –≤ –∫–æ–Ω—Ü–µ –¥–≤–∏–∂–µ–Ω–∏—è.\n"
            "3) –ú–µ–¥–ª–µ–Ω–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–π—Å—è –≤–ø–µ—Ä—ë–¥.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –¢—è–Ω–µ—à—å —Ä—É–∫–∞–º–∏ ‚Üí –¥—É–º–∞–π ¬´–ª–æ–∫—Ç–∏ –Ω–∞–∑–∞–¥¬ª.\n"
            "‚Ä¢ –ö–æ—Ä–ø—É—Å —É—Ö–æ–¥–∏—Ç –Ω–∞–∑–∞–¥ ‚Üí –¥–µ—Ä–∂–∏ –µ–≥–æ –Ω–µ–ø–æ–¥–≤–∏–∂–Ω—ã–º.\n\n"
            "üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞\n"
            "–í—ã–±–∏—Ä–∞–π —Ä–µ–∑–∏–Ω–∫—É, –≥–¥–µ 12‚Äì15 –ø–æ–≤—Ç–æ—Ä–æ–≤ ‚Äî —Ç—è–∂–µ–ª–æ, –Ω–æ —Ç–µ—Ö–Ω–∏–∫–∞ –Ω–µ –ª–æ–º–∞–µ—Ç—Å—è."
        )
    },
    "pike_pushup": {
        "title": "–ü–∞–π–∫-–æ—Ç–∂–∏–º–∞–Ω–∏—è",
        "img": "media/tech/pike_pushup.jpg",
        "text": (
            "üìö –ü–∞–π–∫-–æ—Ç–∂–∏–º–∞–Ω–∏—è (–ø–ª–µ—á–∏ + —Ç—Ä–∏—Ü–µ–ø—Å)\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –í—Å—Ç–∞–Ω—å –≤ –ø–æ–∑—É –ø–µ—Ä–µ–≤—ë—Ä–Ω—É—Ç–æ–π V: —Ç–∞–∑ –≤—ã—Å–æ–∫–æ, —Ä—É–∫–∏ –∏ –Ω–æ–≥–∏ –ø—Ä—è–º—ã–µ.\n"
            "2) –û–ø—É—Å–∫–∞–π –≥–æ–ª–æ–≤—É –∫ –ø–æ–ª—É, —Å–≥–∏–±–∞—è –ª–æ–∫—Ç–∏.\n"
            "3) –û—Ç–æ–∂–º–∏—Å—å –æ–±—Ä–∞—Ç–Ω–æ, –Ω–µ –æ–ø—É—Å–∫–∞—è —Ç–∞–∑.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –¢–∞–∑ –ø—Ä–æ–≤–∞–ª–∏–≤–∞–µ—Ç—Å—è –≤–Ω–∏–∑ ‚Äî —ç—Ç–æ —É–∂–µ –æ–±—ã—á–Ω–æ–µ –æ—Ç–∂–∏–º–∞–Ω–∏–µ.\n"
            "‚Ä¢ –°–ª–∏—à–∫–æ–º —É–∑–∫–∏–π —É–≥–æ–ª ‚Üí –ø–æ–¥–Ω–∏–º–∏ —Ç–∞–∑ –≤—ã—à–µ.\n\n"
            "üí° –ü—Ä–æ–≥—Ä–µ—Å—Å–∏—è\n"
            "–ù–æ–≥–∏ –Ω–∞ –≤–æ–∑–≤—ã—à–µ–Ω–∏–µ ‚Üí –±–æ–ª—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ –ø–ª–µ—á–∏."
        )
    },
    "band_ohp": {
        "title": "–ñ–∏–º —Ä–µ–∑–∏–Ω–∫–∏ –≤–≤–µ—Ä—Ö",
        "img": "media/tech/band_ohp.jpg",
        "text": (
            "üìö –ñ–∏–º —Ä–µ–∑–∏–Ω–∫–∏ –≤–≤–µ—Ä—Ö (–ø–ª–µ—á–∏ –¥–æ–º–∞)\n\n"
            "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞\n"
            "‚Ä¢ –í—Å—Ç–∞–Ω—å –Ω–∞ —Ä–µ–∑–∏–Ω–∫—É, –¥–µ—Ä–∂–∏ –µ—ë –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø–ª–µ—á —Ö–≤–∞—Ç–æ–º —Å–≤–µ—Ä—Ö—É.\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –ñ–º–∏ —Ä–µ–∑–∏–Ω–∫—É –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ –≤–≤–µ—Ä—Ö –¥–æ –≤—ã–ø—Ä—è–º–ª–µ–Ω–∏—è —Ä—É–∫.\n"
            "2) –ü—Ä–µ—Å—Å –Ω–∞–ø—Ä—è–∂—ë–Ω, –Ω–µ –ø—Ä–æ–≥–∏–±–∞–π—Å—è –≤ –ø–æ—è—Å–Ω–∏—Ü–µ.\n"
            "3) –ú–µ–¥–ª–µ–Ω–Ω–æ –æ–ø—É—Å–∫–∞–π –∫ –ø–ª–µ—á–∞–º.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –ü—Ä–æ–≥–∏–± –ø–æ—è—Å–Ω–∏—Ü—ã ‚Üí –Ω–∞–ø—Ä—è–≥–∏ –∫–æ—Ä–ø—É—Å.\n"
            "‚Ä¢ –õ–æ–∫—Ç–∏ —É—Ö–æ–¥—è—Ç –≤–ø–µ—Ä—ë–¥ ‚Üí –¥–µ—Ä–∂–∏ –∏—Ö –ø–æ–¥ –∑–∞–ø—è—Å—Ç—å—è–º–∏.\n\n"
            "üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞\n"
            "–ú–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å —Å–∏–¥—è –¥–ª—è –±–æ–ª—å—à–µ–π —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏."
        )
    },
    "band_pull": {
        "title": "–¢—è–≥–∞ —Ä–µ–∑–∏–Ω–∫–∏ —Å–≤–µ—Ä—Ö—É",
        "img": "media/tech/band_pull.jpg",
        "text": (
            "üìö –¢—è–≥–∞ —Ä–µ–∑–∏–Ω–∫–∏ —Å–≤–µ—Ä—Ö—É (—Å–ø–∏–Ω–∞ –¥–æ–º–∞)\n\n"
            "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞\n"
            "‚Ä¢ –ó–∞—Ü–µ–ø–∏ —Ä–µ–∑–∏–Ω–∫—É –∑–∞ –≤–µ—Ä—Ö–Ω—é—é —Ç–æ—á–∫—É (–¥–≤–µ—Ä—å, —Ç—É—Ä–Ω–∏–∫).\n"
            "‚Ä¢ –°—è–¥—å –∏–ª–∏ –≤—Å—Ç–∞–Ω—å, —Å–ø–∏–Ω–∞ –ø—Ä—è–º–∞—è.\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –ù–∞—á–Ω–∏ —Å –ª–æ–ø–∞—Ç–æ–∫: –ø–æ—Ç—è–Ω–∏ –∏—Ö –≤–Ω–∏–∑ –∫ –∫–∞—Ä–º–∞–Ω–∞–º.\n"
            "2) –¢—è–Ω–∏ –ª–æ–∫—Ç–∏ –≤–Ω–∏–∑ –∏ –Ω–∞–∑–∞–¥.\n"
            "3) –†–µ–∑–∏–Ω–∫–∞ –∫ –≤–µ—Ä—Ö–Ω–µ–π —á–∞—Å—Ç–∏ –≥—Ä—É–¥–∏, –ø–∞—É–∑–∞.\n"
            "4) –ú–µ–¥–ª–µ–Ω–Ω–æ –≤–µ—Ä–Ω–∏—Å—å –≤–≤–µ—Ä—Ö.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –¢—è–Ω–µ—à—å —Ä—É–∫–∞–º–∏ ‚Üí –ª–æ–ø–∞—Ç–∫–∏ –≤–µ–¥—É—Ç –¥–≤–∏–∂–µ–Ω–∏–µ.\n"
            "‚Ä¢ –†–∞—Å–∫–∞—á–∫–∞ ‚Üí –∑–∞—Ñ–∏–∫—Å–∏—Ä—É–π –∫–æ—Ä–ø—É—Å.\n\n"
            "üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞\n"
            "–û—Ç–ª–∏—á–Ω–∞—è –∑–∞–º–µ–Ω–∞ –≤–µ—Ä—Ö–Ω–µ–º—É –±–ª–æ–∫—É –¥–ª—è –¥–æ–º–∞—à–Ω–∏—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫."
        )
    },
    "good_morning": {
        "title": "Good Morning",
        "img": "media/tech/good_morning.jpg",
        "text": (
            "üìö Good Morning (–ø–æ—è—Å–Ω–∏—Ü–∞ + –∑–∞–¥–Ω—è—è –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å –±–µ–¥—Ä–∞)\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –ù–æ–≥–∏ –Ω–∞ —à–∏—Ä–∏–Ω–µ –ø–ª–µ—á, —Ä—É–∫–∏ –∑–∞ –≥–æ–ª–æ–≤–æ–π.\n"
            "2) –ù–µ–±–æ–ª—å—à–æ–π —Å–≥–∏–± –≤ –∫–æ–ª–µ–Ω—è—Ö, –Ω–∞–∫–ª–æ–Ω –≤–ø–µ—Ä—ë–¥ —Å –ø—Ä—è–º–æ–π —Å–ø–∏–Ω–æ–π.\n"
            "3) –ù–∞–∫–ª–æ–Ω—è–π—Å—è –¥–æ –ø–∞—Ä–∞–ª–ª–µ–ª–∏ —Å –ø–æ–ª–æ–º (–∏–ª–∏ –¥–æ –Ω–∞—Ç—è–∂–µ–Ω–∏—è –≤ –±—ë–¥—Ä–∞—Ö).\n"
            "4) –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è, –≤—ã—Ç–∞–ª–∫–∏–≤–∞—è —Ç–∞–∑ –≤–ø–µ—Ä—ë–¥.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –°–ø–∏–Ω–∞ –æ–∫—Ä—É–≥–ª—è–µ—Ç—Å—è ‚Üí —Å–¥–µ–ª–∞–π –∞–º–ø–ª–∏—Ç—É–¥—É –º–µ–Ω—å—à–µ.\n"
            "‚Ä¢ –°–ª–∏—à–∫–æ–º —Ç—è–∂–µ–ª–æ ‚Üí –Ω–∞—á–Ω–∏ —Å–æ–≤—Å–µ–º –±–µ–∑ –≤–µ—Å–∞.\n\n"
            "üí° –í–∞–∂–Ω–æ\n"
            "–û—á–µ–Ω—å –ª—ë–≥–∫–æ–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –ø–æ –≤–µ—Å—É ‚Äî –∑–¥–µ—Å—å –≤–∞–∂–Ω–∞ —Ç–µ—Ö–Ω–∏–∫–∞, –Ω–µ –Ω–∞–≥—Ä—É–∑–∫–∞."
        )
    },
    "face_pull": {
        "title": "Face Pull",
        "img": "media/tech/face_pull.jpg",
        "text": (
            "üìö Face Pull / –¢—è–≥–∞ –∫ –ª–∏—Ü—É (–∑–∞–¥–Ω—è—è –¥–µ–ª—å—Ç–∞ + —Ä–æ—Ç–∞—Ç–æ—Ä—ã)\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –ë–ª–æ–∫/—Ä–µ–∑–∏–Ω–∫–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ª–∏—Ü–∞ –∏–ª–∏ —á—É—Ç—å –≤—ã—à–µ.\n"
            "2) –¢—è–Ω–∏ –∫ –ª–∏—Ü—É, –ª–æ–∫—Ç–∏ –≤—ã—à–µ –ø–ª–µ—á.\n"
            "3) –í –∫–æ–Ω—Ü–µ —Ä–∞–∑–≤–µ–¥–∏ —Ä—É–∫–∏, –∫–∞–∫ –±—É–¥—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—à—å ¬´–¥–≤–æ–π–Ω–æ–π –±–∏—Ü–µ–ø—Å¬ª.\n"
            "4) –ú–µ–¥–ª–µ–Ω–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–π—Å—è.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –õ–æ–∫—Ç–∏ –Ω–∏–∂–µ –ø–ª–µ—á ‚Üí –Ω–∞–≥—Ä—É–∑–∫–∞ —É—Ö–æ–¥–∏—Ç —Å–æ —Å—Ä–µ–¥–Ω–µ–π –¥–µ–ª—å—Ç—ã.\n"
            "‚Ä¢ –†–∞—Å–∫–∞—á–∫–∞ –∫–æ—Ä–ø—É—Å–æ–º ‚Üí —Å–Ω–∏–∑—å –≤–µ—Å.\n\n"
            "üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞\n"
            "–û—Ç–ª–∏—á–Ω–∞—è –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∞ —Ç—Ä–∞–≤–º –ø–ª–µ—á–∞ ‚Äî –¥–µ–ª–∞–π —Ä–µ–≥—É–ª—è—Ä–Ω–æ."
        )
    },
    "rear_delt": {
        "title": "–ó–∞–¥–Ω—è—è –¥–µ–ª—å—Ç–∞",
        "img": "media/tech/rear_delt.jpg",
        "text": (
            "üìö –ó–∞–¥–Ω—è—è –¥–µ–ª—å—Ç–∞ (–≥–∞–Ω—Ç–µ–ª–∏ –∏–ª–∏ —Ç—Ä–µ–Ω–∞–∂—ë—Ä)\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å (–≥–∞–Ω—Ç–µ–ª–∏ –≤ –Ω–∞–∫–ª–æ–Ω–µ)\n"
            "1) –ù–∞–∫–ª–æ–Ω –∫–æ—Ä–ø—É—Å–∞ 45‚Äì90¬∞, –≥–∞–Ω—Ç–µ–ª–∏ —Å–≤–∏—Å–∞—é—Ç –≤–Ω–∏–∑.\n"
            "2) –†–∞–∑–≤–æ–¥–∏ —Ä—É–∫–∏ –≤ —Å—Ç–æ—Ä–æ–Ω—ã, –ª–æ–∫—Ç–∏ —Å–ª–µ–≥–∫–∞ —Å–æ–≥–Ω—É—Ç—ã.\n"
            "3) –í –≤–µ—Ä—Ö–Ω–µ–π —Ç–æ—á–∫–µ ‚Äî –ø–∞—É–∑–∞, –ª–æ–ø–∞—Ç–∫–∏ —Å–≤–µ–¥–µ–Ω—ã.\n"
            "4) –ú–µ–¥–ª–µ–Ω–Ω–æ –≤–Ω–∏–∑.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –ü–æ–¥–Ω–∏–º–∞–µ—à—å –ø–ª–µ—á–∏ –∫ —É—à–∞–º ‚Üí —Ä–∞—Å—Å–ª–∞–±—å –∏—Ö –≤–Ω–∏–∑.\n"
            "‚Ä¢ –°–ª–∏—à–∫–æ–º —Ç—è–∂–µ–ª–æ ‚Üí –Ω–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª—è –≤ –∑–∞–¥–Ω–µ–π –¥–µ–ª—å—Ç–µ.\n\n"
            "üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞\n"
            "–í–µ—Å –º–µ–Ω—å—à–µ, —á–µ–º –∫–∞–∂–µ—Ç—Å—è –Ω—É–∂–Ω—ã–º ‚Äî –∑–∞–¥–Ω—è—è –¥–µ–ª—å—Ç–∞ –º–∞–ª–µ–Ω—å–∫–∞—è –º—ã—à—Ü–∞."
        )
    },
    "hammer": {
        "title": "–ú–æ–ª–æ—Ç–∫–∏",
        "img": "media/tech/hammer.jpg",
        "text": (
            "üìö –ú–æ–ª–æ—Ç–∫–∏ (–±–∏—Ü–µ–ø—Å + –±—Ä–∞—Ö–∏–∞–ª–∏—Å)\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –î–µ—Ä–∂–∏ –≥–∞–Ω—Ç–µ–ª–∏ –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–º —Ö–≤–∞—Ç–æ–º (–ª–∞–¥–æ–Ω–∏ –¥—Ä—É–≥ –∫ –¥—Ä—É–≥—É).\n"
            "2) –°–≥–∏–±–∞–π –¥–æ –ø–∏–∫–∞, –ª–æ–∫—Ç–∏ —É –∫–æ—Ä–ø—É—Å–∞.\n"
            "3) –ú–µ–¥–ª–µ–Ω–Ω–æ –æ–ø—É—Å–∫–∞–π, –ø–æ–ª–Ω–∞—è –∞–º–ø–ª–∏—Ç—É–¥–∞.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –†–∞—Å–∫–∞—á–∫–∞ –∫–æ—Ä–ø—É—Å–æ–º ‚Üí —Å–Ω–∏–∑—å –≤–µ—Å.\n"
            "‚Ä¢ –õ–æ–∫—Ç–∏ —É–µ–∑–∂–∞—é—Ç –≤–ø–µ—Ä—ë–¥ ‚Üí –∑–∞—Ñ–∏–∫—Å–∏—Ä—É–π –∏—Ö —É –±—ë–¥–µ—Ä.\n\n"
            "üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞\n"
            "–ú–æ–ª–æ—Ç–∫–∏ –ª—É—á—à–µ –ø—Ä–æ—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –±—Ä–∞—Ö–∏–∞–ª–∏—Å ‚Äî –¥–µ–ª–∞–µ—Ç —Ä—É–∫—É –≤–∏–∑—É–∞–ª—å–Ω–æ —Ç–æ–ª—â–µ."
        )
    },
    "triceps_oh": {
        "title": "–†–∞–∑–≥–∏–±–∞–Ω–∏–µ —Ç—Ä–∏—Ü–µ–ø—Å–∞ –∏–∑-–∑–∞ –≥–æ–ª–æ–≤—ã",
        "img": "media/tech/triceps_oh.jpg",
        "text": (
            "üìö –†–∞–∑–≥–∏–±–∞–Ω–∏–µ —Ç—Ä–∏—Ü–µ–ø—Å–∞ –∏–∑-–∑–∞ –≥–æ–ª–æ–≤—ã (–¥–ª–∏–Ω–Ω–∞—è –≥–æ–ª–æ–≤–∫–∞)\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –î–µ—Ä–∂–∏ –≥–∞–Ω—Ç–µ–ª—å –¥–≤—É–º—è —Ä—É–∫–∞–º–∏, –ø–æ–¥–Ω–∏–º–∏ –Ω–∞–¥ –≥–æ–ª–æ–≤–æ–π.\n"
            "2) –û–ø—É—Å—Ç–∏ –∑–∞ –≥–æ–ª–æ–≤—É, –ª–æ–∫—Ç–∏ —Å–º–æ—Ç—Ä—è—Ç –≤–≤–µ—Ä—Ö.\n"
            "3) –†–∞–∑–≥–∏–±–∞–π –¥–æ –ø—Ä—è–º—ã—Ö —Ä—É–∫, –º–µ–¥–ª–µ–Ω–Ω–æ –æ–ø—É—Å–∫–∞–π.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –õ–æ–∫—Ç–∏ —Ä–∞—Å—Ö–æ–¥—è—Ç—Å—è –≤ —Å—Ç–æ—Ä–æ–Ω—ã ‚Üí –¥–µ—Ä–∂–∏ –∏—Ö —É–∑–∫–æ.\n"
            "‚Ä¢ –®–µ—è –Ω–∞–ø—Ä—è–≥–∞–µ—Ç—Å—è ‚Üí —Ä–∞—Å—Å–ª–∞–±—å –≥–æ–ª–æ–≤—É –≤–ø–µ—Ä—ë–¥.\n\n"
            "üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞\n"
            "–î–ª–∏–Ω–Ω–∞—è –≥–æ–ª–æ–≤–∫–∞ —Ç—Ä–∏—Ü–µ–ø—Å–∞ –ª—É—á—à–µ —Ä–∞—Å—Ç—è–≥–∏–≤–∞–µ—Ç—Å—è ‚Äî –¥–µ–ª–∞–µ—Ç —Ä—É–∫—É ¬´–æ–±—ä—ë–º–Ω–µ–µ¬ª."
        )
    },
    "narrow_pushup": {
        "title": "–û—Ç–∂–∏–º–∞–Ω–∏—è —É–∑–∫–∏–µ",
        "img": "media/tech/narrow_pushup.jpg",
        "text": (
            "üìö –£–∑–∫–∏–µ –æ—Ç–∂–∏–º–∞–Ω–∏—è (—Ç—Ä–∏—Ü–µ–ø—Å)\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –õ–∞–¥–æ–Ω–∏ –ø–æ–¥ –≥—Ä—É–¥—å—é, –±–ª–∏–∑–∫–æ –¥—Ä—É–≥ –∫ –¥—Ä—É–≥—É (–∏–ª–∏ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–æ–º).\n"
            "2) –¢–µ–ª–æ ‚Äî –ø—Ä—è–º–∞—è –ª–∏–Ω–∏—è, –ø—Ä–µ—Å—Å –≤–∫–ª—é—á—ë–Ω.\n"
            "3) –û–ø—É—Å–∫–∞–π—Å—è, –ª–æ–∫—Ç–∏ –∏–¥—É—Ç –Ω–∞–∑–∞–¥ –≤–¥–æ–ª—å —Ç–µ–ª–∞.\n"
            "4) –í—ã–∂–∏–º–∞–π, —Ñ–æ–∫—É—Å –Ω–∞ —Ç—Ä–∏—Ü–µ–ø—Å.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –õ–æ–∫—Ç–∏ –≤ —Å—Ç–æ—Ä–æ–Ω—ã ‚Üí —ç—Ç–æ —É–∂–µ –æ–±—ã—á–Ω—ã–µ –æ—Ç–∂–∏–º–∞–Ω–∏—è.\n"
            "‚Ä¢ –¢–∞–∑ –ø—Ä–æ–≤–∏—Å–∞–µ—Ç ‚Üí –Ω–∞–ø—Ä—è–≥–∏ –ø—Ä–µ—Å—Å –∏ —è–≥–æ–¥–∏—Ü—ã.\n\n"
            "üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞\n"
            "–ß–µ–º —É–∂–µ —Ö–≤–∞—Ç, —Ç–µ–º –±–æ–ª—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ —Ç—Ä–∏—Ü–µ–ø—Å ‚Äî –Ω–æ –Ω–µ –ø–µ—Ä–µ—É—Å–µ—Ä–¥—Å—Ç–≤—É–π."
        )
    },
    "hack_squat": {
        "title": "–•–∞–∫–∫-–ø—Ä–∏—Å–µ–¥",
        "img": "media/tech/hack_squat.jpg",
        "text": (
            "üìö –•–∞–∫–∫-–ø—Ä–∏—Å–µ–¥ (–∫–≤–∞–¥—Ä–∏—Ü–µ–ø—Å)\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –í —Ç—Ä–µ–Ω–∞–∂—ë—Ä–µ: —Å–ø–∏–Ω–∞ –ø—Ä–∏–∂–∞—Ç–∞ –∫ –ø–æ–¥—É—à–∫–µ, —Å—Ç–æ–ø—ã –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ.\n"
            "2) –û–ø—É—Å–∫–∞–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—É –¥–æ 90¬∞ –≤ –∫–æ–ª–µ–Ω—è—Ö –∏–ª–∏ –Ω–∏–∂–µ.\n"
            "3) –ñ–º–∏ –≤–≤–µ—Ä—Ö –±–µ–∑ ¬´–∑–∞–º–∫–∞¬ª –≤ –∫–æ–ª–µ–Ω—è—Ö.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –ü–æ—è—Å–Ω–∏—Ü–∞ –æ—Ç—Ä—ã–≤–∞–µ—Ç—Å—è –æ—Ç –ø–æ–¥—É—à–∫–∏ ‚Üí —Å–Ω–∏–∑—å –∞–º–ø–ª–∏—Ç—É–¥—É.\n"
            "‚Ä¢ –ö–æ–ª–µ–Ω–∏ –≤–Ω—É—Ç—Ä—å ‚Üí —Å–ª–µ–¥–∏ –∑–∞ —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–µ–π.\n\n"
            "üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞\n"
            "–°—Ç–æ–ø—ã –≤—ã—à–µ = –±–æ–ª—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ —è–≥–æ–¥–∏—Ü—ã. –ù–∏–∂–µ = –±–æ–ª—å—à–µ –Ω–∞ –∫–≤–∞–¥—Ä–∏—Ü–µ–ø—Å."
        )
    },
    "bulgarian": {
        "title": "–ë–æ–ª–≥–∞—Ä—Å–∫–∏–µ –≤—ã–ø–∞–¥—ã",
        "img": "media/tech/bulgarian.jpg",
        "text": (
            "üìö –ë–æ–ª–≥–∞—Ä—Å–∫–∏–µ –≤—ã–ø–∞–¥—ã (–Ω–æ–≥–∏ + —è–≥–æ–¥–∏—Ü—ã)\n\n"
            "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞\n"
            "‚Ä¢ –ó–∞–¥–Ω—è—è –Ω–æ–≥–∞ –Ω–∞ —Å–∫–∞–º—å–µ, –ø–µ—Ä–µ–¥–Ω—è—è ‚Äî –Ω–∞ —à–∞–≥ –≤–ø–µ—Ä—ë–¥.\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –û–ø—É—Å–∫–∞–π—Å—è –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ, –∑–∞–¥–Ω–µ–µ –∫–æ–ª–µ–Ω–æ –∫ –ø–æ–ª—É.\n"
            "2) –ü–µ—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–µ–Ω–æ –Ω–µ –≤—ã—Ö–æ–¥–∏—Ç –∑–∞ –Ω–æ—Å–æ–∫.\n"
            "3) –í—ã—Ç–∞–ª–∫–∏–≤–∞–π—Å—è –ø–µ—Ä–µ–¥–Ω–µ–π –Ω–æ–≥–æ–π –≤–≤–µ—Ä—Ö.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –®–∞–≥ —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π ‚Üí –∫–æ–ª–µ–Ω–Ω—ã–π —Å—É—Å—Ç–∞–≤ –ø–µ—Ä–µ–≥—Ä—É–∂–∞–µ—Ç—Å—è.\n"
            "‚Ä¢ –ö–æ—Ä–ø—É—Å –∑–∞–≤–∞–ª–∏–≤–∞–µ—Ç—Å—è ‚Üí –¥–µ—Ä–∂–∏ –≥—Ä—É–¥—å –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ.\n\n"
            "üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞\n"
            "–¢—è–∂–µ–ª–µ–µ –æ–±—ã—á–Ω—ã—Ö –ø—Ä–∏—Å–µ–¥–∞–Ω–∏–π ‚Äî –Ω–∞—á–Ω–∏ –±–µ–∑ –≤–µ—Å–∞."
        )
    },
    "deadlift": {
        "title": "–°—Ç–∞–Ω–æ–≤–∞—è —Ç—è–≥–∞",
        "img": "media/tech/deadlift.jpg",
        "text": (
            "üìö –°—Ç–∞–Ω–æ–≤–∞—è —Ç—è–≥–∞ (–±–∞–∑–æ–≤–æ–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ)\n\n"
            "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞\n"
            "‚Ä¢ –°—Ç–æ–ø—ã –Ω–∞ —à–∏—Ä–∏–Ω–µ –±—ë–¥–µ—Ä, –Ω–æ—Å–∫–∏ —á—É—Ç—å –Ω–∞—Ä—É–∂—É.\n"
            "‚Ä¢ –ì—Ä–∏—Ñ –Ω–∞–¥ —Å–µ—Ä–µ–¥–∏–Ω–æ–π —Å—Ç–æ–ø—ã, —Ö–≤–∞—Ç —á—É—Ç—å —à–∏—Ä–µ –±—ë–¥–µ—Ä.\n"
            "‚Ä¢ –õ–æ–ø–∞—Ç–∫–∏ –æ–ø—É—Å—Ç–∏ –≤–Ω–∏–∑ –∏ –Ω–∞–∑–∞–¥.\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –í–¥–æ—Ö, –Ω–∞–ø—Ä—è–≥–∏ –∫–æ—Ä–ø—É—Å ‚Äî ¬´–∂–∏–≤–æ—Ç –≤ —Ç–æ–Ω—É—Å–µ¬ª.\n"
            "2) –¢–æ–ª–∫–∞–π –ø–æ–ª –Ω–æ–≥–∞–º–∏, –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —Ä–∞–∑–≥–∏–±–∞—è —Å–ø–∏–Ω—É.\n"
            "3) –ì—Ä–∏—Ñ –∏–¥—ë—Ç —Å—Ç—Ä–æ–≥–æ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ, –±–ª–∏–∑–∫–æ –∫ –Ω–æ–≥–∞–º.\n"
            "4) –ù–∞–≤–µ—Ä—Ö—É ‚Äî –±—ë–¥—Ä–∞ –≤–ø–µ—Ä—ë–¥, –±–µ–∑ –ø–µ—Ä–µ–≥–∏–±–∞ –ø–æ—è—Å–Ω–∏—Ü—ã.\n"
            "5) –û–ø—É—Å–∫–∞–π —Ç–∞–∫ –∂–µ –ø–æ–¥ –∫–æ–Ω—Ç—Ä–æ–ª–µ–º.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –û–∫—Ä—É–≥–ª–µ–Ω–∏–µ –ø–æ—è—Å–Ω–∏—Ü—ã ‚Üí —Å–Ω–∏–∑—å –≤–µ—Å.\n"
            "‚Ä¢ –ì—Ä–∏—Ñ –æ—Ç—Ö–æ–¥–∏—Ç –æ—Ç –Ω–æ–≥ ‚Üí —Ç—è–Ω–∏ –∫ —Å–µ–±–µ.\n"
            "‚Ä¢ –†—ã–≤–æ–∫ —Å –ø–æ–ª–∞ ‚Üí –ø–ª–∞–≤–Ω—ã–π —Å—Ç–∞—Ä—Ç —Å –∫–æ–Ω—Ç—Ä–æ–ª–µ–º.\n\n"
            "üí° –í–∞–∂–Ω–æ\n"
            "–ù–∞—á–∏–Ω–∞–π —Å –ª—ë–≥–∫–æ–≥–æ –≤–µ—Å–∞ –∏ –∏–¥–µ–∞–ª—å–Ω–æ–π —Ç–µ—Ö–Ω–∏–∫–∏."
        )
    },
    "barbell_row": {
        "title": "–¢—è–≥–∞ —à—Ç–∞–Ω–≥–∏ –≤ –Ω–∞–∫–ª–æ–Ω–µ",
        "img": "media/tech/barbell_row.jpg",
        "text": (
            "üìö –¢—è–≥–∞ —à—Ç–∞–Ω–≥–∏ –≤ –Ω–∞–∫–ª–æ–Ω–µ (—Å–µ—Ä–µ–¥–∏–Ω–∞ —Å–ø–∏–Ω—ã)\n\n"
            "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞\n"
            "‚Ä¢ –ù–∞–∫–ª–æ–Ω 45¬∞, —Å–ø–∏–Ω–∞ –ø—Ä—è–º–∞—è, —à—Ç–∞–Ω–≥–∞ –ø–æ–¥ –ø–ª–µ—á–∞–º–∏.\n"
            "‚Ä¢ –•–≤–∞—Ç –Ω–µ–º–Ω–æ–≥–æ —à–∏—Ä–µ –ø–ª–µ—á (–ø—Ä—è–º–æ–π –∏–ª–∏ –æ–±—Ä–∞—Ç–Ω—ã–π).\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –¢—è–Ω–∏ —à—Ç–∞–Ω–≥—É –∫ –ø–æ—è—Å—É, –Ω–∞—á–∏–Ω–∞–π —Å –ª–æ–ø–∞—Ç–æ–∫.\n"
            "2) –õ–æ–∫—Ç–∏ –∏–¥—É—Ç –≤–¥–æ–ª—å —Ç–µ–ª–∞ –Ω–∞–∑–∞–¥.\n"
            "3) –ü–∞—É–∑–∞ 1 —Å–µ–∫ ‚Äî –ª–æ–ø–∞—Ç–∫–∏ —Å–≤–µ–¥–µ–Ω—ã.\n"
            "4) –ú–µ–¥–ª–µ–Ω–Ω–æ –æ–ø—É—Å–∫–∞–π –¥–æ –≤—ã–ø—Ä—è–º–ª–µ–Ω–∏—è —Ä—É–∫.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –†–∞—Å–∫–∞—á–∫–∞ –∫–æ—Ä–ø—É—Å–æ–º ‚Üí —Å–Ω–∏–∑—å –≤–µ—Å.\n"
            "‚Ä¢ –¢—è–Ω–µ—à—å —Ä—É–∫–∞–º–∏ ‚Üí –¥—É–º–∞–π ¬´–ª–æ–∫—Ç–∏ –Ω–∞–∑–∞–¥¬ª.\n\n"
            "üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞\n"
            "–û–¥–Ω–æ –∏–∑ –ª—É—á—à–∏—Ö —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π –¥–ª—è —Ç–æ–ª—â–∏–Ω—ã —Å–ø–∏–Ω—ã."
        )
    },
    "incline_press": {
        "title": "–ñ–∏–º –ø–æ–¥ —É–≥–ª–æ–º (incline)",
        "img": "media/tech/incline_press.jpg",
        "text": (
            "üìö –ñ–∏–º –ø–æ–¥ —É–≥–ª–æ–º (–≤–µ—Ä—Ö –≥—Ä—É–¥–∏ + –ø–µ—Ä–µ–¥–Ω—è—è –¥–µ–ª—å—Ç–∞)\n\n"
            "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞\n"
            "‚Ä¢ –°–∫–∞–º—å—è 30‚Äì45¬∞, –ª–æ–ø–∞—Ç–∫–∏ —Å–≤–µ–¥–µ–Ω—ã –∏ –ø—Ä–∏–∂–∞—Ç—ã.\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –û–ø—É—Å–∫–∞–π –≥—Ä–∏—Ñ/–≥–∞–Ω—Ç–µ–ª–∏ –∫ –≤–µ—Ä—Ö–Ω–µ–π —á–∞—Å—Ç–∏ –≥—Ä—É–¥–∏.\n"
            "2) –õ–æ–∫—Ç–∏ ~45¬∞ –∫ –∫–æ—Ä–ø—É—Å—É.\n"
            "3) –ñ–º–∏ –≤–≤–µ—Ä—Ö –∏ —á—É—Ç—å –Ω–∞–∑–∞–¥ (–∫ —Å—Ç–æ–π–∫–∞–º).\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –£–≥–æ–ª > 60¬∞ ‚Üí –Ω–∞–≥—Ä—É–∑–∫–∞ —É—Ö–æ–¥–∏—Ç –Ω–∞ –ø–ª–µ—á–∏.\n"
            "‚Ä¢ –ü–ª–µ—á–∏ –≤–ø–µ—Ä—ë–¥ ‚Üí —Å–Ω–æ–≤–∞ —Å–≤–µ–¥–∏ –ª–æ–ø–∞—Ç–∫–∏.\n\n"
            "üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞\n"
            "–û—Ç–ª–∏—á–Ω–æ –ø—Ä–æ—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤–µ—Ä—Ö–Ω–∏–π –ø—É—á–æ–∫ –≥—Ä—É–¥–∏."
        )
    },
    "ohp_barbell": {
        "title": "–ñ–∏–º —à—Ç–∞–Ω–≥–∏ —Å—Ç–æ—è (OHP)",
        "img": "media/tech/ohp_barbell.jpg",
        "text": (
            "üìö –ñ–∏–º —à—Ç–∞–Ω–≥–∏ —Å—Ç–æ—è ‚Äî Overhead Press\n\n"
            "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞\n"
            "‚Ä¢ –•–≤–∞—Ç —á—É—Ç—å —à–∏—Ä–µ –ø–ª–µ—á, –ª–æ–∫—Ç–∏ –Ω–µ–º–Ω–æ–≥–æ –≤–ø–µ—Ä—ë–¥.\n"
            "‚Ä¢ –ü—Ä–µ—Å—Å –Ω–∞–ø—Ä—è–∂—ë–Ω, —è–≥–æ–¥–∏—Ü—ã –≤–∫–ª—é—á–µ–Ω—ã, –Ω–æ–≥–∏ —É—Å—Ç–æ–π—á–∏–≤–æ.\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –ñ–º–∏ —à—Ç–∞–Ω–≥—É –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ –≤–≤–µ—Ä—Ö.\n"
            "2) –í –≤–µ—Ä—Ö–Ω–µ–π —Ç–æ—á–∫–µ –≥–æ–ª–æ–≤–∞ –≤—ã—Ö–æ–¥–∏—Ç –≤–ø–µ—Ä—ë–¥ ¬´–≤ –æ–∫–Ω–æ¬ª.\n"
            "3) –û–ø—É—Å–∫–∞–π –º–µ–¥–ª–µ–Ω–Ω–æ –ø–æ–¥ –∫–æ–Ω—Ç—Ä–æ–ª–µ–º.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –ü—Ä–æ–≥–∏–± –≤ –ø–æ—è—Å–Ω–∏—Ü–µ ‚Üí –Ω–∞–ø—Ä—è–≥–∏ –ø—Ä–µ—Å—Å.\n"
            "‚Ä¢ –õ–æ–∫—Ç–∏ —É—Ö–æ–¥—è—Ç –Ω–∞–∑–∞–¥ ‚Üí –¥–µ—Ä–∂–∏ –∏—Ö –ø–æ–¥ –≥—Ä–∏—Ñ–æ–º.\n\n"
            "üí° –ë–∞–∑–æ–≤–æ–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –¥–ª—è –ø–ª–µ—á ‚Äî –¥–æ–±–∞–≤–ª—è–µ—Ç —à–∏—Ä–∏–Ω—É."
        )
    },
    # ‚îÄ‚îÄ –ù–æ–≤—ã–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ –¥–ª—è –≤–∞—Ä–∏–∞—Ü–∏–π ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

    "squat_barbell": {
        "title": "–ü—Ä–∏—Å–µ–¥ —Å–æ —à—Ç–∞–Ω–≥–æ–π",
        "img": "media/tech/squat_barbell.jpg",
        "text": (
            "üìö –ü—Ä–∏—Å–µ–¥ —Å–æ —à—Ç–∞–Ω–≥–æ–π (–∫–≤–∞–¥—Ä–∏—Ü–µ–ø—Å + —è–≥–æ–¥–∏—Ü—ã)\n\n"
            "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞\n"
            "‚Ä¢ –®—Ç–∞–Ω–≥–∞ –Ω–∞ —Ç—Ä–∞–ø–µ—Ü–∏–∏ (–Ω–∏–∑–∫–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ) –∏–ª–∏ –Ω–∞ –≤–µ—Ä—Ö—É (–≤—ã—Å–æ–∫–æ–µ).\n"
            "‚Ä¢ –°—Ç–æ–ø—ã —á—É—Ç—å —à–∏—Ä–µ –ø–ª–µ—á, –Ω–æ—Å–∫–∏ –Ω–∞—Ä—É–∂—É 15‚Äì30¬∞.\n"
            "‚Ä¢ –í–¥–æ—Ö ¬´–≤ –∂–∏–≤–æ—Ç¬ª, –ø—Ä–µ—Å—Å –∏ —Å–ø–∏–Ω–∞ –≤ —Ç–æ–Ω—É—Å–µ.\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –¢–∞–∑ –Ω–∞–∑–∞–¥ –∏ –≤–Ω–∏–∑ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.\n"
            "2) –ö–æ–ª–µ–Ω–∏ –ø–æ –ª–∏–Ω–∏–∏ –Ω–æ—Å–∫–æ–≤, –Ω–µ –∑–∞–≤–∞–ª–∏–≤–∞–π –≤–Ω—É—Ç—Ä—å.\n"
            "3) –ì—Ä—É–¥—å —Å–º–æ—Ç—Ä–∏—Ç –≤–ø–µ—Ä—ë–¥, –≤–∑–≥–ª—è–¥ –ø—Ä—è–º–æ –∏–ª–∏ —á—É—Ç—å –≤–Ω–∏–∑.\n"
            "4) –í –Ω–∏–∂–Ω–µ–π —Ç–æ—á–∫–µ ‚Äî –∫–æ–Ω—Ç—Ä–æ–ª—å, –≥–ª—É–±–∏–Ω–∞ –¥–æ –ø–∞—Ä–∞–ª–ª–µ–ª–∏ –∏–ª–∏ –Ω–∏–∂–µ.\n"
            "5) –í—Å—Ç–∞–≤–∞–π, –≤—ã–¥–æ—Ö –≤ —É—Å–∏–ª–∏–∏, –Ω–µ ¬´–∑–∞–º–æ–∫¬ª –≤ –∫–æ–ª–µ–Ω—è—Ö.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –®—Ç–∞–Ω–≥–∞ –æ—Ç–∫–∞—Ç—ã–≤–∞–µ—Ç—Å—è –Ω–∞ —à–µ–µ ‚Üí –Ω–∞–ø—Ä—è–≥–∏ —Ç—Ä–∞–ø–µ—Ü–∏—é.\n"
            "‚Ä¢ –ö–æ–ª–µ–Ω–∏ –≤–Ω—É—Ç—Ä—å ‚Üí –¥—É–º–∞–π ¬´—Ä–∞–∑–¥–≤–∏–≥–∞—é –ø–æ–ª¬ª.\n"
            "‚Ä¢ –ü–æ—è—Å–Ω–∏—Ü–∞ –æ–∫—Ä—É–≥–ª—è–µ—Ç—Å—è ‚Üí –º–µ–Ω—å—à–µ –≥–ª—É–±–∏–Ω–∞ –∏–ª–∏ —É–ª—É—á—à–∏ –º–æ–±–∏–ª—å–Ω–æ—Å—Ç—å.\n\n"
            "üí° –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å\n"
            "–°—Ç—Ä–∞—Ö–æ–≤–æ—á–Ω—ã–µ —Å—Ç–æ–π–∫–∏ –≤—Å–µ–≥–¥–∞ –≥–æ—Ç–æ–≤—ã. –ù–∞—á–∏–Ω–∞–π —Å –ª—ë–≥–∫–æ–≥–æ –≤–µ—Å–∞."
        )
    },
    "squat_bodyweight": {
        "title": "–ü—Ä–∏—Å–µ–¥ (—Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–µ—Å)",
        "img": "media/tech/squat_bodyweight.jpg",
        "text": (
            "üìö –ü—Ä–∏—Å–µ–¥ –Ω–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–º –≤–µ—Å–µ\n\n"
            "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞\n"
            "‚Ä¢ –°—Ç–æ–ø—ã –Ω–∞ —à–∏—Ä–∏–Ω–µ –ø–ª–µ—á –∏–ª–∏ —á—É—Ç—å —à–∏—Ä–µ, –Ω–æ—Å–∫–∏ —Å–ª–µ–≥–∫–∞ –Ω–∞—Ä—É–∂—É.\n"
            "‚Ä¢ –†—É–∫–∏ –≤–ø–µ—Ä—ë–¥ –¥–ª—è –±–∞–ª–∞–Ω—Å–∞ –∏–ª–∏ —Å–∫—Ä–µ—â–µ–Ω—ã –Ω–∞ –≥—Ä—É–¥–∏.\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –£–≤–æ–¥–∏ —Ç–∞–∑ –Ω–∞–∑–∞–¥ –∏ –≤–Ω–∏–∑.\n"
            "2) –ö–æ–ª–µ–Ω–∏ –∏–¥—É—Ç –ø–æ –ª–∏–Ω–∏–∏ –Ω–æ—Å–∫–æ–≤.\n"
            "3) –û–ø—É—Å–∫–∞–π—Å—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –≥–ª—É–±–æ–∫–æ –±–µ–∑ –æ–∫—Ä—É–≥–ª–µ–Ω–∏—è —Å–ø–∏–Ω—ã.\n"
            "4) –í—Å—Ç–∞–≤–∞–π, —Ç–æ–ª–∫–∞—è –ø–æ–ª –Ω–æ–≥–∞–º–∏.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –ü—è—Ç–∫–∏ –æ—Ç—Ä—ã–≤–∞—é—Ç—Å—è ‚Üí —Ä–∞—Å—à–∏—Ä—å —Å—Ç–æ–π–∫—É –∏–ª–∏ –ø–æ–¥–ª–æ–∂–∏ –±–ª–∏–Ω –ø–æ–¥ –ø—è—Ç–∫–∏.\n"
            "‚Ä¢ –ö–æ—Ä–ø—É—Å –ø–∞–¥–∞–µ—Ç –≤–ø–µ—Ä—ë–¥ ‚Üí –ø–æ–¥–Ω–∏–º–∏ —Ä—É–∫–∏ –≤–ø–µ—Ä—ë–¥ –∫–∞–∫ –ø—Ä–æ—Ç–∏–≤–æ–≤–µ—Å.\n\n"
            "üí° –ü—Ä–æ–≥—Ä–µ—Å—Å–∏—è\n"
            "–û—Å–≤–æ–π —Ç–µ—Ö–Ω–∏–∫—É –∑–¥–µ—Å—å, –∑–∞—Ç–µ–º –ø–µ—Ä–µ—Ö–æ–¥–∏ –∫ –≥–æ–±–ª–µ—Ç-–ø—Ä–∏—Å—è–¥—É –∏–ª–∏ –ø—Ä–∏—Å—è–¥—É —Å–æ —à—Ç–∞–Ω–≥–æ–π."
        )
    },
    "squat_sumo": {
        "title": "–ü—Ä–∏—Å–µ–¥ —Å—É–º–æ",
        "img": "media/tech/squat_sumo.jpg",
        "text": (
            "üìö –ü—Ä–∏—Å–µ–¥ —Å—É–º–æ (–ø—Ä–∏–≤–æ–¥—è—â–∏–µ + —è–≥–æ–¥–∏—Ü—ã)\n\n"
            "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞\n"
            "‚Ä¢ –®–∏—Ä–æ–∫–∞—è —Å—Ç–æ–π–∫–∞: –Ω–æ–≥–∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —à–∏—Ä–µ –ø–ª–µ—á.\n"
            "‚Ä¢ –ù–æ—Å–∫–∏ —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç—ã —Å–∏–ª—å–Ω–æ –Ω–∞—Ä—É–∂—É (45‚Äì60¬∞).\n"
            "‚Ä¢ –°–ø–∏–Ω–∞ –ø—Ä—è–º–∞—è, –∫–æ—Ä–ø—É—Å –≤–µ—Ä—Ç–∏–∫–∞–ª–µ–Ω.\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –û–ø—É—Å–∫–∞–π—Å—è –≤–Ω–∏–∑, –∫–æ–ª–µ–Ω–∏ —Ä–∞–∑–≤–æ–¥–∏ –ø–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—é –Ω–æ—Å–∫–æ–≤.\n"
            "2) –¢–∞–∑ —É—Ö–æ–¥–∏—Ç –ø—Ä—è–º–æ –≤–Ω–∏–∑ (–Ω–µ –Ω–∞–∑–∞–¥ –∫–∞–∫ –≤ –æ–±—ã—á–Ω–æ–º –ø—Ä–∏—Å–µ–¥–µ).\n"
            "3) –ë—ë–¥—Ä–∞ –≤ –Ω–∏–∂–Ω–µ–π —Ç–æ—á–∫–µ ‚Äî –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –ø–æ–ª—É –∏–ª–∏ –Ω–∏–∂–µ.\n"
            "4) –í—Å—Ç–∞–≤–∞–π, –≤—ã—Ç–∞–ª–∫–∏–≤–∞—è –ø–æ–ª —à–∏—Ä–æ–∫–æ –≤ —Å—Ç–æ—Ä–æ–Ω—ã.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –ö–æ–ª–µ–Ω–∏ –∑–∞–≤–∞–ª–∏–≤–∞—é—Ç—Å—è –≤–Ω—É—Ç—Ä—å ‚Üí —Ä–∞–∑–≤–æ–¥–∏ –∞–∫—Ç–∏–≤–Ω–æ –Ω–∞—Ä—É–∂—É.\n"
            "‚Ä¢ –ù–∞–∫–ª–æ–Ω –∫–æ—Ä–ø—É—Å–∞ –≤–ø–µ—Ä—ë–¥ ‚Üí –¥–µ—Ä–∂–∏ –≥—Ä—É–¥—å –≤—ã—à–µ.\n\n"
            "üí° –ü–ª—é—Å\n"
            "–•–æ—Ä–æ—à–æ –Ω–∞–≥—Ä—É–∂–∞–µ—Ç –ø—Ä–∏–≤–æ–¥—è—â–∏–µ –∏ —è–≥–æ–¥–∏—Ü—ã ‚Äî –æ—Ç–ª–∏—á–Ω–∞—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ –æ–±—ã—á–Ω–æ–º—É –ø—Ä–∏—Å–µ–¥—É."
        )
    },
    "bench_dumbbell": {
        "title": "–ñ–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π –ª—ë–∂–∞",
        "img": "media/tech/bench_dumbbell.jpg",
        "text": (
            "üìö –ñ–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π –ª—ë–∂–∞ (–≥—Ä—É–¥—å + —Ç—Ä–∏—Ü–µ–ø—Å)\n\n"
            "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞\n"
            "‚Ä¢ –õ–æ–ø–∞—Ç–∫–∏ —Å–≤–µ–¥–µ–Ω—ã –∏ –ø—Ä–∏–∂–∞—Ç—ã –∫ —Å–∫–∞–º—å–µ.\n"
            "‚Ä¢ –ì–∞–Ω—Ç–µ–ª–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ –≥—Ä—É–¥–∏, –ø—Ä–µ–¥–ø–ª–µ—á—å—è –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã.\n"
            "‚Ä¢ –°—Ç–æ–ø—ã —É—Å—Ç–æ–π—á–∏–≤–æ –Ω–∞ –ø–æ–ª—É.\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –ñ–º–∏ –≥–∞–Ω—Ç–µ–ª–∏ –≤–≤–µ—Ä—Ö, —Å–ª–µ–≥–∫–∞ —Å–≤–æ–¥—è –∏—Ö –Ω–∞–¥ –≥—Ä—É–¥—å—é.\n"
            "2) –õ–æ–∫—Ç–∏ ~45¬∞ –∫ –∫–æ—Ä–ø—É—Å—É (–Ω–µ 90¬∞ –≤ —Å—Ç–æ—Ä–æ–Ω—ã).\n"
            "3) –ê–º–ø–ª–∏—Ç—É–¥–∞: –æ–ø—É—Å–∫–∞–π –Ω–∏–∂–µ, —á–µ–º —Å–æ —à—Ç–∞–Ω–≥–æ–π ‚Äî –±–æ–ª—å—à–µ —Ä–∞—Å—Ç—è–∂–µ–Ω–∏–µ –≥—Ä—É–¥–∏.\n"
            "4) –ù–∞–≤–µ—Ä—Ö—É ‚Äî –ª—ë–≥–∫–æ–µ —Å–≤–µ–¥–µ–Ω–∏–µ –≥–∞–Ω—Ç–µ–ª–µ–π, –ø–∞—É–∑–∞ 1 —Å–µ–∫.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –õ–æ–∫—Ç–∏ —Ä–∞–∑—ä–µ–∑–∂–∞—é—Ç—Å—è –≤ —Å—Ç–æ—Ä–æ–Ω—ã ‚Üí –ø–ª–µ—á–∏ –±–æ–ª—è—Ç.\n"
            "‚Ä¢ –ì–∞–Ω—Ç–µ–ª–∏ ¬´—Ä–∞–∑–±–µ–≥–∞—é—Ç—Å—è¬ª –≤–Ω–∏–∑ ‚Üí –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–π —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏—é.\n\n"
            "üí° –ü–ª—é—Å –≥–∞–Ω—Ç–µ–ª–µ–π\n"
            "–ë–æÃÅ–ª—å—à–∞—è –∞–º–ø–ª–∏—Ç—É–¥–∞ –∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å —Ä—É–∫ ‚Äî –ª—É—á—à–µ –¥–ª—è —Å–∏–º–º–µ—Ç—Ä–∏–∏ –≥—Ä—É–¥–∏."
        )
    },
    "bench_machine": {
        "title": "–ñ–∏–º –≤ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–µ (–≥—Ä—É–¥—å)",
        "img": "media/tech/bench_machine.jpg",
        "text": (
            "üìö –ñ–∏–º –≤ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–µ ‚Äî –≥—Ä—É–¥—å\n\n"
            "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞\n"
            "‚Ä¢ –ù–∞—Å—Ç—Ä–æ–π —Å–∏–¥–µ–Ω—å–µ: —Ä—É–∫–æ—è—Ç–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å–µ—Ä–µ–¥–∏–Ω—ã –≥—Ä—É–¥–∏.\n"
            "‚Ä¢ –°–ø–∏–Ω–∞ –ø—Ä–∏–∂–∞—Ç–∞ –∫ —Å–ø–∏–Ω–∫–µ, –ª–æ–ø–∞—Ç–∫–∏ —Å–≤–µ–¥–µ–Ω—ã.\n"
            "‚Ä¢ –•–≤–∞—Ç –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π –∏–ª–∏ –ø—Ä—è–º–æ–π ‚Äî –ø–æ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–∞.\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –ñ–º–∏ –≤–ø–µ—Ä—ë–¥ –¥–æ –ª—ë–≥–∫–æ–≥–æ —Å–≥–∏–±–∞–Ω–∏—è –ª–æ–∫—Ç–µ–π (–Ω–µ ¬´–∑–∞–º–æ–∫¬ª).\n"
            "2) –ú–µ–¥–ª–µ–Ω–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–π —Ä—É–∫–æ—è—Ç–∏ –∫ –≥—Ä—É–¥–∏ ‚Äî –ø–æ–ª–Ω–∞—è –∞–º–ø–ª–∏—Ç—É–¥–∞.\n"
            "3) –õ–æ–ø–∞—Ç–∫–∏ –¥–µ—Ä–∂–∏ —Å–≤–µ–¥—ë–Ω–Ω—ã–º–∏ –Ω–∞ –ø—Ä–æ—Ç—è–∂–µ–Ω–∏–∏ –≤—Å–µ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –ü–ª–µ—á–∏ –ø–æ–¥–Ω–∏–º–∞—é—Ç—Å—è –∫ —É—à–∞–º ‚Üí –æ–ø—É—Å—Ç–∏ –∏—Ö –≤–Ω–∏–∑.\n"
            "‚Ä¢ –ù–µ–ø–æ–ª–Ω–∞—è –∞–º–ø–ª–∏—Ç—É–¥–∞ ‚Üí —Ç–µ—Ä—è–µ—à—å —Ä–∞—Å—Ç—è–∂–µ–Ω–∏–µ –≥—Ä—É–¥–∏.\n\n"
            "üí° –ü–ª—é—Å —Ç—Ä–µ–Ω–∞–∂—ë—Ä–∞\n"
            "–ë–µ–∑–æ–ø–∞—Å–Ω–µ–µ –¥–ª—è —Å—É—Å—Ç–∞–≤–æ–≤, –∏–¥–µ–∞–ª–µ–Ω –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏ –∏ –¥–æ–±–∏–≤–∫–∏."
        )
    },
    "ohp_dumbbell": {
        "title": "–ñ–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π —Å—Ç–æ—è/—Å–∏–¥—è",
        "img": "media/tech/ohp_dumbbell.jpg",
        "text": (
            "üìö –ñ–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π –Ω–∞–¥ –≥–æ–ª–æ–≤–æ–π (–ø–ª–µ—á–∏)\n\n"
            "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞\n"
            "‚Ä¢ –ì–∞–Ω—Ç–µ–ª–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø–ª–µ—á, –ª–æ–∫—Ç–∏ –ø–æ–¥ –∑–∞–ø—è—Å—Ç—å—è–º–∏.\n"
            "‚Ä¢ –ü—Ä–µ—Å—Å –Ω–∞–ø—Ä—è–∂—ë–Ω, –ø–æ—è—Å–Ω–∏—Ü–∞ –Ω–µ–π—Ç—Ä–∞–ª—å–Ω–∞.\n"
            "‚Ä¢ –°–∏–¥—è: —Å–ø–∏–Ω–∞ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ, –Ω–æ–≥–∏ —É–ø–∏—Ä–∞—é—Ç—Å—è –≤ –ø–æ–ª.\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –ñ–º–∏ –≥–∞–Ω—Ç–µ–ª–∏ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ –≤–≤–µ—Ä—Ö, —Å–ª–µ–≥–∫–∞ —Å–±–ª–∏–∂–∞—è –∏—Ö.\n"
            "2) –í –≤–µ—Ä—Ö–Ω–µ–π —Ç–æ—á–∫–µ ‚Äî —Ä—É–∫–∏ –ø–æ—á—Ç–∏ –ø—Ä—è–º—ã–µ, –±–µ–∑ —Ä—ã–≤–∫–∞.\n"
            "3) –ú–µ–¥–ª–µ–Ω–Ω–æ –æ–ø—É—Å–∫–∞–π –∫ –ø–ª–µ—á–∞–º, –ª–æ–∫—Ç–∏ –ø–æ–¥ 90¬∞.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –ü—Ä–æ–≥–∏–± –≤ –ø–æ—è—Å–Ω–∏—Ü–µ ‚Üí –Ω–∞–ø—Ä—è–≥–∏ –∫–æ—Ä–ø—É—Å –∏–ª–∏ —Å—è–¥—å.\n"
            "‚Ä¢ –ì–∞–Ω—Ç–µ–ª–∏ —É—Ö–æ–¥—è—Ç –≤–ø–µ—Ä—ë–¥ ‚Üí –¥–µ—Ä–∂–∏ –∏—Ö –Ω–∞–¥ –ø–ª–µ—á–∞–º–∏.\n\n"
            "üí° –ü–ª—é—Å –≥–∞–Ω—Ç–µ–ª–µ–π\n"
            "–ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å —Ä—É–∫ ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —Å–∏–º–º–µ—Ç—Ä–∏—é, –º–µ–Ω—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ —Å—É—Å—Ç–∞–≤—ã."
        )
    },
    "ohp_machine": {
        "title": "–ñ–∏–º –≤ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–µ –≤–≤–µ—Ä—Ö",
        "img": "media/tech/ohp_machine.jpg",
        "text": (
            "üìö –ñ–∏–º –≤ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–µ –Ω–∞–¥ –≥–æ–ª–æ–≤–æ–π (–ø–ª–µ—á–∏)\n\n"
            "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞\n"
            "‚Ä¢ –ù–∞—Å—Ç—Ä–æ–π —Å–∏–¥–µ–Ω—å–µ: —Ä—É–∫–æ—è—Ç–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø–ª–µ—á.\n"
            "‚Ä¢ –°–ø–∏–Ω–∞ –ø—Ä–∏–∂–∞—Ç–∞, –ø–æ—è—Å–Ω–∏—Ü–∞ –Ω–µ–π—Ç—Ä–∞–ª—å–Ω–∞.\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –ñ–º–∏ —Ä—É–∫–æ—è—Ç–∏ –≤–≤–µ—Ä—Ö –¥–æ –ª—ë–≥–∫–æ–≥–æ –≤—ã–ø—Ä—è–º–ª–µ–Ω–∏—è —Ä—É–∫.\n"
            "2) –ú–µ–¥–ª–µ–Ω–Ω–æ –æ–ø—É—Å–∫–∞–π –¥–æ —É—Ä–æ–≤–Ω—è –ø–ª–µ—á ‚Äî –ø–æ–ª–Ω–∞—è –∞–º–ø–ª–∏—Ç—É–¥–∞.\n"
            "3) –ü–ª–µ—á–∏ –≤–Ω–∏–∑, –Ω–µ –ø–æ–¥–Ω–∏–º–∞–π –∫ —É—à–∞–º.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –°–ø–∏–Ω–∞ –æ—Ç—Ä—ã–≤–∞–µ—Ç—Å—è –æ—Ç —Å–∏–¥–µ–Ω—å—è ‚Üí —Å–Ω–∏–∑—å –≤–µ—Å.\n"
            "‚Ä¢ –ù–µ–ø–æ–ª–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω ‚Üí —Ç—Ä–µ–Ω–∞–∂—ë—Ä –∑–∞–¥–∞—ë—Ç –ø—É—Ç—å, –∏—Å–ø–æ–ª—å–∑—É–π –µ–≥–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é.\n\n"
            "üí° –ü–ª—é—Å —Ç—Ä–µ–Ω–∞–∂—ë—Ä–∞\n"
            "–ò–¥–µ–∞–ª–µ–Ω –¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤ –∏ –¥–æ–±–∏–≤–∫–∏: —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è –º–∏–Ω–∏–º–∞–ª—å–Ω–∞, —Ñ–æ–∫—É—Å –Ω–∞ –¥–µ–ª—å—Ç–∞—Ö."
        )
    },
    "rdl_barbell": {
        "title": "–†—É–º—ã–Ω—Å–∫–∞—è —Ç—è–≥–∞ —Å–æ —à—Ç–∞–Ω–≥–æ–π",
        "img": "media/tech/rdl_barbell.jpg",
        "text": (
            "üìö –†—É–º—ã–Ω—Å–∫–∞—è —Ç—è–≥–∞ —Å–æ —à—Ç–∞–Ω–≥–æ–π (–∑–∞–¥–Ω—è—è –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å –±–µ–¥—Ä–∞)\n\n"
            "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞\n"
            "‚Ä¢ –•–≤–∞—Ç —á—É—Ç—å —à–∏—Ä–µ –±—ë–¥–µ—Ä (–ø—Ä—è–º–æ–π –∏–ª–∏ —Ä–∞–∑–Ω–æ—Ö–≤–∞—Ç).\n"
            "‚Ä¢ –°—Ç–æ–ø—ã –Ω–∞ —à–∏—Ä–∏–Ω–µ –±—ë–¥–µ—Ä, –∫–æ–ª–µ–Ω–∏ —Å–ª–µ–≥–∫–∞ —Å–æ–≥–Ω—É—Ç—ã.\n"
            "‚Ä¢ –õ–æ–ø–∞—Ç–∫–∏ –æ–ø—É—Å—Ç–∏ –∏ –∑–∞—Ñ–∏–∫—Å–∏—Ä—É–π.\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –¢–∞–∑ –Ω–∞–∑–∞–¥, —à—Ç–∞–Ω–≥–∞ —Å–∫–æ–ª—å–∑–∏—Ç –ø–æ –Ω–æ–≥–∞–º –≤–Ω–∏–∑.\n"
            "2) –°–ø–∏–Ω–∞ –ø—Ä—è–º–∞—è ‚Äî –Ω–µ –æ–∫—Ä—É–≥–ª—è–π –ø–æ—è—Å–Ω–∏—Ü—É.\n"
            "3) –û–ø—É—Å–∫–∞–π—Å—è –¥–æ —Å–∏–ª—å–Ω–æ–≥–æ –Ω–∞—Ç—è–∂–µ–Ω–∏—è –≤ –±—ë–¥—Ä–∞—Ö.\n"
            "4) –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è: —Ç–∞–∑ –≤–ø–µ—Ä—ë–¥, –Ω–µ –ø–µ—Ä–µ–≥–∏–±–∞–π –ø–æ—è—Å–Ω–∏—Ü—É.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –®—Ç–∞–Ω–≥–∞ –æ—Ç—Ö–æ–¥–∏—Ç –æ—Ç –Ω–æ–≥ ‚Üí —Ç—è–Ω–∏ –µ—ë –±–ª–∏–∂–µ, —Ä–∏—Å–∫ –¥–ª—è —Å–ø–∏–Ω—ã.\n"
            "‚Ä¢ –ü—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –ø—Ä–∏—Å–µ–¥ ‚Üí –º–µ–Ω—å—à–µ —Å–≥–∏–±–∞–π –∫–æ–ª–µ–Ω–∏.\n"
            "‚Ä¢ –ü–æ—è—Å–Ω–∏—Ü–∞ –æ–∫—Ä—É–≥–ª—è–µ—Ç—Å—è ‚Üí —É–∫–æ—Ä–æ—Ç–∏ –∞–º–ø–ª–∏—Ç—É–¥—É.\n\n"
            "üí° –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å\n"
            "–ù–∞—á–∏–Ω–∞–π —Å –ª—ë–≥–∫–æ–≥–æ –≤–µ—Å–∞ ‚Äî –ø–æ—è—Å–Ω–∏—Ü–∞ —É—è–∑–≤–∏–º–∞ –ø—Ä–∏ –Ω–∞—Ä—É—à–µ–Ω–∏–∏ —Ç–µ—Ö–Ω–∏–∫–∏."
        )
    },
    "rdl_dumbbell": {
        "title": "–†—É–º—ã–Ω—Å–∫–∞—è —Ç—è–≥–∞ —Å –≥–∞–Ω—Ç–µ–ª—è–º–∏",
        "img": "media/tech/rdl_dumbbell.jpg",
        "text": (
            "üìö –†—É–º—ã–Ω—Å–∫–∞—è —Ç—è–≥–∞ —Å –≥–∞–Ω—Ç–µ–ª—è–º–∏ (–±—ë–¥—Ä–∞ + —è–≥–æ–¥–∏—Ü—ã)\n\n"
            "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞\n"
            "‚Ä¢ –ì–∞–Ω—Ç–µ–ª–∏ –¥–µ—Ä–∂–∏ –ø–µ—Ä–µ–¥ –±—ë–¥—Ä–∞–º–∏, –ª–∞–¥–æ–Ω—è–º–∏ –∫ —Å–µ–±–µ –∏–ª–∏ –Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ.\n"
            "‚Ä¢ –°—Ç–æ–ø—ã –Ω–∞ —à–∏—Ä–∏–Ω–µ –±—ë–¥–µ—Ä, –∫–æ–ª–µ–Ω–∏ —Å–ª–µ–≥–∫–∞ —Å–æ–≥–Ω—É—Ç—ã.\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –¢–∞–∑ –Ω–∞–∑–∞–¥, –≥–∞–Ω—Ç–µ–ª–∏ —Å–∫–æ–ª—å–∑—è—Ç –≤–Ω–∏–∑ –ø–æ –Ω–æ–≥–∞–º.\n"
            "2) –ì–∞–Ω—Ç–µ–ª–∏ –¥–µ—Ä–∂–∏ –±–ª–∏–∂–µ –∫ —Ç–µ–ª—É, –Ω–µ —É–≤–æ–¥–∏ –≤–ø–µ—Ä—ë–¥.\n"
            "3) –°–ø–∏–Ω–∞ –ø—Ä—è–º–∞—è, –¥–æ –Ω–∞—Ç—è–∂–µ–Ω–∏—è –≤ –±—ë–¥—Ä–∞—Ö.\n"
            "4) –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è: —Ç–∞–∑ –≤–ø–µ—Ä—ë–¥, —Å–∂–∏–º–∞–π —è–≥–æ–¥–∏—Ü—ã –Ω–∞–≤–µ—Ä—Ö—É.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –ì–∞–Ω—Ç–µ–ª–∏ —É—Ö–æ–¥—è—Ç –≤–ø–µ—Ä—ë–¥ ‚Üí —Ä–∏—Å–∫ –¥–ª—è —Å–ø–∏–Ω—ã, –¥–µ—Ä–∂–∏ —É –Ω–æ–≥.\n"
            "‚Ä¢ –ö–æ–ª–µ–Ω–∏ —Å–≥–∏–±–∞—é—Ç—Å—è —Å–ª–∏—à–∫–æ–º ‚Üí –º–µ–Ω—å—à–µ —Ä–∞–±–æ—Ç–∞—é—Ç –±—ë–¥—Ä–∞.\n\n"
            "üí° –ü–ª—é—Å –≥–∞–Ω—Ç–µ–ª–µ–π\n"
            "–ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π —Ö–≤–∞—Ç —É–¥–æ–±–Ω–µ–µ –¥–ª—è –∑–∞–ø—è—Å—Ç–∏–π, —Ö–æ—Ä–æ—à–æ –¥–ª—è –æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–µ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞."
        )
    },
    "lunge_barbell": {
        "title": "–í—ã–ø–∞–¥—ã —Å–æ —à—Ç–∞–Ω–≥–æ–π",
        "img": "media/tech/lunge_barbell.jpg",
        "text": (
            "üìö –í—ã–ø–∞–¥—ã —Å–æ —à—Ç–∞–Ω–≥–æ–π (–Ω–æ–≥–∏ + —è–≥–æ–¥–∏—Ü—ã)\n\n"
            "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞\n"
            "‚Ä¢ –®—Ç–∞–Ω–≥–∞ –Ω–∞ —Ç—Ä–∞–ø–µ—Ü–∏–∏, –∫–∞–∫ –ø—Ä–∏ –ø—Ä–∏—Å–µ–¥–µ.\n"
            "‚Ä¢ –°—Ç–æ–π–∫–∞ –Ω–µ–π—Ç—Ä–∞–ª—å–Ω–∞—è, –∫–æ—Ä–ø—É—Å –ø—Ä—è–º–æ–π.\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –®–∞–≥ –≤–ø–µ—Ä—ë–¥ —à–∏—Ä–æ–∫–∏–π, –ø–µ—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–µ–Ω–æ –Ω–µ –∑–∞ –Ω–æ—Å–∫–æ–º.\n"
            "2) –ó–∞–¥–Ω–µ–µ –∫–æ–ª–µ–Ω–æ –æ–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–æ—á—Ç–∏ –¥–æ –ø–æ–ª–∞.\n"
            "3) –û—Ç—Ç–∞–ª–∫–∏–≤–∞–π—Å—è –ø–µ—Ä–µ–¥–Ω–µ–π –Ω–æ–≥–æ–π –Ω–∞–∑–∞–¥.\n"
            "4) –ú–µ–Ω—è–π –Ω–æ–≥–∏ –∏–ª–∏ —Å–¥–µ–ª–∞–π –≤—Å–µ –Ω–∞ –æ–¥–Ω—É, –∑–∞—Ç–µ–º –¥—Ä—É–≥—É—é.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –ö–æ—Ä–ø—É—Å –ø–∞–¥–∞–µ—Ç –≤–ø–µ—Ä—ë–¥ ‚Üí –¥–µ—Ä–∂–∏ —à—Ç–∞–Ω–≥—É —É—Å—Ç–æ–π—á–∏–≤–æ –Ω–∞ —Ç—Ä–∞–ø–µ—Ü–∏–∏.\n"
            "‚Ä¢ –ö–æ–ª–µ–Ω–æ –≤–Ω—É—Ç—Ä—å ‚Üí —Å–ª–µ–¥–∏ –∑–∞ –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ–º.\n\n"
            "üí° –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å\n"
            "–û—Å–≤–æ–π –≤—ã–ø–∞–¥—ã —Å –≥–∞–Ω—Ç–µ–ª—è–º–∏ –∏–ª–∏ –±–µ–∑ –≤–µ—Å–∞ –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º —à—Ç–∞–Ω–≥–∏."
        )
    },
    "lunge_dumbbell": {
        "title": "–í—ã–ø–∞–¥—ã —Å –≥–∞–Ω—Ç–µ–ª—è–º–∏",
        "img": "media/tech/lunge_dumbbell.jpg",
        "text": (
            "üìö –í—ã–ø–∞–¥—ã —Å –≥–∞–Ω—Ç–µ–ª—è–º–∏ (–Ω–æ–≥–∏ + —è–≥–æ–¥–∏—Ü—ã)\n\n"
            "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞\n"
            "‚Ä¢ –ì–∞–Ω—Ç–µ–ª–∏ –≤ –æ–ø—É—â–µ–Ω–Ω—ã—Ö —Ä—É–∫–∞—Ö –ø–æ –±–æ–∫–∞–º.\n"
            "‚Ä¢ –°—Ç–æ–π–∫–∞ –ø—Ä—è–º–∞—è, –≤–∑–≥–ª—è–¥ –≤–ø–µ—Ä—ë–¥.\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –®–∏—Ä–æ–∫–∏–π —à–∞–≥ –≤–ø–µ—Ä—ë–¥, –ø–µ—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–µ–Ω–æ –Ω–µ –∑–∞ –Ω–æ—Å–∫–æ–º.\n"
            "2) –ó–∞–¥–Ω–µ–µ –∫–æ–ª–µ–Ω–æ –æ–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–æ—á—Ç–∏ –¥–æ –ø–æ–ª–∞.\n"
            "3) –û—Ç—Ç–æ–ª–∫–Ω–∏—Å—å –ø–µ—Ä–µ–¥–Ω–µ–π –Ω–æ–≥–æ–π –∏ –≤–µ—Ä–Ω–∏—Å—å.\n"
            "4) –ì–∞–Ω—Ç–µ–ª–∏ –¥–µ—Ä–∂–∏ —Ä–æ–≤–Ω–æ, –Ω–µ –∫–∞—á–∞–π—Å—è –≤ —Å—Ç–æ—Ä–æ–Ω—ã.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –ö–æ—Ä–ø—É—Å —Ä–∞—Å–∫–∞—á–∏–≤–∞–µ—Ç—Å—è ‚Üí –Ω–∞–ø—Ä—è–≥–∏ –∫–æ—Ä–ø—É—Å.\n"
            "‚Ä¢ –®–∞–≥ —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π ‚Üí –∫–æ–ª–µ–Ω–Ω—ã–π —Å—É—Å—Ç–∞–≤ –ø–µ—Ä–µ–≥—Ä—É–∂–∞–µ—Ç—Å—è.\n\n"
            "üí° –£–¥–æ–±—Å—Ç–≤–æ –≥–∞–Ω—Ç–µ–ª–µ–π\n"
            "–ù–∞–≥—Ä—É–∑–∫–∞ —É–ø—Ä–∞–≤–ª—è–µ–º–µ–µ —á–µ–º —Å–æ —à—Ç–∞–Ω–≥–æ–π ‚Äî —Ö–æ—Ä–æ—à–æ –¥–ª—è –æ—Ç—Ä–∞–±–æ—Ç–∫–∏ —Ç–µ—Ö–Ω–∏–∫–∏."
        )
    },
    "lunge_walking": {
        "title": "–í—ã–ø–∞–¥—ã —Ö–æ–¥—å–±–æ–π",
        "img": "media/tech/lunge_walking.jpg",
        "text": (
            "üìö –í—ã–ø–∞–¥—ã —Ö–æ–¥—å–±–æ–π (–¥–∏–Ω–∞–º–∏–∫–∞ + –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è)\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –®–∏—Ä–æ–∫–∏–π —à–∞–≥ –≤–ø–µ—Ä—ë–¥ ‚Äî –æ–ø—É—Å—Ç–∏–ª—Å—è –≤ –≤—ã–ø–∞–¥.\n"
            "2) –û—Ç—Ç–æ–ª–∫–Ω—É–ª—Å—è –∏ —Å—Ä–∞–∑—É —à–∞–≥ –¥—Ä—É–≥–æ–π –Ω–æ–≥–æ–π –≤–ø–µ—Ä—ë–¥.\n"
            "3) –î–≤–∏–≥–∞–π—Å—è –≤–ø–µ—Ä—ë–¥ –ø–ª–∞–≤–Ω–æ, –±–µ–∑ —Ä–∞—Å–∫–∞—á–∫–∏ –∫–æ—Ä–ø—É—Å–∞.\n"
            "4) –ö–æ–ª–µ–Ω–æ –ø–µ—Ä–µ–¥–Ω–µ–π –Ω–æ–≥–∏ –Ω–µ –∑–∞—Ö–æ–¥–∏—Ç –∑–∞ –Ω–æ—Å–æ–∫.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –ö–æ—Ä–ø—É—Å –∫–∞—á–∞–µ—Ç—Å—è –∏–∑ —Å—Ç–æ—Ä–æ–Ω—ã –≤ —Å—Ç–æ—Ä–æ–Ω—É ‚Üí –º–µ–¥–ª–µ–Ω–Ω–µ–µ.\n"
            "‚Ä¢ –ú–∞–ª–µ–Ω—å–∫–∏–π —à–∞–≥ ‚Üí –∫–æ–ª–µ–Ω–Ω—ã–π —Å—É—Å—Ç–∞–≤ –ø–µ—Ä–µ–≥—Ä—É–∂–∞–µ—Ç—Å—è.\n\n"
            "üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞\n"
            "–•–æ—Ä–æ—à–æ —Ä–∞–∑–≤–∏–≤–∞–µ—Ç –±–∞–ª–∞–Ω—Å –∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—é. –ù–∞—á–∏–Ω–∞–π –±–µ–∑ –≤–µ—Å–∞."
        )
    },
    "pullup_chinup": {
        "title": "–ü–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è –æ–±—Ä–∞—Ç–Ω—ã–º —Ö–≤–∞—Ç–æ–º",
        "img": "media/tech/pullup_chinup.jpg",
        "text": (
            "üìö –ü–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è –æ–±—Ä–∞—Ç–Ω—ã–º —Ö–≤–∞—Ç–æ–º (–±–∏—Ü–µ–ø—Å + —Å–ø–∏–Ω–∞)\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –•–≤–∞—Ç —Å–Ω–∏–∑—É (–ª–∞–¥–æ–Ω–∏ –∫ —Å–µ–±–µ), —á—É—Ç—å —É–∂–µ –ø–ª–µ—á.\n"
            "2) –ü–ª–µ—á–∏ –≤–Ω–∏–∑, –ª–æ–ø–∞—Ç–∫–∏ –≤–∫–ª—é—á–∏–ª–∏—Å—å ‚Äî –Ω–∞—á–∞–ª–æ –¥–≤–∏–∂–µ–Ω–∏—è.\n"
            "3) –¢—è–Ω–∏ –≥—Ä—É–¥—å –∫ –ø–µ—Ä–µ–∫–ª–∞–¥–∏–Ω–µ, –ª–æ–∫—Ç–∏ –∏–¥—É—Ç –≤–¥–æ–ª—å —Ç–µ–ª–∞.\n"
            "4) –í–Ω–∏–∑ –º–µ–¥–ª–µ–Ω–Ω–æ ‚Äî 2‚Äì3 —Å–µ–∫, –ø–æ–ª–Ω–∞—è –∞–º–ø–ª–∏—Ç—É–¥–∞.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –†–∞—Å–∫–∞—á–∏–≤–∞–µ—à—å –∫–æ—Ä–ø—É—Å ‚Üí —Å–±–∞–≤—å —Ç–µ–º–ø.\n"
            "‚Ä¢ –ü–æ–¥–±–æ—Ä–æ–¥–æ–∫ –Ω–µ –¥–æ—Ö–æ–¥–∏—Ç –¥–æ –ø–µ—Ä–µ–∫–ª–∞–¥–∏–Ω—ã ‚Üí —Å–Ω–∏–∑—å –≤–µ—Å/–¥–æ–±–∞–≤—å —Ä–µ–∑–∏–Ω–∫—É.\n\n"
            "üí° Vs. –ø—Ä—è–º–æ–π —Ö–≤–∞—Ç\n"
            "–û–±—Ä–∞—Ç–Ω—ã–π —Ö–≤–∞—Ç –±–æ–ª—å—à–µ –Ω–∞–≥—Ä—É–∂–∞–µ—Ç –±–∏—Ü–µ–ø—Å, –ø—Ä—è–º–æ–π ‚Äî —à–∏—Ä–æ—á–∞–π—à–∏–µ. –ß–µ—Ä–µ–¥—É–π."
        )
    },
    "pullup_wide": {
        "title": "–ü–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è —à–∏—Ä–æ–∫–∏–º —Ö–≤–∞—Ç–æ–º",
        "img": "media/tech/pullup_wide.jpg",
        "text": (
            "üìö –ü–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è —à–∏—Ä–æ–∫–∏–º —Ö–≤–∞—Ç–æ–º (—à–∏—Ä–æ—á–∞–π—à–∏–µ –º—ã—à—Ü—ã)\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –•–≤–∞—Ç —Å–≤–µ—Ä—Ö—É, —à–∏—Ä–µ –ø–ª–µ—á ‚Äî –ø—Ä–∏–º–µ—Ä–Ω–æ –Ω–∞ —à–∏—Ä–∏–Ω—É –ª–æ–∫—Ç–µ–π.\n"
            "2) –ü–ª–µ—á–∏ –≤–Ω–∏–∑ –æ—Ç —É—à–µ–π, –ª–æ–ø–∞—Ç–∫–∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω—ã.\n"
            "3) –¢—è–Ω–∏ –≥—Ä—É–¥—å –∫ –ø–µ—Ä–µ–∫–ª–∞–¥–∏–Ω–µ, –ª–æ–∫—Ç–∏ –≤–Ω–∏–∑ –∏ –Ω–∞–∑–∞–¥.\n"
            "4) –í–Ω–∏–∑ –º–µ–¥–ª–µ–Ω–Ω–æ ‚Äî –¥–æ –ø–æ–ª–Ω–æ–≥–æ —Ä–∞—Å—Ç—è–∂–µ–Ω–∏—è —à–∏—Ä–æ—á–∞–π—à–∏—Ö.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –°–ª–∏—à–∫–æ–º —à–∏—Ä–æ–∫–æ ‚Üí —Ç—Ä–∞–≤–º–∞ –ø–ª–µ—á–∞, –Ω–∞–π–¥–∏ –∫–æ–º—Ñ–æ—Ä—Ç–Ω—É—é —à–∏—Ä–∏–Ω—É.\n"
            "‚Ä¢ –†—ã–≤–∫–∏ ‚Üí —Å–Ω–∏–∂–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ —Å–ø–∏–Ω—É.\n\n"
            "üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞\n"
            "–ê–∫—Ü–µ–Ω—Ç –Ω–∞ V-–æ–±—Ä–∞–∑–Ω—ã–π —Å–∏–ª—É—ç—Ç. –í–µ—Å —Ç–µ–ª–∞ —Å–Ω–∞—á–∞–ª–∞, –ø–æ—Ç–æ–º –æ—Ç—è–≥–æ—â–µ–Ω–∏–µ."
        )
    },
    "latpulldown_wide": {
        "title": "–¢—è–≥–∞ –≤–µ—Ä—Ö–Ω–µ–≥–æ –±–ª–æ–∫–∞ —à–∏—Ä–æ–∫–∏–º —Ö–≤–∞—Ç–æ–º",
        "img": "media/tech/latpulldown_wide.jpg",
        "text": (
            "üìö –¢—è–≥–∞ –≤–µ—Ä—Ö–Ω–µ–≥–æ –±–ª–æ–∫–∞ —à–∏—Ä–æ–∫–∏–º —Ö–≤–∞—Ç–æ–º\n\n"
            "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞\n"
            "‚Ä¢ –•–≤–∞—Ç —à–∏—Ä–µ –ø–ª–µ—á –ø—Ä—è–º–æ–π —Ö–≤–∞—Ç —Å–≤–µ—Ä—Ö—É.\n"
            "‚Ä¢ –ì—Ä—É–¥—å ¬´–≤–ø–µ—Ä—ë–¥¬ª, –ø–ª–µ—á–∏ –æ–ø—É—Å—Ç–∏–ª –≤–Ω–∏–∑.\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –ù–∞—á–Ω–∏ –¥–≤–∏–∂–µ–Ω–∏–µ –ª–æ–ø–∞—Ç–∫–∞–º–∏ –≤–Ω–∏–∑ –∫ –∫–∞—Ä–º–∞–Ω–∞–º.\n"
            "2) –¢—è–Ω–∏ –ª–æ–∫—Ç–∏ –≤–Ω–∏–∑ –∏ –Ω–∞–∑–∞–¥ –¥–æ –≤–µ—Ä—Ö–∞ –≥—Ä—É–¥–∏.\n"
            "3) –ú–µ–¥–ª–µ–Ω–Ω–æ –≤–≤–µ—Ä—Ö ‚Äî —Ä–∞—Å—Ç—è–Ω—å —à–∏—Ä–æ—á–∞–π—à–∏–µ.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –†–∞—Å–∫–∞—á–∫–∞ –∫–æ—Ä–ø—É—Å–æ–º ‚Üí —Å–Ω–∏–∑—å –≤–µ—Å.\n"
            "‚Ä¢ –•–≤–∞—Ç —Å–ª–∏—à–∫–æ–º —à–∏—Ä–æ–∫–∏–π ‚Üí –Ω–µ—É–¥–æ–±–Ω–æ –¥–ª—è –ø–ª–µ—á, —Å—É–∑—å –¥–æ –∫–æ–º—Ñ–æ—Ä—Ç–∞.\n\n"
            "üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞\n"
            "–ü–∞—É–∑–∞ 1 —Å–µ–∫ –≤–Ω–∏–∑—É ‚Äî –ª—É—á—à–µ —á—É–≤—Å—Ç–≤—É–µ—à—å —Å–ø–∏–Ω—É."
        )
    },
    "latpulldown_narrow": {
        "title": "–¢—è–≥–∞ –≤–µ—Ä—Ö–Ω–µ–≥–æ –±–ª–æ–∫–∞ —É–∑–∫–∏–º —Ö–≤–∞—Ç–æ–º",
        "img": "media/tech/latpulldown_narrow.jpg",
        "text": (
            "üìö –¢—è–≥–∞ –≤–µ—Ä—Ö–Ω–µ–≥–æ –±–ª–æ–∫–∞ —É–∑–∫–∏–º/–Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–º —Ö–≤–∞—Ç–æ–º\n\n"
            "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞\n"
            "‚Ä¢ –£–∑–∫–∞—è —Ä—É—á–∫–∞ (–Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π —Ö–≤–∞—Ç, –ª–∞–¥–æ–Ω–∏ –¥—Ä—É–≥ –∫ –¥—Ä—É–≥—É).\n"
            "‚Ä¢ –ì—Ä—É–¥—å ¬´–≤–ø–µ—Ä—ë–¥¬ª, —Å–ª–µ–≥–∫–∞ –æ—Ç–∫–ª–æ–Ω–∏—Å—å –Ω–∞–∑–∞–¥.\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –¢—è–Ω–∏ —Ä—É—á–∫—É –∫ –≥—Ä—É–¥–∏, –ª–æ–∫—Ç–∏ –≤–Ω–∏–∑ –≤–¥–æ–ª—å —Ç–µ–ª–∞.\n"
            "2) –í –Ω–∏–∂–Ω–µ–π —Ç–æ—á–∫–µ ‚Äî –≥—Ä—É–¥—å –≤—ã—à–µ, –ª–æ–ø–∞—Ç–∫–∏ —Å–≤–µ–¥–µ–Ω—ã.\n"
            "3) –ú–µ–¥–ª–µ–Ω–Ω–æ –≤–≤–µ—Ä—Ö —Å –ø–æ–ª–Ω—ã–º —Ä–∞—Å—Ç—è–∂–µ–Ω–∏–µ–º.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –¢—è–Ω–µ—à—å —Ä—É–∫–∞–º–∏ ‚Üí –¥—É–º–∞–π ¬´–ª–æ–∫—Ç–∏ –∫ —Ä—ë–±—Ä–∞–º¬ª.\n"
            "‚Ä¢ –ö–æ—Ä–ø—É—Å –∫–∞—á–∞–µ—Ç—Å—è ‚Üí —Å–Ω–∏–∑—å –≤–µ—Å.\n\n"
            "üí° –ü–ª—é—Å\n"
            "–ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π —Ö–≤–∞—Ç —Å–Ω–∏–∂–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ –ª–æ–∫—Ç–µ–≤—ã–µ —Å—É—Å—Ç–∞–≤—ã ‚Äî —É–¥–æ–±–Ω–µ–µ –¥–ª—è –º–Ω–æ–≥–∏—Ö."
        )
    },
    "incline_press_barbell": {
        "title": "–ñ–∏–º –ø–æ–¥ —É–≥–ª–æ–º (—à—Ç–∞–Ω–≥–∞)",
        "img": "media/tech/incline_press_barbell.jpg",
        "text": (
            "üìö –ñ–∏–º —à—Ç–∞–Ω–≥–∏ –ø–æ–¥ —É–≥–ª–æ–º (–≤–µ—Ä—Ö –≥—Ä—É–¥–∏)\n\n"
            "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞\n"
            "‚Ä¢ –°–∫–∞–º—å—è 30‚Äì45¬∞. –£–≥–æ–ª –±–æ–ª—å—à–µ 45¬∞ ‚Äî –Ω–∞–≥—Ä—É–∑–∫–∞ —É—Ö–æ–¥–∏—Ç –Ω–∞ –ø–ª–µ—á–∏.\n"
            "‚Ä¢ –õ–æ–ø–∞—Ç–∫–∏ —Å–≤–µ–¥–µ–Ω—ã –∏ –ø—Ä–∏–∂–∞—Ç—ã, —Ö–≤–∞—Ç —á—É—Ç—å —à–∏—Ä–µ –ø–ª–µ—á.\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –û–ø—É—Å–∫–∞–π —à—Ç–∞–Ω–≥—É –∫ –≤–µ—Ä—Ö—É –≥—Ä—É–¥–∏ (–∫–ª—é—á–∏—Ü—ã) –ø–æ–¥ –∫–æ–Ω—Ç—Ä–æ–ª–µ–º.\n"
            "2) –õ–æ–∫—Ç–∏ ~45¬∞ –∫ –∫–æ—Ä–ø—É—Å—É.\n"
            "3) –ñ–º–∏ –≤–≤–µ—Ä—Ö –∏ –Ω–∞–∑–∞–¥ –∫ —Å—Ç–æ–π–∫–∞–º.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –ü–ª–µ—á–∏ –≤–ø–µ—Ä—ë–¥ ‚Üí —Å–Ω–æ–≤–∞ —Å–≤–µ–¥–∏ –ª–æ–ø–∞—Ç–∫–∏.\n"
            "‚Ä¢ –°–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π —É–≥–æ–ª ‚Üí –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ –∂–∏–º –ø–ª–µ—á–∞–º–∏.\n\n"
            "üí° –ê–∫—Ü–µ–Ω—Ç\n"
            "–õ—É—á—à–µ –ø—Ä–æ—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤–µ—Ä—Ö–Ω–∏–π –ø—É—á–æ–∫ –≥—Ä—É–¥–∏, —á–µ–º –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π –∂–∏–º."
        )
    },
    "incline_press_dumbbell": {
        "title": "–ñ–∏–º –ø–æ–¥ —É–≥–ª–æ–º (–≥–∞–Ω—Ç–µ–ª–∏)",
        "img": "media/tech/incline_press_dumbbell.jpg",
        "text": (
            "üìö –ñ–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π –ø–æ–¥ —É–≥–ª–æ–º (–≤–µ—Ä—Ö –≥—Ä—É–¥–∏)\n\n"
            "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞\n"
            "‚Ä¢ –°–∫–∞–º—å—è 30‚Äì45¬∞. –ì–∞–Ω—Ç–µ–ª–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ –≥—Ä—É–¥–∏, –ª–æ–∫—Ç–∏ –ø–æ–¥ –∑–∞–ø—è—Å—Ç—å—è–º–∏.\n"
            "‚Ä¢ –õ–æ–ø–∞—Ç–∫–∏ —Å–≤–µ–¥–µ–Ω—ã –∏ –ø—Ä–∏–∂–∞—Ç—ã –∫ —Å–∫–∞–º—å–µ.\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –ñ–º–∏ –≥–∞–Ω—Ç–µ–ª–∏ –≤–≤–µ—Ä—Ö, —Å–ª–µ–≥–∫–∞ —Å–±–ª–∏–∂–∞—è –∏—Ö –Ω–∞–¥ –≥—Ä—É–¥—å—é.\n"
            "2) –ê–º–ø–ª–∏—Ç—É–¥–∞ —à–∏—Ä–µ, —á–µ–º —Å–æ —à—Ç–∞–Ω–≥–æ–π ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π –µ—ë.\n"
            "3) –ú–µ–¥–ª–µ–Ω–Ω–æ –æ–ø—É—Å–∫–∞–π —Å —Ä–∞—Å—Ç—è–∂–µ–Ω–∏–µ–º –≤–µ—Ä—Ö–∞ –≥—Ä—É–¥–∏.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –ì–∞–Ω—Ç–µ–ª–∏ ¬´—Ä–∞–∑–±–µ–≥–∞—é—Ç—Å—è¬ª ‚Üí –ø–æ—Ç–µ—Ä—è –∫–æ–Ω—Ç—Ä–æ–ª—è, —Å–Ω–∏–∑—å –≤–µ—Å.\n"
            "‚Ä¢ –õ–æ–∫—Ç–∏ 90¬∞ –≤ —Å—Ç–æ—Ä–æ–Ω—ã ‚Üí –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –ø–ª–µ—á–∏.\n\n"
            "üí° –ü–ª—é—Å\n"
            "–ë–æ–ª—å—à–∞—è –∞–º–ø–ª–∏—Ç—É–¥–∞ –∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å —Ä—É–∫ = –±–æ–ª–µ–µ –≥–ª—É–±–æ–∫–æ–µ —Ä–∞—Å—Ç—è–∂–µ–Ω–∏–µ –≥—Ä—É–¥–∏."
        )
    },
    "biceps_barbell": {
        "title": "–°–≥–∏–±–∞–Ω–∏—è —Å–æ —à—Ç–∞–Ω–≥–æ–π (–±–∏—Ü–µ–ø—Å)",
        "img": "media/tech/biceps_barbell.jpg",
        "text": (
            "üìö –°–≥–∏–±–∞–Ω–∏—è —Å–æ —à—Ç–∞–Ω–≥–æ–π ‚Äî –±–∏—Ü–µ–ø—Å\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –•–≤–∞—Ç —Å–Ω–∏–∑—É —á—É—Ç—å —à–∏—Ä–µ –ø–ª–µ—á, —à—Ç–∞–Ω–≥–∞ —É –±—ë–¥–µ—Ä.\n"
            "2) –õ–æ–∫—Ç–∏ –ø—Ä–∏–∂–∞—Ç—ã –∫ –∫–æ—Ä–ø—É—Å—É ‚Äî –Ω–µ –≥—É–ª—è—é—Ç –≤–ø–µ—Ä—ë–¥.\n"
            "3) –°–≥–∏–±–∞–π –¥–æ –ø–∏–∫–∞, –Ω–µ –ø–æ–º–æ–≥–∞–π –∫–æ—Ä–ø—É—Å–æ–º.\n"
            "4) –ú–µ–¥–ª–µ–Ω–Ω–æ –æ–ø—É—Å–∫–∞–π ‚Äî 2‚Äì3 —Å–µ–∫, –Ω–µ –±—Ä–æ—Å–∞–π —à—Ç–∞–Ω–≥—É.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –†–∞—Å–∫–∞—á–∫–∞ —Å–ø–∏–Ω–æ–π ‚Üí —Å–ª–∏—à–∫–æ–º —Ç—è–∂—ë–ª—ã–π –≤–µ—Å.\n"
            "‚Ä¢ –õ–æ–∫—Ç–∏ —É–µ–∑–∂–∞—é—Ç –≤–ø–µ—Ä—ë–¥ ‚Üí —Ç–µ—Ä—è–µ—à—å –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ –±–∏—Ü–µ–ø—Å.\n"
            "‚Ä¢ –ù–µ–ø–æ–ª–Ω–∞—è –∞–º–ø–ª–∏—Ç—É–¥–∞ ‚Üí –¥–æ –∫–æ–Ω—Ü–∞ –≤–Ω–∏–∑, –∏–Ω–∞—á–µ –±–∏—Ü–µ–ø—Å –Ω–µ —Ä–∞—Å—Ç—ë—Ç.\n\n"
            "üí° –í–∞—Ä–∏–∞–Ω—Ç—ã —Ö–≤–∞—Ç–∞\n"
            "–ü—Ä—è–º–æ–π –≥—Ä–∏—Ñ ‚Äî –∫–ª–∞—Å—Å–∏–∫–∞. EZ-–≥—Ä–∏—Ñ ‚Äî –º–µ–Ω—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ –∑–∞–ø—è—Å—Ç—å—è."
        )
    },
    "biceps_dumbbell": {
        "title": "–°–≥–∏–±–∞–Ω–∏—è —Å –≥–∞–Ω—Ç–µ–ª—è–º–∏ (–±–∏—Ü–µ–ø—Å)",
        "img": "media/tech/biceps_dumbbell.jpg",
        "text": (
            "üìö –°–≥–∏–±–∞–Ω–∏—è —Å –≥–∞–Ω—Ç–µ–ª—è–º–∏ ‚Äî –±–∏—Ü–µ–ø—Å\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π —Ö–≤–∞—Ç ‚Üí –ø–æ–≤–æ—Ä–∞—á–∏–≤–∞–π –ª–∞–¥–æ–Ω—å –≤–≤–µ—Ä—Ö –ø—Ä–∏ –ø–æ–¥—ä—ë–º–µ (—Å—É–ø–∏–Ω–∞—Ü–∏—è).\n"
            "2) –õ–æ–∫—Ç–∏ —É –∫–æ—Ä–ø—É—Å–∞, –Ω–µ –¥–≤–∏–≥–∞—é—Ç—Å—è.\n"
            "3) –ü–æ–¥–Ω–∏–º–∞–π –¥–æ –ø–∏–∫–∞, —Å–æ–∂–º–∏ –±–∏—Ü–µ–ø—Å.\n"
            "4) –ú–µ–¥–ª–µ–Ω–Ω–æ –≤–Ω–∏–∑ –¥–æ –ø–æ–ª–Ω–æ–≥–æ –≤—ã–ø—Ä—è–º–ª–µ–Ω–∏—è.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –ù–µ—Ç —Å—É–ø–∏–Ω–∞—Ü–∏–∏ ‚Üí –±–∏—Ü–µ–ø—Å –º–µ–Ω—å—à–µ —Å–æ–∫—Ä–∞—â–∞–µ—Ç—Å—è.\n"
            "‚Ä¢ –†–∞—Å–∫–∞—á–∫–∞ –∫–æ—Ä–ø—É—Å–∞ ‚Üí —Å–Ω–∏–∑—å –≤–µ—Å.\n\n"
            "üí° –í–∞—Ä–∏–∞–Ω—Ç—ã\n"
            "–ü–æ–ø–µ—Ä–µ–º–µ–Ω–Ω–æ (–æ–¥–Ω–∞ —Ä—É–∫–∞) ‚Äî –ª—É—á—à–µ –∫–æ–Ω—Ç—Ä–æ–ª—å. –û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ ‚Äî –±—ã—Å—Ç—Ä–µ–µ."
        )
    },
    "deadlift_sumo": {
        "title": "–°—Ç–∞–Ω–æ–≤–∞—è —Ç—è–≥–∞ —Å—É–º–æ",
        "img": "media/tech/deadlift_sumo.jpg",
        "text": (
            "üìö –°—Ç–∞–Ω–æ–≤–∞—è —Ç—è–≥–∞ —Å—É–º–æ\n\n"
            "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞\n"
            "‚Ä¢ –®–∏—Ä–æ–∫–∞—è —Å—Ç–æ–π–∫–∞ (–Ω–æ–≥–∏ –¥–∞–ª–µ–∫–æ –≤ —Å—Ç–æ—Ä–æ–Ω—ã), –Ω–æ—Å–∫–∏ –Ω–∞—Ä—É–∂—É.\n"
            "‚Ä¢ –•–≤–∞—Ç —É–∑–∫–∏–π ‚Äî –º–µ–∂–¥—É –∫–æ–ª–µ–Ω—è–º–∏.\n"
            "‚Ä¢ –ë—ë–¥—Ä–∞ –Ω–∏–∑–∫–æ, —Å–ø–∏–Ω–∞ –ø—Ä—è–º–∞—è, –≤–∑–≥–ª—è–¥ –≤–ø–µ—Ä—ë–¥.\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –í–¥–æ—Ö, –Ω–∞–ø—Ä—è–≥–∏ –∫–æ—Ä–ø—É—Å, –∫–æ–ª–µ–Ω–∏ —Ä–∞–∑–≤–æ–¥–∏ –ø–æ –Ω–æ—Å–∫–∞–º.\n"
            "2) –¢–æ–ª–∫–∞–π –ø–æ–ª –Ω–æ–≥–∞–º–∏, –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —Ä–∞–∑–≥–∏–±–∞–π —Å–ø–∏–Ω—É.\n"
            "3) –ì—Ä–∏—Ñ –≤–µ–¥—ë—Ç –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ –≤–≤–µ—Ä—Ö.\n"
            "4) –ù–∞–≤–µ—Ä—Ö—É ‚Äî –±—ë–¥—Ä–∞ –≤–ø–µ—Ä—ë–¥, –±–µ–∑ –ø–µ—Ä–µ—Ä–∞–∑–≥–∏–±–∞.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –ö–æ–ª–µ–Ω–∏ —Å—Ö–ª–æ–ø—ã–≤–∞—é—Ç—Å—è –≤–Ω—É—Ç—Ä—å ‚Üí —Ä–∞–∑–≤–æ–¥–∏ –∞–∫—Ç–∏–≤–Ω–æ –Ω–∞—Ä—É–∂—É.\n"
            "‚Ä¢ –°–ø–∏–Ω–∞ –æ–∫—Ä—É–≥–ª—è–µ—Ç—Å—è ‚Üí —Å–Ω–∏–∑—å –≤–µ—Å.\n\n"
            "üí° Vs. –∫–ª–∞—Å—Å–∏–∫–∞\n"
            "–°—É–º–æ ‚Äî –∫–æ—Ä–æ—á–µ –∞–º–ø–ª–∏—Ç—É–¥–∞, –±–æ–ª—å—à–µ –∫–≤–∞–¥—Ä–∏—Ü–µ–ø—Å–æ–≤ –∏ –ø—Ä–∏–≤–æ–¥—è—â–∏—Ö."
        )
    },
    "chest_fly": {
        "title": "–†–∞–∑–≤–µ–¥–µ–Ω–∏—è –Ω–∞ –≥—Ä—É–¥—å",
        "img": "media/tech/chest_fly.jpg",
        "text": (
            "üìö –†–∞–∑–≤–µ–¥–µ–Ω–∏—è –≥–∞–Ω—Ç–µ–ª–µ–π –ª—ë–∂–∞ (–≥—Ä—É–¥—å)\n\n"
            "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞\n"
            "‚Ä¢ –õ–µ–∂–∏ –Ω–∞ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–π —Å–∫–∞–º—å–µ, –≥–∞–Ω—Ç–µ–ª–∏ –Ω–∞–¥ –≥—Ä—É–¥—å—é.\n"
            "‚Ä¢ –õ—ë–≥–∫–∏–π —Å–≥–∏–± –≤ –ª–æ–∫—Ç—è—Ö ‚Äî –∑–∞—Ñ–∏–∫—Å–∏—Ä—É–π –∏ —Å–æ—Ö—Ä–∞–Ω–∏ –µ–≥–æ.\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –û–ø—É—Å–∫–∞–π –≥–∞–Ω—Ç–µ–ª–∏ –≤ —Å—Ç–æ—Ä–æ–Ω—ã ‚Äî –¥—É–≥–æ–π, –∫–∞–∫ –æ–±–Ω–∏–º–∞–µ—à—å –¥–µ—Ä–µ–≤–æ.\n"
            "2) –û–ø—É—Å–∫–∞–π –¥–æ –æ—â—É—â–µ–Ω–∏—è —Ä–∞—Å—Ç—è–∂–µ–Ω–∏—è –≤ –≥—Ä—É–¥–∏.\n"
            "3) –°–≤–æ–¥–∏ –≥–∞–Ω—Ç–µ–ª–∏ –æ–±—Ä–∞—Ç–Ω–æ –Ω–∞–¥ –≥—Ä—É–¥—å—é —Ç–æ–π –∂–µ –¥—É–≥–æ–π.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –õ–æ–∫—Ç–∏ —Å–≥–∏–±–∞—é—Ç—Å—è ‚Äî –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –∂–∏–º ‚Üí —Ñ–∏–∫—Å–∏—Ä—É–π —É–≥–æ–ª.\n"
            "‚Ä¢ –°–ª–∏—à–∫–æ–º —Ç—è–∂–µ–ª–æ ‚Üí —Ä–∏—Å–∫ –¥–ª—è –ø–ª–µ—á, –≤–æ–∑—å–º–∏ –ª—ë–≥—á–µ.\n\n"
            "üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞\n"
            "–ò–∑–æ–ª–∏—Ä—É–µ—Ç –≥—Ä—É–¥—å –ª—É—á—à–µ –∂–∏–º–∞. –ò–¥–µ–∞–ª—å–Ω–æ –ø–æ—Å–ª–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π."
        )
    },
    "crossover": {
        "title": "–ö—Ä–æ—Å—Å–æ–≤–µ—Ä",
        "img": "media/tech/crossover.jpg",
        "text": (
            "üìö –°–≤–µ–¥–µ–Ω–∏—è –≤ –∫—Ä–æ—Å—Å–æ–≤–µ—Ä–µ (–∏–∑–æ–ª—è—Ü–∏—è –≥—Ä—É–¥–∏)\n\n"
            "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞\n"
            "‚Ä¢ –ë–ª–æ–∫–∏ —Å–≤–µ—Ä—Ö—É, —Å–Ω–∏–∑—É –∏–ª–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ –≥—Ä—É–¥–∏ ‚Äî –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∞–∫—Ü–µ–Ω—Ç–∞.\n"
            "‚Ä¢ –í—Å—Ç–∞–Ω—å –ø–æ—Å–µ—Ä–µ–¥–∏–Ω–µ, —à–∞–≥ –≤–ø–µ—Ä—ë–¥ –¥–ª—è —Ä–∞–≤–Ω–æ–≤–µ—Å–∏—è.\n\n"
            "‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å\n"
            "1) –†—É–∫–∏ —Å–ª–µ–≥–∫–∞ —Å–æ–≥–Ω—É—Ç—ã –≤ –ª–æ–∫—Ç—è—Ö ‚Äî –∑–∞—Ñ–∏–∫—Å–∏—Ä—É–π.\n"
            "2) –°–≤–æ–¥–∏ —Ä—É–∫–∏ –≤–ø–µ—Ä—ë–¥ –¥—É–≥–æ–π, —Å–∂–∏–º–∞—è –≥—Ä—É–¥—å.\n"
            "3) –í —Ü–µ–Ω—Ç—Ä–µ ‚Äî –ø–∞—É–∑–∞, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ –≥—Ä—É–¥–∏.\n"
            "4) –ú–µ–¥–ª–µ–Ω–Ω–æ —Ä–∞–∑–≤–æ–¥–∏ –æ–±—Ä–∞—Ç–Ω–æ –¥–æ —Ä–∞—Å—Ç—è–∂–µ–Ω–∏—è.\n\n"
            "‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏\n"
            "‚Ä¢ –õ–æ–∫—Ç–∏ —Å–∏–ª—å–Ω–æ —Å–æ–≥–Ω—É—Ç—ã ‚Üí –Ω–∞–≥—Ä—É–∑–∫–∞ —É—Ö–æ–¥–∏—Ç.\n"
            "‚Ä¢ –†—ã–≤–∫–∏ ‚Üí —Å–Ω–∏–∑—å –≤–µ—Å, –∫–æ–Ω—Ç—Ä–æ–ª—å –≤–∞–∂–Ω–µ–µ.\n\n"
            "üí° –ü–æ–∑–∏—Ü–∏—è –±–ª–æ–∫–æ–≤\n"
            "–ë–ª–æ–∫–∏ —Å–≤–µ—Ä—Ö—É ‚Üí –Ω–∏–∂–Ω–∏–π –ø—É—á–æ–∫. –°–Ω–∏–∑—É ‚Üí –≤–µ—Ä—Ö–Ω–∏–π. –£—Ä–æ–≤–µ–Ω—å –≥—Ä—É–¥–∏ ‚Üí —Å—Ä–µ–¥–Ω–∏–π."
        )
    },
}

# =========================
# –í–ê–õ–ò–î–ê–¶–ò–Ø: TECH_GIFS ‚Üî TECH
# –ï—Å–ª–∏ –∫—Ç–æ-—Ç–æ –¥–æ–±–∞–≤–∏—Ç gif, –Ω–æ –∑–∞–±—É–¥–µ—Ç –Ω–∞–ø–∏—Å–∞—Ç—å —Ç–µ–∫—Å—Ç —Ç–µ—Ö–Ω–∏–∫–∏ ‚Äî
# –±–æ—Ç –Ω–µ —É–ø–∞–¥—ë—Ç, –Ω–æ –ø–æ–∫–∞–∂–µ—Ç warning –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ.
# =========================
_tech_missing = [k for k in TECH_GIFS if k not in TECH]
if _tech_missing:
    import logging as _log
    _log.getLogger("trainer_bot").warning(f"TECH missing keys: {_tech_missing}")


def tech_kb():
    rows = [
        [InlineKeyboardButton(text=TECH["squat"]["title"], callback_data="tech:squat"),
         InlineKeyboardButton(text=TECH["bench"]["title"], callback_data="tech:bench")],
        [InlineKeyboardButton(text=TECH["row"]["title"], callback_data="tech:row"),
         InlineKeyboardButton(text=TECH["latpulldown"]["title"], callback_data="tech:latpulldown")],
        [InlineKeyboardButton(text=TECH["pullup"]["title"], callback_data="tech:pullup"),
         InlineKeyboardButton(text=TECH["ohp"]["title"], callback_data="tech:ohp")],
        [InlineKeyboardButton(text=TECH["rdl"]["title"], callback_data="tech:rdl"),
         InlineKeyboardButton(text=TECH["lateralraise"]["title"], callback_data="tech:lateralraise")],
        [InlineKeyboardButton(text=TECH["biceps"]["title"], callback_data="tech:biceps"),
         InlineKeyboardButton(text=TECH["triceps"]["title"], callback_data="tech:triceps")],
        [InlineKeyboardButton(text=TECH["legpress"]["title"], callback_data="tech:legpress"),
         InlineKeyboardButton(text=TECH["hinge"]["title"], callback_data="tech:hinge")],
        [InlineKeyboardButton(text=TECH["core"]["title"], callback_data="tech:core"),
         InlineKeyboardButton(text=TECH["calves"]["title"], callback_data="tech:calves")],
        [InlineKeyboardButton(text=TECH["lunge"]["title"], callback_data="tech:lunge"),
         InlineKeyboardButton(text=TECH["hyperext"]["title"], callback_data="tech:hyperext")],
        [InlineKeyboardButton(text=TECH["face_pull"]["title"], callback_data="tech:face_pull"),
         InlineKeyboardButton(text=TECH["hammer"]["title"], callback_data="tech:hammer")],
        [InlineKeyboardButton(text="‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –∫ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞–º", callback_data="nav:workouts")],
    ]
    return InlineKeyboardMarkup(inline_keyboard=rows)


def tech_back_kb():
    return InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(text="‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É", callback_data="tech:list")],
    ])


# =========================
# ‚úÖ –ü–û–°–¢–û–Ø–ù–ù–ê–Ø –ö–õ–ê–í–ò–ê–¢–£–†–ê (2√ó2)
# =========================
def control_reply_kb():
    return ReplyKeyboardMarkup(
        keyboard=[
            [KeyboardButton(text="‚öôÔ∏è –ü—Ä–æ—Ñ–∏–ª—å"), KeyboardButton(text="üè† –ú–µ–Ω—é")],
            [KeyboardButton(text="üí≥ –û–ø–ª–∞—Ç–∞/–¥–æ—Å—Ç—É–ø"), KeyboardButton(text="üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞")],
        ],
        resize_keyboard=True,
        one_time_keyboard=False,
        input_field_placeholder="–ö–Ω–æ–ø–∫–∏ —Å–Ω–∏–∑—É üëá"
    )


# =========================
# ‚úÖ Inline –º–µ–Ω—é —Ä–∞–∑–¥–µ–ª–æ–≤
# =========================
def menu_main_inline_kb():
    return InlineKeyboardMarkup(inline_keyboard=[
        [
            InlineKeyboardButton(text="üèãÔ∏è –ú–æ–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏", callback_data="nav:workouts"),
            InlineKeyboardButton(text="üçΩ –ú–æ—ë –ø–∏—Ç–∞–Ω–∏–µ", callback_data="nav:nutrition"),
        ],
        [
            InlineKeyboardButton(text="üìì –î–Ω–µ–≤–Ω–∏–∫", callback_data="nav:diary"),
            InlineKeyboardButton(text="üìè –ó–∞–º–µ—Ä—ã", callback_data="nav:measures"),
        ],
        [InlineKeyboardButton(text="üî• –£–ª—É—á—à–∏—Ç—å –¥–æ—Å—Ç—É–ø", callback_data="nav:upgrade")],
        [InlineKeyboardButton(text="‚ùì –û—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã", callback_data="nav:faq")],
    ])


def simple_back_to_menu_inline_kb():
    return InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(text="üè† –ú–µ–Ω—é", callback_data="nav:menu")],
    ])


# =========================
# ‚úÖ –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏: –∫–Ω–æ–ø–∫–∏ –¥–Ω–µ–π
# =========================
def workout_days_kb(freq: int, has_full_access: bool = False, plan_struct: dict = None):
    freq = max(MIN_DAYS, min(int(freq or 3), MAX_DAYS))
    rows = []
    btns = []
    for i in range(1, freq + 1):
        btn_text = f"üìÖ –î–µ–Ω—å {i}"
        btns.append(InlineKeyboardButton(text=btn_text, callback_data=f"wday:{i}"))
    for i in range(0, len(btns), 2):
        rows.append(btns[i:i+2])

    rows.append([InlineKeyboardButton(text="üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞", callback_data="wday:stats:0")])
    rows.append([InlineKeyboardButton(text="üîÑ –°–º–µ–Ω–∏—Ç—å –ø–ª–∞–Ω —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫", callback_data="p:edit")])
    rows.append([InlineKeyboardButton(text="üè† –ú–µ–Ω—é", callback_data="nav:menu")])
    return InlineKeyboardMarkup(inline_keyboard=rows)


# =========================
# –Æ–ö–∞—Å—Å–∞: –∫–Ω–æ–ø–∫–∏
# =========================
def pay_tariff_kb():
    return InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(text=f"üèÜ –ù–∞–≤—Å–µ–≥–¥–∞ ‚Äî {TARIFFS['life']['price']}‚ÇΩ", callback_data="tariff:life")],
        [InlineKeyboardButton(text=f"üî• 3 –º–µ—Å—è—Ü–∞ ‚Äî {TARIFFS['t3']['price']}‚ÇΩ", callback_data="tariff:t3")],
        [InlineKeyboardButton(text=f"üü¢ –ü—Ä–æ–±–Ω—ã–π –¥–æ—Å—Ç—É–ø ‚Äî {TARIFFS['trial']['price']}‚ÇΩ (3 –¥–Ω—è)", callback_data="tariff:trial")],
        [InlineKeyboardButton(text="üìã –û–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –¥—Ä—É–≥–∏–º–∏ —Ç–∞—Ä–∏—Ñ–∞–º–∏", callback_data="nav:upgrade")],
        [InlineKeyboardButton(text="üè† –ú–µ–Ω—é", callback_data="nav:menu")],
    ])


def admin_review_kb(payment_id: int):
    return InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(text="‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å", callback_data=f"admin_approve:{payment_id}")],
        [InlineKeyboardButton(text="‚ùå –û—Ç–∫–ª–æ–Ω–∏—Ç—å", callback_data=f"admin_reject:{payment_id}")],
    ])


# =========================
# –ü—Ä–æ—Ñ–∏–ª—å
# =========================
TOTAL_PROFILE_STEPS = 10


def _bar(step: int, total: int = TOTAL_PROFILE_STEPS, width: int = 10) -> str:
    step = max(0, min(step, total))
    pct = int(round(step / total * 100)) if total else 0
    filled = int(round(pct / 100 * width))
    filled = max(0, min(filled, width))
    return f"{'‚ñ†'*filled}{'‚ñ°'*(width-filled)} {pct}%"


def _profile_header(step: int) -> str:
    return f"üß© –ü—Ä–æ—Ñ–∏–ª—å {step}/{TOTAL_PROFILE_STEPS}\n{_bar(step)}\n\n"


def profile_done_kb():
    return InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(text="üöÄ –°–æ–±—Ä–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É", callback_data="p:build_program")]
    ])


def profile_ready_kb():
    """–ü–æ—Å–ª–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è/–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≥–æ—Ç–æ–≤–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è."""
    return InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(text="‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å", callback_data="p:edit")],
        [InlineKeyboardButton(text="üè† –ú–µ–Ω—é", callback_data="nav:menu")],
    ])


def profile_edit_field_kb(u: dict, regens_str: str = "") -> InlineKeyboardMarkup:
    """–ú–µ–Ω—é –≤—ã–±–æ—Ä–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—è –ø—Ä–æ—Ñ–∏–ª—è –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è ‚Äî 2 —Å—Ç–æ–ª–±—Ü–∞."""
    def val(k, fallback="‚Äî"):
        v = u.get(k)
        return str(v) if v else fallback

    plan_btn_text = f"üöÄ –°–æ—Å—Ç–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –ø–ª–∞–Ω"
    if regens_str:
        plan_btn_text += f"  ({regens_str})"

    rows = [
        [
            InlineKeyboardButton(text=f"üéØ –¶–µ–ª—å: {val('goal')}", callback_data="pf:goal"),
            InlineKeyboardButton(text=f"üë§ –ü–æ–ª: {val('sex')}", callback_data="pf:sex"),
        ],
        [
            InlineKeyboardButton(text=f"üéÇ –í–æ–∑—Ä–∞—Å—Ç: {val('age')}", callback_data="pf:age"),
            InlineKeyboardButton(text=f"üìè –†–æ—Å—Ç: {val('height')} —Å–º", callback_data="pf:height"),
        ],
        [
            InlineKeyboardButton(text=f"‚öñÔ∏è –í–µ—Å: {val('weight')} –∫–≥", callback_data="pf:weight"),
            InlineKeyboardButton(text=f"üè† –ú–µ—Å—Ç–æ: {val('place')}", callback_data="pf:place"),
        ],
        [
            InlineKeyboardButton(text=f"üìà –û–ø—ã—Ç: {val('exp')}", callback_data="pf:exp"),
            InlineKeyboardButton(text=f"üìÖ –¢—Ä–µ–Ω/–Ω–µ–¥: {val('freq')}", callback_data="pf:freq"),
        ],
        [
            InlineKeyboardButton(text=f"üçΩ –ü—Ä–∏—ë–º–æ–≤ –µ–¥—ã: {val('meals')}", callback_data="pf:meals"),
            InlineKeyboardButton(text=f"‚õîÔ∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è", callback_data="pf:limits"),
        ],
        [InlineKeyboardButton(text=plan_btn_text, callback_data="p:rebuild_plan")],
        [InlineKeyboardButton(text="üè† –ù–∞–∑–∞–¥", callback_data="nav:menu")],
    ]
    return InlineKeyboardMarkup(inline_keyboard=rows)


def build_program_tariff_kb():
    """–¢–∞—Ä–∏—Ñ–Ω–∞—è –∫–Ω–æ–ø–∫–∞ –ø–æ—Å–ª–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è ‚Äî —Ç–æ–ª—å–∫–æ –ø—Ä–æ–±–Ω—ã–π + –¥—Ä—É–≥–∏–µ —Ç–∞—Ä–∏—Ñ—ã."""
    return InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(
            text=f"üü¢ –ü—Ä–æ–±–Ω—ã–π –¥–æ—Å—Ç—É–ø ‚Äî {TARIFFS['trial']['price']}‚ÇΩ (3 –¥–Ω—è)",
            callback_data="tariff:trial:from_profile"
        )],
        [InlineKeyboardButton(text="üìã –û–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –¥—Ä—É–≥–∏–º–∏ —Ç–∞—Ä–∏—Ñ–∞–º–∏", callback_data="nav:upgrade_after_profile")],
    ])


def profile_view_kb():
    return InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(text="‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å", callback_data="p:edit")],
        [InlineKeyboardButton(text="üè† –ú–µ–Ω—é", callback_data="nav:menu")],
    ])


def kb_goal():
    return InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(text="üí™ –ú–∞—Å—Å–∞", callback_data="p:goal:mass"),
         InlineKeyboardButton(text="üî• –°—É—à–∫–∞", callback_data="p:goal:cut")],
        [InlineKeyboardButton(text="üèãÔ∏è –°–∏–ª–∞", callback_data="p:goal:strength"),
         InlineKeyboardButton(text="üèÉ –í—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å", callback_data="p:goal:endurance")],
    ])


def kb_sex():
    return InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(text="üë® –ú—É–∂—á–∏–Ω–∞", callback_data="p:sex:m"),
         InlineKeyboardButton(text="üë© –ñ–µ–Ω—â–∏–Ω–∞", callback_data="p:sex:f")],
        [InlineKeyboardButton(text="‚¨ÖÔ∏è –ù–∞–∑–∞–¥", callback_data="p:back:goal")],
    ])


def kb_place():
    return InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(text="üè† –î–æ–º–∞", callback_data="p:place:bodyweight"),
         InlineKeyboardButton(text="üèãÔ∏è –í –∑–∞–ª–µ", callback_data="p:place:gym")],
        [InlineKeyboardButton(text="‚¨ÖÔ∏è –ù–∞–∑–∞–¥", callback_data="p:back:weight")],
    ])


def kb_exp():
    return InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(text="0 (–Ω–æ–≤–∏—á–æ–∫)", callback_data="p:exp:0")],
        [InlineKeyboardButton(text="1‚Äì2 –≥–æ–¥–∞", callback_data="p:exp:mid"),
         InlineKeyboardButton(text="2+ –≥–æ–¥–∞", callback_data="p:exp:adv")],
        [InlineKeyboardButton(text="‚¨ÖÔ∏è –ù–∞–∑–∞–¥", callback_data="p:back:place")],
    ])


def kb_freq():
    return InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(text="3√ó/–Ω–µ–¥", callback_data="p:freq:3"),
         InlineKeyboardButton(text="4√ó/–Ω–µ–¥", callback_data="p:freq:4")],
        [InlineKeyboardButton(text="5√ó/–Ω–µ–¥", callback_data="p:freq:5")],
        [InlineKeyboardButton(text="‚¨ÖÔ∏è –ù–∞–∑–∞–¥", callback_data="p:back:exp")],
    ])


def kb_meals():
    return InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(text="3 —Ä–∞–∑–∞", callback_data="p:meals:3"),
         InlineKeyboardButton(text="4 —Ä–∞–∑–∞", callback_data="p:meals:4")],
        [InlineKeyboardButton(text="5 —Ä–∞–∑", callback_data="p:meals:5")],
        [InlineKeyboardButton(text="‚¨ÖÔ∏è –ù–∞–∑–∞–¥", callback_data="p:back:freq")],
    ])


def kb_text_step(back_to: str):
    return InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(text="‚¨ÖÔ∏è –ù–∞–∑–∞–¥", callback_data=f"p:back:{back_to}")],
    ])


# =========================
# –£–¢–ò–õ–ò–¢–´
# =========================
def dumps_plan(plan: dict) -> str:
    return json.dumps(plan, ensure_ascii=False)


def loads_plan(text: str) -> dict:
    try:
        return json.loads(text or "")
    except Exception:
        return {}


def weekday_schedule(freq: int) -> str:
    if freq <= 3:
        return "–ü–Ω/–°—Ä/–ü—Ç (–∏–ª–∏ –í—Ç/–ß—Ç/–°–±)"
    if freq == 4:
        return "–í–µ—Ä—Ö/–ù–∏–∑ √ó2 (–Ω–∞–ø—Ä–∏–º–µ—Ä –ü–Ω/–í—Ç/–ß—Ç/–°–±)"
    return "PPL + –í–µ—Ä—Ö/–ù–∏–∑ (–Ω–∞–ø—Ä–∏–º–µ—Ä –ü–Ω‚Äì–ü—Ç)"


def gen_order_code(user_id: int) -> str:
    rnd = random.randint(100, 999)
    return f"TG{str(user_id)[-3:]}{rnd}"


def locked_text() -> str:
    return "–î–æ—Å—Ç—É–ø –∑–∞–∫—Ä—ã—Ç.\n–û–ø–ª–∞—Ç–∏ —Ç–∞—Ä–∏—Ñ ‚Äî –∫–Ω–æ–ø–∫–∞ üí≥ –û–ø–ª–∞—Ç–∞/–¥–æ—Å—Ç—É–ø –≤–Ω–∏–∑—É —ç–∫—Ä–∞–Ω–∞."


def exp_level(exp: str) -> str:
    t = (exp or "").strip().lower()
    if t in ("0", "–Ω–æ–≤–∏—á–æ–∫", "–Ω–æ–≤", "beginner"):
        return "novice"
    if "2+" in t or "2 +" in t or "2 –≥–æ–¥–∞" in t or "3" in t or "4" in t or "5" in t:
        return "adv"
    return "mid"


def _activity_factor(freq: int, place: str) -> float:
    pl = (place or "").lower()
    is_gym = ("–∑–∞–ª" in pl) or (pl == "gym") or ("gym" in pl)
    f = int(freq or 3)

    if f <= 2:
        return 1.35
    if f == 3:
        return 1.45 if is_gym else 1.40
    if f == 4:
        return 1.55 if is_gym else 1.50
    return 1.65 if is_gym else 1.55


def calc_calories(height_cm: int, weight_kg: float, age: int, sex: str, goal: str, freq: int = 3, place: str = "—Å–≤–æ–π –≤–µ—Å") -> int:
    sx = (sex or "–º").lower()
    if sx == "–º":
        bmr = 10 * weight_kg + 6.25 * height_cm - 5 * age + 5
    else:
        bmr = 10 * weight_kg + 6.25 * height_cm - 5 * age - 161

    af = _activity_factor(int(freq or 3), place)
    tdee = bmr * af

    g = (goal or "").lower()
    if "–º–∞—Å" in g:
        target = tdee * 1.10
    elif "—Å—É—à" in g:
        target = tdee * 0.82
    elif "—Å–∏–ª" in g:
        target = tdee * 1.05
    elif "–≤—ã–Ω–æ—Å" in g:
        target = tdee * 0.98
    else:
        target = tdee * 1.00

    return int(round(target))


def calc_macros(calories: int, weight_kg: float, goal: str):
    g = (goal or "").lower()

    if "—Å—É—à" in g:
        protein = int(round(weight_kg * 2.2))
    elif "–≤—ã–Ω–æ—Å" in g:
        protein = int(round(weight_kg * 1.7))
    elif "—Å–∏–ª" in g:
        protein = int(round(weight_kg * 1.9))
    else:
        protein = int(round(weight_kg * 1.8))

    if "–≤—ã–Ω–æ—Å" in g:
        fat = int(round(weight_kg * 0.7))
    else:
        fat = int(round(weight_kg * 0.8))

    carbs_kcal = max(calories - (protein * 4 + fat * 9), 0)
    carbs = int(round(carbs_kcal / 4))
    return protein, fat, carbs


def suggest_meals_count(calories: int) -> int:
    if calories >= 3200:
        return 5
    if calories >= 2600:
        return 4
    return 3


async def safe_send(message: Message, text: str, reply_markup=None):
    if not text:
        return
    t = text.strip()
    chunks = []
    while len(t) > TG_SAFE_MSG_LEN:
        cut = t.rfind("\n", 0, TG_SAFE_MSG_LEN)
        if cut == -1:
            cut = TG_SAFE_MSG_LEN
        chunks.append(t[:cut].strip())
        t = t[cut:].strip()
    if t:
        chunks.append(t)

    for i, ch in enumerate(chunks):
        await message.answer(ch, reply_markup=reply_markup if i == len(chunks) - 1 else None)


async def try_delete_user_message(bot: Bot, message: Message):
    try:
        await bot.delete_message(chat_id=message.chat.id, message_id=message.message_id)
    except Exception:
        pass


# =========================
# –ê–ù–¢–ò-–ó–ê–°–û–†–ï–ù–ò–ï –ß–ê–¢–ê
# =========================
async def get_last_bot_msg_id(user_id: int) -> Optional[int]:
    async with db() as conn:
        async with conn.execute("SELECT last_bot_msg_id FROM bot_state WHERE user_id=?", (user_id,)) as cur:
            row = await cur.fetchone()
    if not row:
        return None
    try:
        return int(row[0]) if row[0] is not None else None
    except Exception:
        return None


async def set_last_bot_msg_id(user_id: int, msg_id: int):
    async with db() as conn:
        await conn.execute("""
            INSERT INTO bot_state (user_id, last_bot_msg_id)
            VALUES (?, ?)
            ON CONFLICT(user_id) DO UPDATE SET last_bot_msg_id=excluded.last_bot_msg_id
        """, (user_id, int(msg_id)))
        await conn.commit()


async def get_diary_prompt_msg_id(user_id: int) -> Optional[int]:
    async with db() as conn:
        async with conn.execute("SELECT diary_prompt_msg_id FROM bot_state WHERE user_id=?", (user_id,)) as cur:
            row = await cur.fetchone()
    if not row:
        return None
    try:
        return int(row[0]) if row[0] is not None else None
    except Exception:
        return None


async def set_diary_prompt_msg_id(user_id: int, msg_id: Optional[int]):
    async with db() as conn:
        await conn.execute("""
            INSERT INTO bot_state (user_id, diary_prompt_msg_id)
            VALUES (?, ?)
            ON CONFLICT(user_id) DO UPDATE SET diary_prompt_msg_id=excluded.diary_prompt_msg_id
        """, (user_id, int(msg_id) if msg_id else None))
        await conn.commit()


async def clean_send(bot: Bot, chat_id: int, user_id: int, text: str, reply_markup=None):
    """–£–¥–∞–ª—è–µ—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç–∞ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–æ–≤–æ–µ ‚Äî —á–∞—Ç –Ω–µ –∑–∞—Å–æ—Ä—è–µ—Ç—Å—è."""
    last_id = await get_last_bot_msg_id(user_id)
    if last_id:
        try:
            await bot.delete_message(chat_id=chat_id, message_id=last_id)
        except Exception:
            pass
    m = await bot.send_message(chat_id=chat_id, text=text, reply_markup=reply_markup)
    await set_last_bot_msg_id(user_id, m.message_id)
    return m.message_id


async def clean_edit(callback: CallbackQuery, user_id: int, text: str, reply_markup=None):
    """–†–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç —Ç–µ–∫—É—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (–µ—Å–ª–∏ –Ω–µ —É–¥–∞—ë—Ç—Å—è ‚Äî –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–æ–≤–æ–µ)."""
    try:
        await callback.message.edit_text(text, reply_markup=reply_markup)
        await set_last_bot_msg_id(user_id, callback.message.message_id)
    except Exception:
        await clean_send(callback.bot, callback.message.chat.id, user_id, text, reply_markup=reply_markup)


async def _send_with_image(
    bot: Bot, chat_id: int, user_id: int,
    text: str, image_key: str, reply_markup=None
):
    """–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ —Å —Ñ–æ—Ç–æ –∏–∑ IMAGE_PATHS[image_key].
    –ï—Å–ª–∏ —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Äî –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ–±—ã—á–Ω—ã–π —Ç–µ–∫—Å—Ç.
    –í—Å–µ–≥–¥–∞ —É–¥–∞–ª—è–µ—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–µ –≥–ª–∞–≤–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç–∞ (—á–∏—Å—Ç—ã–π —á–∞—Ç)."""
    path = IMAGE_PATHS.get(image_key, "")
    last_id = await get_last_bot_msg_id(user_id)
    if last_id:
        try:
            await bot.delete_message(chat_id=chat_id, message_id=last_id)
        except Exception:
            pass
    if path and os.path.exists(path):
        try:
            photo = FSInputFile(path)
            caption = text[:1020] + ("‚Ä¶" if len(text) > 1020 else "")
            m = await bot.send_photo(
                chat_id=chat_id, photo=photo,
                caption=caption, reply_markup=reply_markup
            )
            await set_last_bot_msg_id(user_id, m.message_id)
            return m.message_id
        except Exception:
            pass  # fallback to text
    m = await bot.send_message(chat_id=chat_id, text=text, reply_markup=reply_markup)
    await set_last_bot_msg_id(user_id, m.message_id)
    return m.message_id


async def send_section(
    bot: Bot,
    chat_id: int,
    user_id: int,
    image_path: str,
    text: str,
    reply_markup=None,
    callback: Optional[CallbackQuery] = None,
):
    """–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ä–∞–∑–¥–µ–ª–∞ —Å –∫–∞—Ä—Ç–∏–Ω–∫–æ–π –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞.

    –õ–æ–≥–∏–∫–∞:
    - –ï—Å–ª–∏ callback –ø–µ—Ä–µ–¥–∞–Ω ‚Äî —Å–Ω–∞—á–∞–ª–∞ –ø—ã—Ç–∞–µ—Ç—Å—è edit_text (–±–µ–∑ —Ñ–æ—Ç–æ, –±—ã—Å—Ç—Ä–æ).
      –ü—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ —Ñ–∞–π–ª–∞: —É–¥–∞–ª—è–µ—Ç —Å—Ç–∞—Ä–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç send_photo.
    - –ï—Å–ª–∏ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç ‚Üí send_photo(caption=text).
      –ï—Å–ª–∏ —Ç–µ–∫—Å—Ç > 1020 —Å–∏–º–≤–æ–ª–æ–≤ ‚Üí —Ñ–æ—Ç–æ –±–µ–∑ caption + –æ—Ç–¥–µ–ª—å–Ω–æ–µ send_message.
    - –ï—Å–ª–∏ —Ñ–∞–π–ª–∞ –Ω–µ—Ç (–∏–ª–∏ –æ—à–∏–±–∫–∞) ‚Üí –æ–±—ã—á–Ω—ã–π send_message / edit_text.
    - –ë–æ—Ç –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–∞–¥–∞–µ—Ç: –≤—Å–µ –æ—à–∏–±–∫–∏ –æ–±—ë—Ä–Ω—É—Ç—ã –≤ try/except + warning-–ª–æ–≥.
    """
    TG_CAPTION_LIMIT = 1020

    # ‚îÄ‚îÄ –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –Ω–∞–ª–∏—á–∏–µ —Ñ–∞–π–ª–∞ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    has_image = bool(image_path and os.path.exists(image_path))

    # ‚îÄ‚îÄ –≤–µ—Ç–∫–∞ callback: —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    if callback:
        if has_image:
            # –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ñ–æ—Ç–æ
            last_id = await get_last_bot_msg_id(user_id)
            if last_id:
                try:
                    await bot.delete_message(chat_id=chat_id, message_id=last_id)
                except Exception:
                    pass
            try:
                photo = FSInputFile(image_path)
                if len(text) <= TG_CAPTION_LIMIT:
                    m = await bot.send_photo(
                        chat_id=chat_id, photo=photo,
                        caption=text, reply_markup=reply_markup
                    )
                    await set_last_bot_msg_id(user_id, m.message_id)
                else:
                    m = await bot.send_photo(chat_id=chat_id, photo=photo)
                    m2 = await bot.send_message(
                        chat_id=chat_id, text=text, reply_markup=reply_markup
                    )
                    await set_last_bot_msg_id(user_id, m2.message_id)
                return
            except Exception as e:
                logger.warning(f"send_section: –Ω–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ {image_path}: {e}")
        # fallback ‚Äî –ø—Ä–æ—Å—Ç–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç
        await clean_edit(callback, user_id, text, reply_markup=reply_markup)
        return

    # ‚îÄ‚îÄ –≤–µ—Ç–∫–∞ –±–µ–∑ callback: –æ—Ç–ø—Ä–∞–≤–∫–∞ –Ω–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    last_id = await get_last_bot_msg_id(user_id)
    if last_id:
        try:
            await bot.delete_message(chat_id=chat_id, message_id=last_id)
        except Exception:
            pass

    if has_image:
        try:
            photo = FSInputFile(image_path)
            if len(text) <= TG_CAPTION_LIMIT:
                m = await bot.send_photo(
                    chat_id=chat_id, photo=photo,
                    caption=text, reply_markup=reply_markup
                )
                await set_last_bot_msg_id(user_id, m.message_id)
            else:
                m = await bot.send_photo(chat_id=chat_id, photo=photo)
                m2 = await bot.send_message(
                    chat_id=chat_id, text=text, reply_markup=reply_markup
                )
                await set_last_bot_msg_id(user_id, m2.message_id)
            return
        except Exception as e:
            logger.warning(f"send_section: –Ω–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ {image_path}: {e}")

    # —Ñ–∏–Ω–∞–ª—å–Ω—ã–π fallback ‚Äî —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç
    m = await bot.send_message(chat_id=chat_id, text=text, reply_markup=reply_markup)
    await set_last_bot_msg_id(user_id, m.message_id)


async def send_screen(
    message: Message,
    text: str,
    image_key: Optional[str] = None,
    reply_markup=None,
    edit: bool = False,
):
    """–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —ç–∫—Ä–∞–Ω–∞ —Å –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º.
    –ï—Å–ª–∏ edit=True ‚Äî –ø—ã—Ç–∞–µ–º—Å—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç, –∏–Ω–∞—á–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–æ–≤–æ–µ.
    –ï—Å–ª–∏ image_key —É–∫–∞–∑–∞–Ω –∏ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ–º send_photo."""
    bot: Bot = message.bot
    chat_id = message.chat.id
    user_id = message.from_user.id if message.from_user else 0

    path = IMAGE_PATHS.get(image_key or "", "") if image_key else ""
    has_image = bool(path and os.path.exists(path))

    if edit and not has_image:
        try:
            await message.edit_text(text, reply_markup=reply_markup)
            await set_last_bot_msg_id(user_id, message.message_id)
            return
        except Exception:
            pass

    # –£–¥–∞–ª—è–µ–º –ø—Ä–µ–¥—ã–¥—É—â–µ–µ –≥–ª–∞–≤–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    last_id = await get_last_bot_msg_id(user_id)
    if last_id:
        try:
            await bot.delete_message(chat_id=chat_id, message_id=last_id)
        except Exception:
            pass

    if has_image:
        try:
            photo = FSInputFile(path)
            caption = text[:1020] + ("‚Ä¶" if len(text) > 1020 else "")
            m = await bot.send_photo(
                chat_id=chat_id, photo=photo,
                caption=caption, reply_markup=reply_markup
            )
            await set_last_bot_msg_id(user_id, m.message_id)
            return
        except Exception:
            pass

    m = await bot.send_message(chat_id=chat_id, text=text, reply_markup=reply_markup)
    await set_last_bot_msg_id(user_id, m.message_id)


async def _send_tech_with_gif(
    bot: Bot, chat_id: int, user_id: int,
    tech_key: str, text: str, reply_markup=None
):
    """–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–µ—Ö–Ω–∏–∫—É —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è —Å GIF –µ—Å–ª–∏ –µ—Å—Ç—å, –∏–Ω–∞—á–µ ‚Äî —Ç–µ–∫—Å—Ç.
    –£–¥–∞–ª—è–µ—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–µ –≥–ª–∞–≤–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (—á–∏—Å—Ç—ã–π —á–∞—Ç)."""
    gif_path = TECH_GIFS.get(tech_key, "")

    last_id = await get_last_bot_msg_id(user_id)
    if last_id:
        try:
            await bot.delete_message(chat_id=chat_id, message_id=last_id)
        except Exception:
            pass

    if gif_path and os.path.exists(gif_path):
        try:
            animation = FSInputFile(gif_path)
            caption = text[:1020] + ("‚Ä¶" if len(text) > 1020 else "")
            m = await bot.send_animation(
                chat_id=chat_id, animation=animation,
                caption=caption, reply_markup=reply_markup
            )
            rest = text[1020:].strip()
            if rest:
                m2 = await bot.send_message(chat_id=chat_id, text=rest, reply_markup=reply_markup)
                await set_last_bot_msg_id(user_id, m2.message_id)
            else:
                await set_last_bot_msg_id(user_id, m.message_id)
            return
        except Exception:
            pass  # fallback to text

    # –ù–µ—Ç GIF –∏–ª–∏ –æ—à–∏–±–∫–∞ ‚Äî –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç
    m = await bot.send_message(chat_id=chat_id, text=text, reply_markup=reply_markup)
    await set_last_bot_msg_id(user_id, m.message_id)


# =========================
# DB
# =========================
@asynccontextmanager
async def db():
    conn = await aiosqlite.connect(DB_PATH)
    try:
        await conn.execute("PRAGMA journal_mode=WAL;")
        await conn.execute("PRAGMA synchronous=NORMAL;")
        await conn.execute("PRAGMA foreign_keys=ON;")
        await conn.execute("PRAGMA busy_timeout=5000;")
        yield conn
    finally:
        await conn.close()


async def init_db():
    async with db() as conn:
        await conn.execute("""
        CREATE TABLE IF NOT EXISTS users (
            user_id INTEGER PRIMARY KEY,
            username TEXT,
            goal TEXT,
            sex TEXT,
            age INTEGER,
            height INTEGER,
            weight REAL,
            place TEXT,
            exp TEXT,
            freq INTEGER,
            meals INTEGER,
            limits TEXT,
            state TEXT,
            created_at TEXT
        )
        """)

        for col, typ in [
            ("limits", "TEXT"),
            ("state", "TEXT"),
            ("meals", "INTEGER"),
        ]:
            try:
                await conn.execute(f"ALTER TABLE users ADD COLUMN {col} {typ}")
            except Exception:
                pass

        await conn.execute("""
        CREATE TABLE IF NOT EXISTS access (
            user_id INTEGER PRIMARY KEY,
            paid INTEGER DEFAULT 0,
            tariff TEXT,
            tariff_name TEXT NOT NULL DEFAULT '–ù–µ—Ç',
            expires_at TEXT,
            paid_at TEXT,
            plan_regens_left INTEGER DEFAULT NULL,
            remind_stage INTEGER NOT NULL DEFAULT -1
        )
        """)
        for _col, _typ in [
            ("plan_regens_left", "INTEGER DEFAULT NULL"),
            ("tariff_name",      "TEXT NOT NULL DEFAULT '–ù–µ—Ç'"),
            ("remind_stage",     "INTEGER NOT NULL DEFAULT -1"),
        ]:
            try:
                await conn.execute(f"ALTER TABLE access ADD COLUMN {_col} {_typ}")
            except Exception:
                pass
        # –ú–∏–≥—Ä–∞—Ü–∏—è: –ø—Ä–æ–±–Ω—ã–π —Ç–∞—Ä–∏—Ñ —Ç–µ–ø–µ—Ä—å –∏–º–µ–µ—Ç 1 —Å–º–µ–Ω—É –ø–ª–∞–Ω–∞ (–±—ã–ª–æ 0)
        # –ò—Å–ø—Ä–∞–≤–ª—è–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å trial + plan_regens_left=0
        try:
            await conn.execute(
                "UPDATE access SET plan_regens_left=1 WHERE tariff='trial' AND (plan_regens_left IS NULL OR plan_regens_left=0) AND paid=1"
            )
        except Exception:
            pass
        await conn.execute("""
        CREATE TABLE IF NOT EXISTS payments (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            user_id INTEGER,
            tariff TEXT,
            amount INTEGER,
            last4 TEXT,
            code TEXT,
            status TEXT,
            receipt_file_id TEXT,
            created_at TEXT
        )
        """)

        await conn.execute("""
        CREATE TABLE IF NOT EXISTS workout_plans (
            user_id INTEGER PRIMARY KEY,
            plan_text TEXT,
            plan_json TEXT,
            updated_at TEXT
        )
        """)
        try:
            await conn.execute("ALTER TABLE workout_plans ADD COLUMN plan_json TEXT")
        except Exception:
            pass

        await conn.execute("""
        CREATE TABLE IF NOT EXISTS nutrition_plans (
            user_id INTEGER PRIMARY KEY,
            plan_text TEXT,
            updated_at TEXT
        )
        """)
        await conn.execute("""
        CREATE TABLE IF NOT EXISTS diary_sessions (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            user_id INTEGER,
            session_date TEXT,
            title TEXT,
            created_at TEXT
        )
        """)
        await conn.execute("""
        CREATE TABLE IF NOT EXISTS diary_sets (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            session_id INTEGER,
            exercise TEXT,
            set_no INTEGER,
            weight REAL,
            reps INTEGER
        )
        """)
        await conn.execute("""
        CREATE TABLE IF NOT EXISTS measurements (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            user_id INTEGER,
            mtype TEXT,
            value REAL,
            created_at TEXT
        )
        """)

        await conn.execute("""
        CREATE TABLE IF NOT EXISTS bot_state (
            user_id INTEGER PRIMARY KEY,
            last_bot_msg_id INTEGER,
            diary_prompt_msg_id INTEGER
        )
        """)
        for col, typ in [
            ("diary_prompt_msg_id", "INTEGER"),
        ]:
            try:
                await conn.execute(f"ALTER TABLE bot_state ADD COLUMN {col} {typ}")
            except Exception:
                pass

        await conn.execute("""
        CREATE TABLE IF NOT EXISTS posts (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            admin_id INTEGER,
            post_media_type TEXT,
            post_media_file_id TEXT,
            post_text TEXT,
            status TEXT,
            created_at TEXT
        )
        """)
        await conn.execute("""
        CREATE TABLE IF NOT EXISTS post_sends (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            post_id INTEGER,
            user_id INTEGER,
            status TEXT,
            error TEXT,
            created_at TEXT
        )
        """)
        await conn.execute("""
        CREATE TABLE IF NOT EXISTS workout_completions (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            user_id INTEGER,
            day_num INTEGER,
            completed_date TEXT,
            created_at TEXT
        )
        """)
        await conn.execute("""
        CREATE TABLE IF NOT EXISTS workout_day_progress (
            user_id INTEGER,
            day_num INTEGER,
            done_exercises TEXT,
            PRIMARY KEY (user_id, day_num)
        )
        """)
        await conn.commit()


async def ensure_user(user_id: int, username: str):
    now = datetime.utcnow().isoformat()
    async with db() as conn:
        await conn.execute(
            "INSERT OR IGNORE INTO users (user_id, username, created_at) VALUES (?, ?, ?)",
            (user_id, username or "", now)
        )
        await conn.execute(
            "INSERT OR IGNORE INTO access (user_id, paid, tariff, expires_at, paid_at) VALUES (?, 0, NULL, NULL, NULL)",
            (user_id,)
        )
        await conn.execute(
            "INSERT OR IGNORE INTO bot_state (user_id, last_bot_msg_id, diary_prompt_msg_id) VALUES (?, NULL, NULL)",
            (user_id,)
        )
        await conn.commit()


async def get_user(user_id: int):
    async with db() as conn:
        async with conn.execute("""
            SELECT user_id, username, goal, sex, age, height, weight, place, exp, freq, meals, limits, state
            FROM users WHERE user_id=?
        """, (user_id,)) as cur:
            row = await cur.fetchone()

    if not row:
        return {}
    return {
        "user_id": row[0], "username": row[1], "goal": row[2], "sex": row[3],
        "age": row[4], "height": row[5], "weight": row[6], "place": row[7],
        "exp": row[8], "freq": row[9], "meals": row[10], "limits": row[11], "state": row[12]
    }


async def update_user(user_id: int, **fields):
    if not fields:
        return
    keys, vals = [], []
    for k, v in fields.items():
        keys.append(f"{k}=?")
        vals.append(v)
    vals.append(user_id)
    q = "UPDATE users SET " + ", ".join(keys) + " WHERE user_id=?"
    async with db() as conn:
        await conn.execute(q, tuple(vals))
        await conn.commit()


async def get_access(user_id: int):
    async with db() as conn:
        async with conn.execute(
            "SELECT paid, tariff, expires_at, paid_at FROM access WHERE user_id=?",
            (user_id,)
        ) as cur:
            row = await cur.fetchone()
    if not row:
        return {"paid": 0, "tariff": None, "expires_at": None, "paid_at": None}
    return {"paid": row[0], "tariff": row[1], "expires_at": row[2], "paid_at": row[3]}


async def is_access_active(user_id: int) -> bool:
    a = await get_access(user_id)
    if a["paid"] != 1:
        return False
    if a["tariff"] == "life":
        return True
    if not a["expires_at"]:
        return False
    try:
        exp = datetime.fromisoformat(a["expires_at"])
    except Exception:
        return False
    return datetime.utcnow() < exp


async def get_plan_regens(user_id: int):
    """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç (regens_left, is_unlimited).
    regens_left=None => –±–µ–∑–ª–∏–º–∏—Ç. regens_left=0 => –∏—Å—á–µ—Ä–ø–∞–Ω."""
    async with db() as conn:
        async with conn.execute(
            "SELECT plan_regens_left, tariff FROM access WHERE user_id=?", (user_id,)
        ) as cur:
            row = await cur.fetchone()
    if not row:
        return (0, False)
    regens_left = row[0]
    tariff_code = row[1] or ""
    t = TARIFFS.get(tariff_code, {})
    base_regens = t.get("plan_regens")
    if base_regens is None:
        return (None, True)  # –±–µ–∑–ª–∏–º–∏—Ç
    if regens_left is None:
        # –ü–æ–ª–µ –µ—â—ë –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ (—Å—Ç–∞—Ä—ã–µ –∑–∞–ø–∏—Å–∏) ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∞–∑–æ–≤—ã–π –ª–∏–º–∏—Ç —Ç–∞—Ä–∏—Ñ–∞
        return (base_regens, False)
    return (int(regens_left), False)


async def decrement_plan_regens(user_id: int):
    """–£–º–µ–Ω—å—à–∏—Ç—å —Å—á—ë—Ç—á–∏–∫ –Ω–∞ 1 (–Ω–µ —É—Ö–æ–¥–∏—Ç—å –Ω–∏–∂–µ 0)."""
    async with db() as conn:
        await conn.execute(
            "UPDATE access SET plan_regens_left = MAX(0, COALESCE(plan_regens_left, 0) - 1) WHERE user_id=?",
            (user_id,)
        )
        await conn.commit()



# =========================
# –ü–û–î–ü–ò–°–ö–ê: —É—Ç–∏–ª–∏—Ç—ã
# =========================
async def get_subscription(user_id: int) -> dict:
    """–ï–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–¥—ã –æ –ø–æ–¥–ø–∏—Å–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""
    async with db() as conn:
        async with conn.execute(
            """SELECT paid, tariff, tariff_name, expires_at, paid_at, remind_stage
               FROM access WHERE user_id=?""",
            (user_id,)
        ) as cur:
            row = await cur.fetchone()
    if not row:
        return {
            "tariff": "none", "tariff_name": "–ù–µ—Ç",
            "expires_at": None, "is_active": 0, "remind_stage": -1
        }
    paid, tariff, tariff_name, expires_at, paid_at, remind_stage = row
    is_active = 0
    if paid == 1:
        if tariff == "life":
            is_active = 1
        elif expires_at:
            try:
                if datetime.utcnow() < datetime.fromisoformat(expires_at):
                    is_active = 1
            except Exception:
                pass
    return {
        "tariff": tariff or "none",
        "tariff_name": tariff_name or "–ù–µ—Ç",
        "expires_at": expires_at,
        "is_active": is_active,
        "remind_stage": remind_stage if remind_stage is not None else -1,
    }


def is_subscription_active(sub: dict) -> bool:
    return bool(sub.get("is_active"))


def format_tariff_line(sub: dict) -> str:
    """–°—Ç—Ä–æ–∫–∞ –æ —Ç–∞—Ä–∏—Ñ–µ –¥–ª—è –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é."""
    tariff = sub.get("tariff", "none")
    if not is_subscription_active(sub):
        return "üí≥ –¢–∞—Ä–∏—Ñ: –Ω–µ—Ç (–¥–æ—Å—Ç—É–ø –æ–≥—Ä–∞–Ω–∏—á–µ–Ω)"
    if tariff == "life":
        return "üí≥ –¢–∞—Ä–∏—Ñ: –ù–∞–≤—Å–µ–≥–¥–∞ ‚úÖ"
    # –ü—Ä–æ–±–Ω—ã–π ‚Äî –≤—Å–µ–≥–¥–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º –∫–∞–∫ "–ü—Ä–æ–±–Ω—ã–π"
    if tariff == "trial":
        expires_at = sub.get("expires_at")
        if expires_at:
            try:
                dt = datetime.fromisoformat(expires_at)
                return f"üí≥ –¢–∞—Ä–∏—Ñ: –ü—Ä–æ–±–Ω—ã–π (–¥–æ {dt.strftime('%d.%m.%Y')})"
            except Exception:
                pass
        return "üí≥ –¢–∞—Ä–∏—Ñ: –ü—Ä–æ–±–Ω—ã–π"
    tariff_name = sub.get("tariff_name") or ""
    expires_at = sub.get("expires_at")
    if expires_at:
        try:
            dt = datetime.fromisoformat(expires_at)
            return f"üí≥ –¢–∞—Ä–∏—Ñ: {tariff_name} (–¥–æ {dt.strftime('%d.%m.%Y')})"
        except Exception:
            pass
    return f"üí≥ –¢–∞—Ä–∏—Ñ: {tariff_name}"


async def is_full_access_active(user_id: int) -> bool:
    """–ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø: —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ + –ø–∏—Ç–∞–Ω–∏–µ (—Ç–æ–ª—å–∫–æ –ø–ª–∞—Ç–Ω—ã–µ —Ç–∞—Ä–∏—Ñ—ã, –Ω–µ –ø—Ä–æ–±–Ω—ã–π)."""
    a = await get_access(user_id)
    if a["paid"] != 1:
        return False
    if not await is_access_active(user_id):
        return False
    return a.get("tariff") in FULL_ACCESS_TARIFFS


async def set_paid_tariff(user_id: int, tariff_code: str):
    t = TARIFFS.get(tariff_code)
    if not t:
        raise ValueError("Unknown tariff")
    now = datetime.utcnow()
    now_iso = now.isoformat()
    expires_at = None if t["days"] is None else (now + timedelta(days=int(t["days"]))).isoformat()
    regens = t.get("plan_regens")  # None = –±–µ–∑–ª–∏–º–∏—Ç, 0 = –Ω–µ–ª—å–∑—è, N = –ª–∏–º–∏—Ç
    tariff_name = t.get("title", tariff_code)

    async with db() as conn:
        await conn.execute(
            """UPDATE access
               SET paid=1, tariff=?, tariff_name=?, expires_at=?, paid_at=?,
                   plan_regens_left=?, remind_stage=-1
               WHERE user_id=?""",
            (tariff_code, tariff_name, expires_at, now_iso, regens, user_id)
        )
        await conn.commit()


async def save_workout_plan(user_id: int, text: str, plan_json: Optional[str] = None):
    now = datetime.utcnow().isoformat()
    async with db() as conn:
        await conn.execute("""
            INSERT INTO workout_plans (user_id, plan_text, plan_json, updated_at)
            VALUES (?, ?, ?, ?)
            ON CONFLICT(user_id) DO UPDATE SET
                plan_text=excluded.plan_text,
                plan_json=excluded.plan_json,
                updated_at=excluded.updated_at
        """, (user_id, text, plan_json or "", now))
        await conn.commit()


async def save_nutrition_plan(user_id: int, text: str):
    now = datetime.utcnow().isoformat()
    async with db() as conn:
        await conn.execute("""
            INSERT INTO nutrition_plans (user_id, plan_text, updated_at)
            VALUES (?, ?, ?)
            ON CONFLICT(user_id) DO UPDATE SET plan_text=excluded.plan_text, updated_at=excluded.updated_at
        """, (user_id, text, now))
        await conn.commit()


async def get_workout_plan(user_id: int):
    async with db() as conn:
        async with conn.execute("SELECT plan_text, plan_json FROM workout_plans WHERE user_id=?", (user_id,)) as cur:
            row = await cur.fetchone()
    if not row:
        return None, {}
    return (row[0] or ""), loads_plan(row[1] or "")


async def get_nutrition_plan(user_id: int):
    async with db() as conn:
        async with conn.execute("SELECT plan_text FROM nutrition_plans WHERE user_id=?", (user_id,)) as cur:
            row = await cur.fetchone()
    return row[0] if row else None


async def create_payment(user_id: int, tariff: str, amount: int, last4: str, code: str, receipt_file_id: str):
    now = datetime.utcnow().isoformat()
    async with db() as conn:
        cur = await conn.execute("""
            INSERT INTO payments (user_id, tariff, amount, last4, code, status, receipt_file_id, created_at)
            VALUES (?, ?, ?, ?, ?, 'pending', ?, ?)
        """, (user_id, tariff, amount, last4, code, receipt_file_id, now))
        await conn.commit()
        return cur.lastrowid


async def get_payment(payment_id: int):
    async with db() as conn:
        async with conn.execute("""
            SELECT id, user_id, tariff, amount, last4, code, status, receipt_file_id, created_at
            FROM payments WHERE id=?
        """, (payment_id,)) as cur:
            row = await cur.fetchone()
    if not row:
        return {}
    return {
        "id": row[0], "user_id": row[1], "tariff": row[2], "amount": row[3],
        "last4": row[4], "code": row[5], "status": row[6], "receipt_file_id": row[7], "created_at": row[8]
    }


async def set_payment_status(payment_id: int, status: str):
    async with db() as conn:
        await conn.execute("UPDATE payments SET status=? WHERE id=?", (status, payment_id))
        await conn.commit()


async def has_recent_pending_payment(user_id: int) -> bool:
    since = (datetime.utcnow() - timedelta(hours=2)).isoformat()
    async with db() as conn:
        async with conn.execute("""
            SELECT COUNT(*) FROM payments
            WHERE user_id=? AND status='pending' AND created_at>=?
        """, (user_id, since)) as cur:
            row = await cur.fetchone()
    return bool(row and row[0] > 0)


async def create_diary_session(user_id: int, session_date: str, title: str):
    now = datetime.utcnow().isoformat()
    async with db() as conn:
        cur = await conn.execute("""
            INSERT INTO diary_sessions (user_id, session_date, title, created_at)
            VALUES (?, ?, ?, ?)
        """, (user_id, session_date, title, now))
        await conn.commit()
        return cur.lastrowid


async def get_or_create_today_session(user_id: int) -> int:
    today = datetime.now().strftime("%Y-%m-%d")
    async with db() as conn:
        async with conn.execute("""
            SELECT id FROM diary_sessions
            WHERE user_id=? AND session_date=?
            ORDER BY id DESC LIMIT 1
        """, (user_id, today)) as cur:
            row = await cur.fetchone()
        if row:
            return int(row[0])

        title = f"–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ {today}"  # –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ update_diary_session_title –µ—Å–ª–∏ –∏–∑–≤–µ—Å—Ç–µ–Ω —Ç–∏–ø –¥–Ω—è
        cur2 = await conn.execute("""
            INSERT INTO diary_sessions (user_id, session_date, title, created_at)
            VALUES (?, ?, ?, ?)
        """, (user_id, today, title, datetime.utcnow().isoformat()))
        await conn.commit()
        return int(cur2.lastrowid)


async def add_set(session_id: int, exercise: str, set_no: int, weight: float, reps: int):
    async with db() as conn:
        await conn.execute("""
            INSERT INTO diary_sets (session_id, exercise, set_no, weight, reps)
            VALUES (?, ?, ?, ?, ?)
        """, (session_id, exercise, set_no, weight, reps))
        await conn.commit()


async def get_diary_history(user_id: int, limit_sessions: int = 10):
    async with db() as conn:
        async with conn.execute("""
            SELECT id, session_date, title
            FROM diary_sessions
            WHERE user_id=?
            ORDER BY id DESC LIMIT ?
        """, (user_id, limit_sessions)) as cur:
            sessions = await cur.fetchall()

        out = []
        for s in sessions:
            sid = s[0]
            async with conn.execute("""
                SELECT exercise, set_no, weight, reps
                FROM diary_sets
                WHERE session_id=?
                ORDER BY id ASC
            """, (sid,)) as cur2:
                sets = await cur2.fetchall()
            out.append((s, sets))
    return out


async def add_measure(user_id: int, mtype: str, value: float):
    now = datetime.utcnow().isoformat()
    async with db() as conn:
        await conn.execute(
            "INSERT INTO measurements (user_id, mtype, value, created_at) VALUES (?, ?, ?, ?)",
            (user_id, mtype, value, now)
        )
        await conn.commit()


async def get_last_measures(user_id: int, mtype: str, limit: int = 8):
    async with db() as conn:
        async with conn.execute("""
            SELECT value, created_at
            FROM measurements
            WHERE user_id=? AND mtype=?
            ORDER BY id DESC LIMIT ?
        """, (user_id, mtype, limit)) as cur:
            rows = await cur.fetchall()
    return rows or []


async def get_last_measures_any(user_id: int, limit: int = 30):
    async with db() as conn:
        async with conn.execute("""
            SELECT mtype, value, created_at
            FROM measurements
            WHERE user_id=?
            ORDER BY id DESC LIMIT ?
        """, (user_id, limit)) as cur:
            rows = await cur.fetchall()
    return rows or []


async def create_post_draft(admin_id: int, media_type: str, media_file_id: Optional[str], text: Optional[str]) -> int:
    now = datetime.utcnow().isoformat()
    async with db() as conn:
        cur = await conn.execute("""
            INSERT INTO posts (admin_id, post_media_type, post_media_file_id, post_text, status, created_at)
            VALUES (?, ?, ?, ?, 'draft', ?)
        """, (admin_id, media_type, media_file_id or "", text or "", now))
        await conn.commit()
        return cur.lastrowid


async def get_post(post_id: int):
    async with db() as conn:
        async with conn.execute("""
            SELECT id, admin_id, post_media_type, post_media_file_id, post_text, status, created_at
            FROM posts WHERE id=?
        """, (post_id,)) as cur:
            row = await cur.fetchone()
    if not row:
        return {}
    return {
        "id": row[0], "admin_id": row[1], "media_type": row[2],
        "media_file_id": row[3], "text": row[4], "status": row[5], "created_at": row[6]
    }


async def set_post_status(post_id: int, status: str):
    async with db() as conn:
        await conn.execute("UPDATE posts SET status=? WHERE id=?", (status, post_id))
        await conn.commit()


async def get_all_user_ids():
    async with db() as conn:
        async with conn.execute("SELECT user_id FROM users") as cur:
            rows = await cur.fetchall()
    return [r[0] for r in rows] if rows else []


# =========================
# –¢–†–ï–ù–ò–†–û–í–ö–ò: –ø—Ä–æ–≥—Ä–µ—Å—Å –¥–Ω—è
# =========================

EXERCISE_TECH_MAP = [
    # ‚îÄ‚îÄ –°–ü–ï–¶–ò–§–ò–ß–ù–´–ï ‚Äî —Å—Ç—Ä–æ–≥–æ —Ä–∞–Ω—å—à–µ –æ–±—â–∏—Ö ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

    # –ü—Ä–∏—Å–µ–¥ ‚Äî –≤–∞—Ä–∏–∞–Ω—Ç—ã –ø–æ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—é (—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –ø–µ—Ä–µ–¥ –æ–±—â–∏–º "–ø—Ä–∏—Å–µ–¥")
    ("–≥–æ–±–ª–µ—Ç-–ø—Ä–∏—Å–µ–¥", "goblet"),
    ("–≥–æ–±–ª–µ—Ç", "goblet"),
    ("–ø—Ä–∏—Å–µ–¥ —Å –≥–∞–Ω—Ç–µ–ª", "goblet"),               # –ø—Ä–∏—Å–µ–¥ —Å –≥–∞–Ω—Ç–µ–ª—å—é/–≥–∞–Ω—Ç–µ–ª—è–º–∏ ‚Üí goblet
    ("—Ö–∞–∫–∫-–ø—Ä–∏—Å–µ–¥", "hack_squat"),
    ("—Ö–∞–∫–∫", "hack_squat"),
    ("–±–æ–ª–≥–∞—Ä—Å–∫–∏–µ –≤—ã–ø–∞–¥—ã", "bulgarian"),
    ("–±–æ–ª–≥–∞—Ä—Å–∫–∏–µ –≤—ã–ø–∞–¥—ã (–Ω–æ–≥–∞", "bulgarian"),
    ("–±–æ–ª–≥–∞—Ä", "bulgarian"),
    ("–≤—ã–ø–∞–¥—ã —Ö–æ–¥—å–±–æ–π", "lunge_walking"),          # ‚Üê —É–Ω–∏–∫–∞–ª—å–Ω–∞—è: –¥–∏–Ω–∞–º–∏–∫–∞
    ("–≤—ã–ø–∞–¥—ã —Å–æ —à—Ç–∞–Ω–≥–æ–π", "lunge_barbell"),        # ‚Üê —É–Ω–∏–∫–∞–ª—å–Ω–∞—è: —Å–æ —à—Ç–∞–Ω–≥–æ–π
    ("–≤—ã–ø–∞–¥—ã —Å –≥–∞–Ω—Ç–µ–ª—è–º–∏", "lunge_dumbbell"),      # ‚Üê —É–Ω–∏–∫–∞–ª—å–Ω–∞—è: —Å –≥–∞–Ω—Ç–µ–ª—è–º–∏
    ("–≤—ã–ø–∞–¥—ã –Ω–∞ –º–µ—Å—Ç–µ", "lunge"),
    ("–≤—ã–ø–∞–¥", "lunge"),
    ("–ø—Ä–∏—Å–µ–¥ —Å–æ —à—Ç–∞–Ω–≥–æ–π", "squat_barbell"),        # ‚Üê —É–Ω–∏–∫–∞–ª—å–Ω–∞—è: —Ç–µ—Ö–Ω–∏–∫–∞ —Å–æ —à—Ç–∞–Ω–≥–æ–π
    ("–ø—Ä–∏—Å–µ–¥ —Å—É–º–æ", "squat_sumo"),                 # ‚Üê —É–Ω–∏–∫–∞–ª—å–Ω–∞—è: —Ç–µ—Ö–Ω–∏–∫–∞ —Å—É–º–æ
    ("–ø—Ä–∏—Å–µ–¥ —Å –ø–∞—É–∑–æ–π", "squat_barbell"),
    ("–ø—Ä–∏—Å–µ–¥–∞–Ω–∏—è –Ω–∞ –æ–¥–Ω–æ–π –Ω–æ–≥–µ", "squat_bodyweight"),  # ‚Üê —É–Ω–∏–∫–∞–ª—å–Ω–∞—è: bodyweight
    ("–ø—Ä–∏—Å–µ–¥–∞–Ω–∏—è (—Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–µ—Å)", "squat_bodyweight"),
    ("–ø—Ä–∏—Å–µ–¥", "squat"),                           # –æ–±—â–∏–π –±–µ–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è

    # –ù–∏–∂–Ω—è—è —Ç—è–≥–∞ / –∑–∞–¥–Ω—è—è —Ü–µ–ø—å
    ("—Ä—É–º—ã–Ω—Å–∫–∞—è —Ç—è–≥–∞ —Å –≥–∞–Ω—Ç–µ–ª—è–º–∏", "rdl_dumbbell"),    # ‚Üê —É–Ω–∏–∫–∞–ª—å–Ω–∞—è
    ("—Ä—É–º—ã–Ω—Å–∫–∞—è —Ç—è–≥–∞ —Å–æ —à—Ç–∞–Ω–≥–æ–π", "rdl_barbell"),      # ‚Üê —É–Ω–∏–∫–∞–ª—å–Ω–∞—è
    ("—Ä—É–º—ã–Ω—Å–∫–∞—è —Ç—è–≥–∞", "rdl"),
    ("—Å—Ç–∞–Ω–æ–≤–∞—è —Ç—è–≥–∞ —Å—É–º–æ", "deadlift_sumo"),            # ‚Üê —É–Ω–∏–∫–∞–ª—å–Ω–∞—è
    ("—Å—Ç–∞–Ω–æ–≤–∞—è —Ç—è–≥–∞ (—Ç–µ—Ö–Ω–∏–∫–∞)", "deadlift"),
    ("—Å—Ç–∞–Ω–æ–≤–∞—è —Ç—è–≥–∞ (–ª—ë–≥–∫–∞—è", "deadlift"),
    ("—Å—Ç–∞–Ω–æ–≤–∞—è —Ç—è–≥–∞", "deadlift"),
    ("—è–≥–æ–¥–∏—á–Ω—ã–π –º–æ—Å—Ç —Å–æ —à—Ç–∞–Ω–≥–æ–π", "hinge"),
    ("—è–≥–æ–¥–∏—á–Ω—ã–π –º–æ—Å—Ç –Ω–∞ –æ–¥–Ω–æ–π –Ω–æ–≥–µ", "hinge"),
    ("—è–≥–æ–¥–∏—á–Ω—ã–π –º–æ—Å—Ç", "hinge"),
    ("–≥–∏–ø–µ—Ä—ç–∫—Å—Ç–µ–Ω–∑–∏—è —Å –≤–µ—Å–æ–º", "hyperext"),
    ("–≥–∏–ø–µ—Ä—ç–∫—Å—Ç–µ–Ω–∑–∏—è –Ω–∞ –ø–æ–ª—É", "hyperext"),
    ("–≥–∏–ø–µ—Ä—ç–∫—Å—Ç–µ–Ω–∑–∏", "hyperext"),
    ("good-morning", "good_morning"),

    # –ù–æ–≥–∏ ‚Äî —Ç—Ä–µ–Ω–∞–∂—ë—Ä—ã
    ("–∂–∏–º –Ω–æ–≥–∞–º–∏ –≤ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–µ", "legpress"),
    ("–∂–∏–º –Ω–æ–≥–∞–º–∏", "legpress"),
    ("–∂–∏–º –Ω–æ–≥", "legpress"),
    ("—Å–≥–∏–±–∞–Ω–∏—è –Ω–æ–≥ –≤ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–µ", "legcurl"),
    ("—Å–≥–∏–±–∞–Ω–∏—è –Ω–æ–≥", "legcurl"),

    # –ò–∫—Ä—ã
    ("–ø–æ–¥—ä—ë–º—ã –Ω–∞ –Ω–æ—Å–∫–∏ –Ω–∞ –æ–¥–Ω–æ–π –Ω–æ–≥–µ", "calves"),
    ("–ø–æ–¥—ä—ë–º—ã –Ω–∞ –Ω–æ—Å–∫–∏ —Å –≥–∞–Ω—Ç–µ–ª—è–º–∏", "calves"),
    ("–ø–æ–¥—ä—ë–º—ã –Ω–∞ –Ω–æ—Å–∫–∏ —Å—Ç–æ—è", "calves"),
    ("–ø–æ–¥—ä—ë–º—ã –Ω–∞ –Ω–æ—Å–∫–∏ —Å–∏–¥—è", "calves"),
    ("–ø–æ–¥—ä—ë–º –Ω–∞ –Ω–æ—Å–∫–∏", "calves"),
    ("–ø–æ–¥—ä—ë–º—ã –Ω–∞ –Ω–æ—Å–∫–∏", "calves"),
    ("–∏–∫—Ä—ã", "calves"),

    # –ñ–∏–º –ª—ë–∂–∞ ‚Äî –≤–∞—Ä–∏–∞–Ω—Ç—ã –ø–æ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—é
    ("–∂–∏–º —à—Ç–∞–Ω–≥–∏ –ø–æ–¥ —É–≥–ª–æ–º", "incline_press_barbell"),     # ‚Üê —É–Ω–∏–∫–∞–ª—å–Ω–∞—è
    ("–∂–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π –ø–æ–¥ —É–≥–ª–æ–º", "incline_press_dumbbell"),  # ‚Üê —É–Ω–∏–∫–∞–ª—å–Ω–∞—è
    ("–∂–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π –ª—ë–∂", "bench_dumbbell"),                # ‚Üê —É–Ω–∏–∫–∞–ª—å–Ω–∞—è
    ("–∂–∏–º –≤ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–µ (–≥—Ä—É–¥—å)", "bench_machine"),          # ‚Üê —É–Ω–∏–∫–∞–ª—å–Ω–∞—è
    ("–∂–∏–º —à—Ç–∞–Ω–≥–∏ –ª—ë–∂", "bench"),
    ("–∂–∏–º –ª—ë–∂", "bench"),
    ("–∂–∏–º –≤ —Ç—Ä–µ–Ω–∞–∂", "bench_machine"),
    ("—Ä–∞–∑–≤–µ–¥–µ–Ω–∏—è –≥–∞–Ω—Ç–µ–ª–µ–π –ª—ë–∂–∞", "chest_fly"),             # ‚Üê —É–Ω–∏–∫–∞–ª—å–Ω–∞—è
    ("—Å–≤–µ–¥–µ–Ω–∏—è –≤ –∫—Ä–æ—Å—Å–æ–≤–µ—Ä–µ", "crossover"),                # ‚Üê —É–Ω–∏–∫–∞–ª—å–Ω–∞—è
    ("—Å–≤–µ–¥–µ–Ω–∏", "crossover"),

    # –ñ–∏–º –≤–≤–µ—Ä—Ö ‚Äî ohp_barbell —Å—Ç—Ä–æ–≥–æ –ø–µ—Ä–µ–¥ ohp
    ("–∞—Ä–º–µ–π—Å–∫–∏–π –∂–∏–º", "ohp_barbell"),
    ("–∂–∏–º —à—Ç–∞–Ω–≥–∏ —Å—Ç–æ—è", "ohp_barbell"),
    ("–∂–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π —Å—Ç–æ—è", "ohp_dumbbell"),         # ‚Üê —É–Ω–∏–∫–∞–ª—å–Ω–∞—è
    ("–∂–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π —Å–∏–¥—è", "ohp_dumbbell"),          # ‚Üê —É–Ω–∏–∫–∞–ª—å–Ω–∞—è
    ("–∂–∏–º —Ä–µ–∑–∏–Ω–∫–∏ –≤–≤–µ—Ä—Ö", "band_ohp"),
    ("–∂–∏–º –≤ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–µ –≤–≤–µ—Ä—Ö", "ohp_machine"),       # ‚Üê —É–Ω–∏–∫–∞–ª—å–Ω–∞—è
    ("–∂–∏–º –≤–≤–µ—Ä—Ö", "ohp"),

    # –û—Ç–∂–∏–º–∞–Ω–∏—è
    ("–æ—Ç–∂–∏–º–∞–Ω–∏—è —É–∑–∫–∏–µ (—Ç—Ä–∏—Ü–µ–ø—Å)", "narrow_pushup"),
    ("–æ—Ç–∂–∏–º–∞ —É–∑–∫", "narrow_pushup"),
    ("—É–∑–∫–∏–µ –æ—Ç–∂–∏–º–∞", "narrow_pushup"),
    ("–ø–∞–π–∫-–æ—Ç–∂–∏–º–∞–Ω–∏—è", "pike_pushup"),
    ("–æ—Ç–∂–∏–º–∞–Ω–∏—è (–Ω–æ–≥–∏ –≤—ã—Å–æ–∫–æ", "pike_pushup"),
    ("–ø–∞–π–∫", "pike_pushup"),
    ("–æ—Ç–∂–∏–º–∞–Ω–∏—è —Å –≤–µ—Å–æ–º", "row"),
    ("–æ—Ç–∂–∏–º–∞–Ω–∏—è —Å –ø–∞—É–∑–æ–π", "row"),
    ("–æ—Ç–∂–∏–º–∞–Ω–∏—è –æ—Ç –≤–æ–∑–≤—ã—à–µ–Ω–∏—è", "row"),
    ("–æ—Ç–∂–∏–º–∞–Ω–∏—è —Å —Ö–ª–æ–ø–∫–æ–º", "row"),
    ("–æ—Ç–∂–∏–º–∞–Ω–∏—è (–∫–ª–∞—Å—Å–∏–∫–∞)", "row"),
    ("–≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ –ø–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è", "pullup"),
    ("–æ–±—Ä–∞—Ç–Ω—ã–µ –æ—Ç–∂–∏–º–∞–Ω–∏—è –æ—Ç —Å—Ç—É–ª–∞", "triceps"),
    ("–æ–±—Ä–∞—Ç–Ω—ã–µ –æ—Ç–∂–∏–º–∞–Ω–∏—è", "triceps"),
    ("–æ—Ç–∂–∏–º–∞", "row"),

    # –ü–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è ‚Äî –≤–∞—Ä–∏–∞–Ω—Ç—ã —Ö–≤–∞—Ç–∞
    ("–ø–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è (—à–∏—Ä–æ–∫–∏–π", "pullup_wide"),              # ‚Üê —É–Ω–∏–∫–∞–ª—å–Ω–∞—è
    ("–ø–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è (–æ–±—Ä–∞—Ç–Ω—ã–π —Ö–≤–∞—Ç)", "pullup_chinup"),     # ‚Üê —É–Ω–∏–∫–∞–ª—å–Ω–∞—è
    ("–ø–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è (–ø—Ä—è–º–æ–π —Ö–≤–∞—Ç)", "pullup"),
    ("–ø–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–º", "pullup"),
    ("–ø–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è –Ω–∞ –ø–µ—Ç–ª—è—Ö", "pullup"),
    ("–Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–µ –ø–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è", "pullup"),
    ("–ø–æ–¥—Ç—è–≥–∏–≤–∞", "pullup"),
    ("–≤–µ—Ä—Ö–Ω–∏–π –±–ª–æ–∫ —à–∏—Ä–æ–∫", "latpulldown_wide"),            # ‚Üê —É–Ω–∏–∫–∞–ª—å–Ω–∞—è
    ("–≤–µ—Ä—Ö–Ω–∏–π –±–ª–æ–∫ —É–∑–∫", "latpulldown_narrow"),            # ‚Üê —É–Ω–∏–∫–∞–ª—å–Ω–∞—è
    ("—Ç—è–≥–∞ –≤–µ—Ä—Ö–Ω–µ–≥–æ –±–ª–æ–∫–∞ —à–∏—Ä–æ–∫", "latpulldown_wide"),
    ("—Ç—è–≥–∞ –≤–µ—Ä—Ö–Ω–µ–≥–æ –±–ª–æ–∫–∞ —É–∑–∫", "latpulldown_narrow"),
    ("—Ç—è–≥–∞ –≤–µ—Ä—Ö–Ω–µ–≥–æ –±–ª–æ–∫–∞", "latpulldown"),
    ("–≤–µ—Ä—Ö–Ω–∏–π –±–ª–æ–∫", "latpulldown"),
    ("—Ç—è–≥–∞ –≤–µ—Ä—Ö–Ω", "latpulldown"),

    # –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ —Ç—è–≥–∏ ‚Äî barbell_row/dumbbell_row –ø–µ—Ä–µ–¥ rowtrain
    ("—Ç—è–≥–∞ —à—Ç–∞–Ω–≥–∏ –≤ –Ω–∞–∫–ª–æ–Ω–µ", "barbell_row"),
    ("—Ç—è–≥–∞ —Ç-–≥—Ä–∏—Ñ", "barbell_row"),
    ("—Ç—è–≥–∞ –≥–∞–Ω—Ç–µ–ª–∏ –æ–¥–Ω–æ–π —Ä—É–∫–æ–π", "dumbbell_row"),
    ("—Ç—è–≥–∞ –≥–∞–Ω—Ç–µ–ª", "dumbbell_row"),
    ("—Ç—è–≥–∞ –Ω–∏–∂–Ω–µ–≥–æ –±–ª–æ–∫–∞", "rowtrain"),
    ("—Ç—è–≥–∞ –≥–æ—Ä–∏–∑–æ–Ω—Ç", "rowtrain"),
    ("—Ç—è–≥–∞ –≤ —Ç—Ä–µ–Ω–∞–∂", "rowtrain"),

    # –¢—è–≥–∞ —Ä–µ–∑–∏–Ω–æ–∫ ‚Äî —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –ø–µ—Ä–µ–¥ "—Ç—è–≥–∞ —Ä–µ–∑–∏–Ω–∫–∏"
    ("—Ç—è–≥–∞ —Ä–µ–∑–∏–Ω–∫–∏ —Å–≤–µ—Ä—Ö—É", "band_pull"),
    ("—Ç—è–≥–∞ —Ä–µ–∑–∏–Ω–∫–∏ –∫ –ø–æ—è—Å—É", "band_row"),
    ("—Ç—è–≥–∞ —Ä–µ–∑–∏–Ω–∫–∏ –≤ –Ω–∞–∫–ª–æ–Ω–µ", "band_row"),
    ("—Ç—è–≥–∞ —Ä–µ–∑–∏–Ω–∫–∏ –∫ –ª–∏—Ü—É", "face_pull"),
    ("—Ç—è–≥–∞ —Ä–µ–∑–∏–Ω–∫–∏ –∫ –ø–æ–¥–±–æ—Ä–æ–¥–∫—É", "lateralraise"),
    ("—Ç—è–≥–∞ —Ä–µ–∑–∏–Ω–∫–∏", "band_row"),

    # Face pull / –∑–∞–¥–Ω—è—è –¥–µ–ª—å—Ç–∞
    ("face pull", "face_pull"),
    ("—Ç—è–≥–∞ –∫ –ª–∏—Ü—É", "face_pull"),
    ("—Ç—è–≥–∞ —à—Ç–∞–Ω–≥–∏ –∫ –ø–æ–¥–±–æ—Ä–æ–¥–∫—É", "lateralraise"),
    ("–∑–∞–¥–Ω—è—è –¥–µ–ª—å—Ç–∞ –≤ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–µ", "rear_delt"),
    ("–∑–∞–¥–Ω—è—è –¥–µ–ª—å—Ç–∞", "rear_delt"),
    ("—Ä–∞–∑–≤–µ–¥–µ–Ω–∏—è –≥–∞–Ω—Ç–µ–ª–µ–π –≤ –Ω–∞–∫–ª–æ–Ω–µ", "rear_delt"),
    ("—Ä–∞–∑–≤–µ–¥–µ–Ω–∏—è –≥–∞–Ω—Ç–µ–ª–µ–π –≤ —Å—Ç–æ—Ä–æ–Ω—ã", "lateralraise"),
    ("—Ä–∞–∑–≤–µ–¥–µ–Ω–∏", "lateralraise"),

    # –ü—Ä–µ—Å—Å ‚Äî –≤–∞—Ä–∏–∞–Ω—Ç—ã –ø–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—é (—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –ø–µ—Ä–µ–¥ –æ–±—â–∏–º "–ø–ª–∞–Ω–∫–∞")
    ("—Ä–æ–ª–∏–∫ –¥–ª—è –ø—Ä–µ—Å—Å–∞", "ab_rollout"),             # ‚Üê —É–Ω–∏–∫–∞–ª—å–Ω–∞—è
    ("ab wheel", "ab_rollout"),
    ("–±–æ–∫–æ–≤–∞—è –ø–ª–∞–Ω–∫–∞", "side_plank"),               # ‚Üê —É–Ω–∏–∫–∞–ª—å–Ω–∞—è
    ("–≤–µ–ª–æ—Å–∏–ø–µ–¥ (—Å–∫—Ä—É—á–∏–≤–∞–Ω–∏—è", "ab_crunch"),
    ("–≤–µ–ª–æ—Å–∏–ø–µ–¥", "ab_crunch"),
    ("–æ–±—Ä–∞—Ç–Ω—ã–µ —Å–∫—Ä—É—á–∏–≤–∞–Ω–∏—è", "ab_crunch"),
    ("—Å–∫—Ä—É—á–∏–≤–∞–Ω–∏—è –Ω–∞ –±–ª–æ–∫–µ", "ab_crunch"),
    ("—Å–∫—Ä—É—á–∏–≤–∞–Ω–∏—è –Ω–∞ –ø–æ–ª—É", "ab_crunch"),
    ("–ø–æ–¥—ä—ë–º—ã –Ω–æ–≥ –≤ –≤–∏—Å–µ", "hanging_leg_raise"),    # ‚Üê —É–Ω–∏–∫–∞–ª—å–Ω–∞—è
    ("–ø–æ–¥—ä—ë–º—ã –Ω–æ–≥ –≤ —É–ø–æ—Ä–µ –Ω–∞ –ª–æ–∫—Ç—è—Ö", "elbow_leg_raise"),  # ‚Üê —É–Ω–∏–∫–∞–ª—å–Ω–∞—è
    ("–ø–æ–¥—ä—ë–º—ã –Ω–æ–≥ –≤ —É–ø–æ—Ä–µ", "elbow_leg_raise"),
    ("–ø–æ–¥—ä—ë–º—ã –Ω–æ–≥ –ª—ë–∂–∞", "leg_raise_lying"),        # ‚Üê —É–Ω–∏–∫–∞–ª—å–Ω–∞—è
    ("–ø–æ–¥—ä—ë–º –Ω–æ–≥ –ª—ë–∂–∞", "leg_raise_lying"),
    ("–ø–æ–¥—ä—ë–º –Ω–æ–≥ –≤ –≤–∏—Å–µ", "hanging_leg_raise"),
    ("–ø–æ–¥—ä—ë–º –Ω–æ–≥", "leg_raise_lying"),
    ("–ø–ª–∞–Ω–∫–∞", "core"),
    ("—Å–∫—Ä—É—á–∏–≤–∞", "ab_crunch"),

    # –ë–∏—Ü–µ–ø—Å ‚Äî –≤–∞—Ä–∏–∞–Ω—Ç—ã –ø–æ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—é
    ("—Å–≥–∏–±–∞–Ω–∏—è –Ω–∞ —Å–∫–∞–º—å–µ —Å–∫–æ—Ç—Ç–∞", "biceps"),
    ("–∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–≥–∏–±–∞–Ω–∏—è", "biceps"),
    ("—Å–≥–∏–±–∞–Ω–∏—è –Ω–∞ —Ä–µ–∑–∏–Ω–∫–µ", "biceps"),
    ("—Å–≥–∏–±–∞–Ω–∏—è —à—Ç–∞–Ω–≥–∏ —Å—Ç–æ—è", "biceps_barbell"),      # ‚Üê —É–Ω–∏–∫–∞–ª—å–Ω–∞—è
    ("—Å–≥–∏–±–∞–Ω–∏—è —Å–æ —à—Ç–∞–Ω–≥–æ–π", "biceps_barbell"),        # ‚Üê —É–Ω–∏–∫–∞–ª—å–Ω–∞—è
    ("—Å–≥–∏–±–∞–Ω–∏—è –≥–∞–Ω—Ç–µ–ª–µ–π —Å—Ç–æ—è", "biceps_dumbbell"),    # ‚Üê —É–Ω–∏–∫–∞–ª—å–Ω–∞—è
    ("–º–æ–ª–æ—Ç–∫–∏ —Å –≥–∞–Ω—Ç–µ–ª—è–º–∏", "hammer"),
    ("–º–æ–ª–æ—Ç–∫–∏", "hammer"),
    ("—Å–≥–∏–±–∞–Ω–∏", "biceps"),

    # –¢—Ä–∏—Ü–µ–ø—Å ‚Äî —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –ø–µ—Ä–µ–¥ "—Ä–∞–∑–≥–∏–±–∞–Ω–∏"
    ("—Ä–∞–∑–≥–∏–±–∞–Ω–∏–µ –≥–∞–Ω—Ç–µ–ª–∏ –∏–∑-–∑–∞ –≥–æ–ª–æ–≤—ã", "triceps_oh"),
    ("—Ñ—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–π –∂–∏–º", "triceps_oh"),
    ("—Ç—Ä–∏—Ü–µ–ø—Å", "triceps"),
    ("—Ä–∞–∑–≥–∏–±–∞–Ω–∏", "triceps"),
]


def get_tech_key_for_exercise(name: str) -> Optional[str]:
    n = name.lower()
    for keyword, tech_key in EXERCISE_TECH_MAP:
        if keyword in n:
            return tech_key
    # Fallback ‚Äî –æ–±—â–∞—è —Ç–µ—Ö–Ω–∏–∫–∞ –ø–æ –≥—Ä—É–ø–ø–µ –º—ã—à—Ü
    if any(x in n for x in ["–Ω–æ–≥", "—è–≥–æ–¥–∏—Ü", "–∏–∫—Ä", "–±–µ–¥—Ä", "–ø—Ä–∏—Å–µ–¥–∞", "–ø—Ä–∏—Å–µ–¥–∞–Ω–∏", "–≤—ã–ø–∞–¥"]):
        return "squat"
    if any(x in n for x in ["–≥—Ä—É–¥—å", "–≥—Ä—É–¥–Ω", "–∂–∏–º"]):
        return "bench"
    if any(x in n for x in ["—Å–ø–∏–Ω", "—Ç—è–≥", "–±–ª–æ–∫", "–ø–æ–¥—Ç—è–≥"]):
        return "latpulldown"
    if any(x in n for x in ["–ø–ª–µ—á", "–¥–µ–ª—å—Ç", "–∂–∏–º –≤–≤–µ—Ä—Ö"]):
        return "ohp"
    if any(x in n for x in ["–±–∏—Ü–µ–ø—Å", "—Å–≥–∏–±–∞–Ω"]):
        return "biceps"
    if any(x in n for x in ["—Ç—Ä–∏—Ü–µ–ø—Å", "—Ä–∞–∑–≥–∏–±–∞–Ω"]):
        return "triceps"
    if any(x in n for x in ["–ø—Ä–µ—Å—Å", "–ø–ª–∞–Ω–∫", "—Å–∫—Ä—É—á–∏–≤"]):
        return "core"
    if any(x in n for x in ["–ø–æ–¥—ä—ë–º –Ω–æ–≥", "–ø–æ–¥—ä—ë–º—ã –Ω–æ–≥"]):
        if "–≤–∏—Å" in n:
            return "hanging_leg_raise"
        if "—É–ø–æ—Ä" in n:
            return "elbow_leg_raise"
        return "leg_raise_lying"
    if any(x in n for x in ["—Ä—É–º—ã–Ω—Å–∫", "–º–µ—Ä—Ç–≤–∞—è", "—Å—Ç–∞–Ω–æ–≤–∞—è", "hinge", "—è–≥–æ–¥–∏—Ü"]):
        return "rdl"
    return None  # –Ω–µ—Ç –ø–æ–¥—Ö–æ–¥—è—â–µ–π —Ç–µ—Ö–Ω–∏–∫–∏ ‚Äî –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É


# =========================
# –ù–∞–∑–≤–∞–Ω–∏–µ –¥–Ω—è –ø–æ —Ç–∏–ø—É
# =========================
DAY_NAMES = {
    "FB-A": "–§—É–ª–±–∞–¥–∏ –ê",
    "FB-B": "–§—É–ª–±–∞–¥–∏ –ë",
    "FB-C": "–§—É–ª–±–∞–¥–∏ –í",
    "UPPER": "–í–µ—Ä—Ö —Ç–µ–ª–∞",
    "LOWER": "–ù–∏–∑ —Ç–µ–ª–∞",
    "PUSH": "–ì—Ä—É–¥—å –∏ –ü–ª–µ—á–∏",
    "PULL": "–°–ø–∏–Ω–∞ –∏ –ë–∏—Ü–µ–ø—Å",
    "LEGS": "–ù–æ–≥–∏",
}


def get_day_kind_from_text(day_text: str) -> str:
    """–ò–∑–≤–ª–µ–∫–∞–µ–º —Ç–∏–ø –¥–Ω—è –∏–∑ —Ç–µ–∫—Å—Ç–∞ –ø–ª–∞–Ω–∞."""
    t = day_text.lower()
    if "—Ñ—É–ª–±–∞–¥–∏" in t or "fullbody" in t:
        return "FB"
    if "–≤–µ—Ä—Ö" in t and "—Ç–µ–ª–∞" in t:
        return "UPPER"
    if "–Ω–∏–∑" in t or "–Ω–æ–≥–∏" in t:
        return "LOWER"
    if "—Ç–æ–ª—á–æ–∫" in t or "push" in t:
        return "PUSH"
    if "—Ç—è–≥–∞" in t or "pull" in t:
        return "PULL"
    return "FB"


def get_day_display_name(day_num: int, day_text: str, system: str = "") -> str:
    """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–Ω—è—Ç–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –¥–Ω—è —Å —É—á—ë—Ç–æ–º —Å–∏—Å—Ç–µ–º—ã –∏ –Ω–æ–º–µ—Ä–∞."""
    t = day_text.lower()
    # Full Body ‚Äî A/B/C
    if "—Ñ—É–ª–±–∞–¥–∏" in t or "fullbody" in t:
        suffix = {1: "A", 2: "B", 3: "C"}.get(day_num, str(day_num))
        return f"Full Body {suffix}"
    # –í–µ—Ä—Ö/–ù–∏–∑ ‚Äî –±–µ–∑ "—Ç–µ–ª–∞"
    if "–≤–µ—Ä—Ö" in t and "—Ç–µ–ª–∞" in t:
        return "–í–µ—Ä—Ö"
    if "–Ω–∏–∑" in t:
        return "–ù–∏–∑"
    # PPL ‚Äî —Å –≥—Ä—É–ø–ø–∞–º–∏ –º—ã—à—Ü
    if "—Ç–æ–ª—á–æ–∫" in t or "push" in t:
        return "–ì—Ä—É–¥—å –∏ –ü–ª–µ—á–∏"
    if ("—Ç—è–≥–∞" in t or "pull" in t) and ("—Å–ø–∏–Ω–∞" in t or "–±–∏—Ü–µ–ø—Å" in t or "pull" in t):
        return "–°–ø–∏–Ω–∞ –∏ –ë–∏—Ü–µ–ø—Å"
    if "–Ω–æ–≥–∏" in t and "—Ç—è–≥–∞" not in t:
        return "–ù–æ–≥–∏"
    return f"–î–µ–Ω—å {day_num}"


def parse_exercises_from_day_text(day_text: str) -> List[str]:
    """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –Ω–∞–∑–≤–∞–Ω–∏–π —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π (–±–µ–∑ –ø–æ–¥—Ö–æ–¥–æ–≤/–ø–æ–≤—Ç–æ—Ä–æ–≤)."""
    exercises = []
    for line in day_text.splitlines():
        stripped = line.strip()
        if stripped.startswith("‚Ä¢"):
            content = stripped.lstrip("‚Ä¢").strip()
            if " ‚Äî " in content:
                name = content.split(" ‚Äî ")[0].strip()
            else:
                name = content
            if name:
                exercises.append(name)
    return exercises


def parse_exercises_full(day_text: str) -> List[Tuple[str, str]]:
    """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ (–Ω–∞–∑–≤–∞–Ω–∏–µ, '–ø–æ–¥—Ö–æ–¥—ã√ó–ø–æ–≤—Ç–æ—Ä—ã') –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è."""
    exercises = []
    for line in day_text.splitlines():
        stripped = line.strip()
        if stripped.startswith("‚Ä¢"):
            content = stripped.lstrip("‚Ä¢").strip()
            if " ‚Äî " in content:
                parts = content.split(" ‚Äî ", 1)
                name = parts[0].strip()
                sets_reps = parts[1].strip()
            else:
                name = content
                sets_reps = ""
            if name:
                exercises.append((name, sets_reps))
    return exercises


async def get_day_done_exercises(user_id: int, day_num: int) -> List[int]:
    async with db() as conn:
        async with conn.execute(
            "SELECT done_exercises FROM workout_day_progress WHERE user_id=? AND day_num=?",
            (user_id, day_num)
        ) as cur:
            row = await cur.fetchone()
    if not row or not row[0]:
        return []
    try:
        return json.loads(row[0])
    except Exception:
        return []


async def set_day_done_exercises(user_id: int, day_num: int, done: List[int]):
    async with db() as conn:
        await conn.execute("""
            INSERT INTO workout_day_progress (user_id, day_num, done_exercises)
            VALUES (?, ?, ?)
            ON CONFLICT(user_id, day_num) DO UPDATE SET done_exercises=excluded.done_exercises
        """, (user_id, day_num, json.dumps(done)))
        await conn.commit()


async def clear_day_progress(user_id: int, day_num: int):
    async with db() as conn:
        await conn.execute(
            "DELETE FROM workout_day_progress WHERE user_id=? AND day_num=?",
            (user_id, day_num)
        )
        await conn.commit()


async def mark_day_completed(user_id: int, day_num: int, day_title: str = ""):
    today = datetime.now().strftime("%Y-%m-%d")
    now = datetime.utcnow().isoformat()
    async with db() as conn:
        # –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª–µ day_title –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç (–º–∏–≥—Ä–∞—Ü–∏—è)
        try:
            await conn.execute("ALTER TABLE workout_completions ADD COLUMN day_title TEXT DEFAULT ''")
        except Exception:
            pass
        await conn.execute("""
            INSERT INTO workout_completions (user_id, day_num, completed_date, created_at, day_title)
            VALUES (?, ?, ?, ?, ?)
        """, (user_id, day_num, today, now, day_title))
        await conn.commit()


async def is_day_completed_today(user_id: int, day_num: int) -> bool:
    today = datetime.now().strftime("%Y-%m-%d")
    async with db() as conn:
        async with conn.execute("""
            SELECT COUNT(*) FROM workout_completions
            WHERE user_id=? AND day_num=? AND completed_date=?
        """, (user_id, day_num, today)) as cur:
            row = await cur.fetchone()
    return bool(row and row[0] > 0)


# =========================
# ‚úÖ –ü–†–û–ì–†–ï–°–°-–ë–ê–† –î–õ–Ø –¢–†–ï–ù–ò–†–û–í–û–ß–ù–û–ì–û –î–ù–Ø
# =========================
def workout_progress_bar(done: int, total: int, width: int = 10) -> str:
    """–í–∏–∑—É–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–≥–æ –¥–Ω—è."""
    if total == 0:
        return "‚ñ°‚ñ°‚ñ°‚ñ°‚ñ°‚ñ°‚ñ°‚ñ°‚ñ°‚ñ° 0%"
    pct = int(round(done / total * 100))
    filled = int(round(done / total * width))
    filled = max(0, min(filled, width))
    bar = "‚ñ†" * filled + "‚ñ°" * (width - filled)
    return f"{bar} {pct}%"


def build_day_display_text(day_num: int, day_text: str, exercises: List[str],
                            done: List[int], all_done: bool = False) -> str:
    """–°—Ç—Ä–æ–∏—Ç —Ç–µ–∫—Å—Ç –¥–Ω—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ —Å –∑–∞–≥–æ–ª–æ–≤–∫–æ–º —Ç–∏–ø–∞ –¥–Ω—è."""
    total = len(exercises)
    done_count = len(done)

    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø –¥–Ω—è –∏–∑ —Ç–µ–∫—Å—Ç–∞ –ø–ª–∞–Ω–∞
    t = day_text.lower()
    # –í–µ—Ä—Ö —Ç–µ–ª–∞ (–≤–∫–ª—é—á–∞—è –ê/–ë –≤–∞—Ä–∏–∞–Ω—Ç—ã –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)
    if "–≤–µ—Ä—Ö —Ç–µ–ª–∞" in t or "–≤–µ—Ä—Ö –∞" in t or "–≤–µ—Ä—Ö –±" in t or (
            "–≤–µ—Ä—Ö" in t and ("–≤–∞—Ä–∏–∞–Ω—Ç –∞" in t or "–≤–∞—Ä–∏–∞–Ω—Ç –±" in t)):
        day_type = "–í–µ—Ä—Ö"
        day_note = ""
    elif ("–Ω–∏–∑ —Ç–µ–ª–∞" in t or ("–Ω–∏–∂" in t and "—Ç–µ–ª" in t) or
          "–Ω–∏–∑ –∞" in t or "–Ω–∏–∑ –±" in t or
          ("–Ω–∏–∑" in t and ("–≤–∞—Ä–∏–∞–Ω—Ç –∞" in t or "–≤–∞—Ä–∏–∞–Ω—Ç –±" in t))):
        day_type = "–ù–∏–∑"
        day_note = ""
    elif "—Ç–æ–ª—á–æ–∫" in t or ("–≥—Ä—É–¥—å –∏ –ø–ª–µ—á" in t):
        day_type = "–ì—Ä—É–¥—å –∏ –ü–ª–µ—á–∏"
        day_note = "–ì—Ä—É–¥—å, –¥–µ–ª—å—Ç—ã, —Ç—Ä–∏—Ü–µ–ø—Å"
    elif ("—Ç—è–≥–∞" in t and "—Å–ø–∏–Ω–∞" in t) or ("—Å–ø–∏–Ω–∞ –∏ –±–∏—Ü–µ–ø—Å" in t):
        day_type = "–°–ø–∏–Ω–∞ –∏ –ë–∏—Ü–µ–ø—Å"
        day_note = "–®–∏—Ä–æ—á–∞–π—à–∏–µ, —Ä–æ–º–±–æ–≤–∏–¥–Ω—ã–µ, –±–∏—Ü–µ–ø—Å"
    elif "–Ω–æ–≥–∏" in t and "–∫–≤–∞–¥—Ä–∏—Ü–µ–ø—Å" in t:
        day_type = "–ù–æ–≥–∏"
        day_note = "–ö–≤–∞–¥—Ä–∏—Ü–µ–ø—Å, –±–∏—Ü–µ–ø—Å –±–µ–¥—Ä–∞, —è–≥–æ–¥–∏—Ü—ã, –∏–∫—Ä—ã"
    elif "—Ñ—É–ª–±–∞–¥–∏" in t or "fullbody" in t:
        # Full Body ‚Äî A/B/C
        suffix_map = {1: "A", 2: "B", 3: "C"}
        s = suffix_map.get(day_num, str(day_num))
        day_type = f"Full Body {s}"
        day_note = ""
    else:
        day_type = get_day_display_name(day_num, day_text) or "–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞"
        day_note = ""

    lines = []
    # –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–æ–≥–æ: üèãÔ∏è –î–µ–Ω—å N: —Ñ–æ–∫—É—Å
    lines.append(f"üèãÔ∏è –î–µ–Ω—å {day_num}: {day_type}")
    if day_note:
        lines.append(f"üìå {day_note}")
    lines.append("")
    lines.append("‚ö†Ô∏è –ü–µ—Ä–µ–¥ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–æ–π —Ä–∞–∑–æ–º–Ω–∏—Å—å 5‚Äì10 –º–∏–Ω—É—Ç")
    lines.append("‚è± –û—Ç–¥—ã—Ö –º–µ–∂–¥—É –ø–æ–¥—Ö–æ–¥–∞–º–∏: ~1.5‚Äì2 –º–∏–Ω | üìö –ö–Ω–æ–ø–∫–∞ ¬´–¢–µ—Ö–Ω–∏–∫–∞¬ª –ø–æ–¥ –∫–∞–∂–¥—ã–º —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ–º")
    lines.append("")

    ex_full = parse_exercises_full(day_text)
    for idx, (name, sets_reps) in enumerate(ex_full):
        is_done = idx in done
        mark = "‚úÖ" if is_done else "üî∏"
        if sets_reps:
            lines.append(f"{mark} {name} {sets_reps}")
        else:
            lines.append(f"{mark} {name}")

    lines.append("")
    lines.append("üèÅ –ü–æ—Å–ª–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ ‚Äî –∑–∞–º–∏–Ω–∫–∞ –∏ —Ä–∞—Å—Ç—è–∂–∫–∞ 5‚Äì10 –º–∏–Ω—É—Ç")
    lines.append("")

    bar = workout_progress_bar(done_count, total)
    if all_done:
        lines.append(f"{bar}")
        lines.append(f"‚úÖ {done_count}/{total} —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π –≤—ã–ø–æ–ª–Ω–µ–Ω–æ")
        lines.append("")
        lines.append("üéâ –û–¢–õ–ò–ß–ù–û! –î–µ–Ω—å –∑–∞—Å—á–∏—Ç–∞–Ω!")
    else:
        lines.append(f"{bar}")
        lines.append(f"‚úÖ {done_count}/{total} —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π –≤—ã–ø–æ–ª–Ω–µ–Ω–æ")

    return "\n".join(lines)


# =========================
# –¢–†–ï–ù–ò–†–û–í–ö–ò: –≥–µ–Ω–µ—Ä–∞—Ü–∏—è
# =========================
def _limits_tags(limits: str) -> Dict[str, bool]:
    t = (limits or "").lower()
    return {
        "knee": any(x in t for x in ["–∫–æ–ª–µ–Ω", "–∫–æ–ª–µ–Ω–æ", "–º–µ–Ω–∏—Å–∫", "—Å–≤—è–∑–∫", "–∫—Ä–µ—Å—Ç"]),
        "back": any(x in t for x in ["—Å–ø–∏–Ω", "–ø–æ—è—Å–Ω–∏—Ü", "–≥—Ä—ã–∂", "–ø—Ä–æ—Ç—Ä—É–∑", "—Å–∫–æ–ª–∏–æ–∑"]),
        "shoulder": any(x in t for x in ["–ø–ª–µ—á", "–ª–æ–ø–∞—Ç", "—Ä–æ—Ç–∞—Ç–æ—Ä", "–∏–º–ø–∏–Ω–¥–∂"]),
        "elbow": any(x in t for x in ["–ª–æ–∫—Ç", "—Ç–µ–Ω–¥–∏–Ω–∏—Ç"]),
    }


def generate_workout_plan(goal: str, place: str, exp: str, freq: int, limits: str, user_id: int = 0) -> Tuple[str, dict]:
    pl = (place or "").lower()
    is_gym = ("–∑–∞–ª" in pl) or (pl == "gym") or ("gym" in pl)
    where = "–ó–ê–õ" if is_gym else "–°–í–û–ô –í–ï–°"

    lvl = exp_level(exp)
    is_novice = (lvl == "novice")
    g = (goal or "").lower()

    is_cut = ("—Å—É—à" in g)
    is_strength = ("—Å–∏–ª" in g)
    is_endurance = ("–≤—ã–Ω–æ—Å" in g)

    tags = _limits_tags(limits)

    f = int(freq or 3)
    f = max(MIN_DAYS, min(f, MAX_DAYS))

    if is_strength:
        reps_base = "3‚Äì6"
        reps_iso = "8‚Äì12"
        base_sets = "3" if is_novice else "4‚Äì5"
        iso_sets = "2" if is_novice else "2‚Äì3"
        rir = "1‚Äì2"
    elif is_endurance:
        reps_base = "12‚Äì20"
        reps_iso = "15‚Äì25"
        base_sets = "2‚Äì3"
        iso_sets = "2‚Äì3"
        rir = "2‚Äì3"
    else:
        reps_base = "6‚Äì10" if not is_cut else "8‚Äì12"
        reps_iso = "10‚Äì15" if not is_cut else "12‚Äì20"
        base_sets = "3" if is_novice else "3‚Äì4"
        iso_sets = "2‚Äì3" if is_novice else "3"
        rir = "1‚Äì2"

    seed = (user_id or 0) + int(datetime.utcnow().strftime("%Y%m%d"))
    rnd = random.Random(seed)

    avoid_knee = ["–ø—Ä–∏—Å–µ–¥", "–∂–∏–º –Ω–æ–≥", "–≤—ã–ø–∞–¥", "–±–æ–ª–≥–∞—Ä", "—Ä–∞–∑–≥–∏–±"]
    avoid_back = ["—Ç—è–≥–∞", "—Å—Ç–∞–Ω–æ–≤", "–Ω–∞–∫–ª–æ–Ω", "—Ä—É–º—ã–Ω", "–≥—Ä–µ–±–ª"]
    avoid_shoulder = ["–∂–∏–º –≤–≤–µ—Ä—Ö", "–∂–∏–º –ª—ë–∂–∞", "–æ—Ç–∂–∏–º", "–∂–∏–º –≤ —Ç—Ä–µ–Ω–∞–∂"]
    avoid_elbow = ["—Ä–∞–∑–≥–∏–±", "—Ñ—Ä–∞–Ω—Ü—É–∑", "—Ç—Ä–∏—Ü–µ–ø—Å", "—Å–≥–∏–±–∞–Ω"]

    def avoid_keys_for_base():
        keys = []
        if tags["knee"]:
            keys += avoid_knee
        if tags["back"]:
            keys += avoid_back
        if tags["shoulder"]:
            keys += avoid_shoulder
        if tags["elbow"]:
            keys += avoid_elbow
        return keys

    def pick(pool: List[str], avoid_keys: List[str]) -> str:
        safe = [it for it in pool if not any(k in it.lower() for k in avoid_keys)]
        return rnd.choice(safe) if safe else (rnd.choice(pool) if pool else "‚Äî")

    avoid_keys = avoid_keys_for_base()

    if is_gym:
        # --- –ó–ê–õ: –ø—É–ª—ã —Å –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´–ú–ò –±–∞–∑–æ–≤—ã–º–∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è–º–∏ ---
        SQUAT = [
            "–ü—Ä–∏—Å–µ–¥ —Å–æ —à—Ç–∞–Ω–≥–æ–π",           # –ë–ê–ó–ê ‚Äî –≤—Å–µ–≥–¥–∞ –≤–∫–ª—é—á—ë–Ω
            "–ñ–∏–º –Ω–æ–≥–∞–º–∏ –≤ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–µ",
            "–ì–æ–±–ª–µ—Ç-–ø—Ä–∏—Å–µ–¥ —Å –≥–∞–Ω—Ç–µ–ª–µ–π",
            "–•–∞–∫–∫-–ø—Ä–∏—Å–µ–¥ –≤ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–µ",
            "–ü—Ä–∏—Å–µ–¥ —Å –≥–∞–Ω—Ç–µ–ª—è–º–∏ (Goblet)",
            "–ë–æ–ª–≥–∞—Ä—Å–∫–∏–µ –≤—ã–ø–∞–¥—ã —Å –≥–∞–Ω—Ç–µ–ª—è–º–∏",
            "–í—ã–ø–∞–¥—ã —Å –≥–∞–Ω—Ç–µ–ª—è–º–∏ (—Ö–æ–¥—å–±–∞)",
        ]
        HINGE = [
            "–†—É–º—ã–Ω—Å–∫–∞—è —Ç—è–≥–∞ —Å–æ —à—Ç–∞–Ω–≥–æ–π",   # –ë–ê–ó–ê
            "–°—Ç–∞–Ω–æ–≤–∞—è —Ç—è–≥–∞ (—Ç–µ—Ö–Ω–∏–∫–∞)",      # –ë–ê–ó–ê
            "–†—É–º—ã–Ω—Å–∫–∞—è —Ç—è–≥–∞ —Å –≥–∞–Ω—Ç–µ–ª—è–º–∏",
            "–Ø–≥–æ–¥–∏—á–Ω—ã–π –º–æ—Å—Ç —Å–æ —à—Ç–∞–Ω–≥–æ–π",
            "–°–≥–∏–±–∞–Ω–∏—è –Ω–æ–≥ –≤ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–µ",
            "–ì–∏–ø–µ—Ä—ç–∫—Å—Ç–µ–Ω–∑–∏—è —Å –≤–µ—Å–æ–º",
        ]
        HPUSH = [
            "–ñ–∏–º —à—Ç–∞–Ω–≥–∏ –ª—ë–∂–∞",             # –ë–ê–ó–ê ‚Äî –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
            "–ñ–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π –ª—ë–∂–∞",           # –ë–ê–ó–ê
            "–ñ–∏–º —à—Ç–∞–Ω–≥–∏ –ø–æ–¥ —É–≥–ª–æ–º (incline)",
            "–ñ–∏–º –≤ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–µ (–≥—Ä—É–¥—å)",
            "–°–≤–µ–¥–µ–Ω–∏—è –≤ –∫—Ä–æ—Å—Å–æ–≤–µ—Ä–µ (–≥—Ä—É–¥—å)",
            "–ñ–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π –ø–æ–¥ —É–≥–ª–æ–º (incline)",
            "–û—Ç–∂–∏–º–∞–Ω–∏—è —Å –≤–µ—Å–æ–º (–∂–∏–ª–µ—Ç/–±–ª–∏–Ω)",
        ]
        HPULL = [
            "–¢—è–≥–∞ —à—Ç–∞–Ω–≥–∏ –≤ –Ω–∞–∫–ª–æ–Ω–µ",       # –ë–ê–ó–ê
            "–¢—è–≥–∞ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –±–ª–æ–∫–∞",
            "–¢—è–≥–∞ –≥–∞–Ω—Ç–µ–ª–∏ –æ–¥–Ω–æ–π —Ä—É–∫–æ–π",
            "–¢—è–≥–∞ –¢-–≥—Ä–∏—Ñ–∞",
            "–¢—è–≥–∞ –≤ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–µ (–≥—Ä—É–¥—å —É–ø–æ—Ä)",
            "–¢—è–≥–∞ –Ω–∏–∂–Ω–µ–≥–æ –±–ª–æ–∫–∞ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–º —Ö–≤–∞—Ç–æ–º",
        ]
        VPULL = [
            "–ü–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è (—à–∏—Ä–æ–∫–∏–π —Ö–≤–∞—Ç)", # –ë–ê–ó–ê
            "–ü–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–º —Ö–≤–∞—Ç–æ–º",
            "–í–µ—Ä—Ö–Ω–∏–π –±–ª–æ–∫ —à–∏—Ä–æ–∫–∏–º —Ö–≤–∞—Ç–æ–º",
            "–í–µ—Ä—Ö–Ω–∏–π –±–ª–æ–∫ —É–∑–∫–∏–º —Ö–≤–∞—Ç–æ–º",
            "–¢—è–≥–∞ –≤–µ—Ä—Ö–Ω–µ–≥–æ –±–ª–æ–∫–∞ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–º —Ö–≤–∞—Ç–æ–º",
        ]
        VPUSH = [
            "–ñ–∏–º —à—Ç–∞–Ω–≥–∏ —Å—Ç–æ—è (overhead press)",  # –ë–ê–ó–ê
            "–ê—Ä–º–µ–π—Å–∫–∏–π –∂–∏–º",                      # –ë–ê–ó–ê
            "–ñ–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π —Å—Ç–æ—è/—Å–∏–¥—è",
            "–ñ–∏–º –≤ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–µ –≤–≤–µ—Ä—Ö",
        ]
        SHOULD = [
            "–†–∞–∑–≤–µ–¥–µ–Ω–∏—è –≥–∞–Ω—Ç–µ–ª–µ–π –≤ —Å—Ç–æ—Ä–æ–Ω—ã",
            "Face pull –Ω–∞ –±–ª–æ–∫–µ (–∫–∞–Ω–∞—Ç)",
            "–ó–∞–¥–Ω—è—è –¥–µ–ª—å—Ç–∞ –≤ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–µ (pec deck)",
            "–†–∞–∑–≤–µ–¥–µ–Ω–∏—è –≥–∞–Ω—Ç–µ–ª–µ–π –≤ –Ω–∞–∫–ª–æ–Ω–µ (–∑–∞–¥–Ω—è—è –¥–µ–ª—å—Ç–∞)",
            "–¢—è–≥–∞ —à—Ç–∞–Ω–≥–∏ –∫ –ø–æ–¥–±–æ—Ä–æ–¥–∫—É (—à–∏—Ä–æ–∫–∏–π —Ö–≤–∞—Ç)",
        ]
        BI = [
            "–°–≥–∏–±–∞–Ω–∏—è –≥–∞–Ω—Ç–µ–ª–µ–π —Å—Ç–æ—è",
            "–°–≥–∏–±–∞–Ω–∏—è –Ω–∞ –±–ª–æ–∫–µ (–Ω–∏–∂–Ω–∏–π)",
            "–ú–æ–ª–æ—Ç–∫–∏ —Å –≥–∞–Ω—Ç–µ–ª—è–º–∏",
            "–°–≥–∏–±–∞–Ω–∏—è –Ω–∞ —Å–∫–∞–º—å–µ –°–∫–æ—Ç—Ç–∞",
            "–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–≥–∏–±–∞–Ω–∏—è",
        ]
        TRI = [
            "–†–∞–∑–≥–∏–±–∞–Ω–∏—è –Ω–∞ –≤–µ—Ä—Ö–Ω–µ–º –±–ª–æ–∫–µ (–ø—Ä—è–º–∞—è —Ä—É–∫–æ—è—Ç—å)",
            "–†–∞–∑–≥–∏–±–∞–Ω–∏—è –Ω–∞ –±–ª–æ–∫–µ (–∫–∞–Ω–∞—Ç, –æ–¥–Ω–æ–π —Ä—É–∫–æ–π)",
            "–§—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–π –∂–∏–º –ª—ë–∂–∞ —Å –≥–∞–Ω—Ç–µ–ª—è–º–∏",
            "–û—Ç–∂–∏–º–∞–Ω–∏—è —É–∑–∫–∏–µ",
            "–†–∞–∑–≥–∏–±–∞–Ω–∏–µ –≥–∞–Ω—Ç–µ–ª–∏ –∏–∑-–∑–∞ –≥–æ–ª–æ–≤—ã",
        ]
        CALVES = [
            "–ü–æ–¥—ä—ë–º—ã –Ω–∞ –Ω–æ—Å–∫–∏ —Å—Ç–æ—è –≤ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–µ",
            "–ü–æ–¥—ä—ë–º—ã –Ω–∞ –Ω–æ—Å–∫–∏ —Å–∏–¥—è –≤ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–µ",
            "–ü–æ–¥—ä—ë–º—ã –Ω–∞ –Ω–æ—Å–∫–∏ —Å –≥–∞–Ω—Ç–µ–ª—è–º–∏ (–æ–¥–Ω–∞ –Ω–æ–≥–∞)",
        ]
        CORE = [
            "–ü–ª–∞–Ω–∫–∞ (—Å—Ç–∞—Ç–∏–∫–∞)",
            "–°–∫—Ä—É—á–∏–≤–∞–Ω–∏—è –Ω–∞ –±–ª–æ–∫–µ",
            "–ü–æ–¥—ä—ë–º—ã –Ω–æ–≥ –≤ –≤–∏—Å–µ",
            "–ü–æ–¥—ä—ë–º—ã –Ω–æ–≥ –≤ —É–ø–æ—Ä–µ –Ω–∞ –ª–æ–∫—Ç—è—Ö",
            "–†–æ–ª–∏–∫ –¥–ª—è –ø—Ä–µ—Å—Å–∞ (ab wheel)",
        ]
    else:
        # --- –î–û–ú–ê: –ø—É–ª—ã —Å –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´–ú–ò –±–∞–∑–æ–≤—ã–º–∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è–º–∏ ---
        SQUAT = [
            "–ü—Ä–∏—Å–µ–¥–∞–Ω–∏—è (—Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–µ—Å)",  # –ë–ê–ó–ê
            "–ü—Ä–∏—Å–µ–¥ —Å –ø–∞—É–∑–æ–π –≤–Ω–∏–∑—É",
            "–ü—Ä–∏—Å–µ–¥ —Å—É–º–æ",
            "–ë–æ–ª–≥–∞—Ä—Å–∫–∏–µ –≤—ã–ø–∞–¥—ã (–Ω–æ–≥–∞ –Ω–∞ —Å—Ç—É–ª–µ)",
            "–í—ã–ø–∞–¥—ã –Ω–∞ –º–µ—Å—Ç–µ",
            "–í—ã–ø–∞–¥—ã —Ö–æ–¥—å–±–æ–π",
            "–ü—Ä–∏—Å–µ–¥–∞–Ω–∏—è –Ω–∞ –æ–¥–Ω–æ–π –Ω–æ–≥–µ (–ø–∏—Å—Ç–æ–ª–µ—Ç, –æ–±–ª–µ–≥—á—ë–Ω–Ω–æ)",
        ]
        HINGE = [
            "–Ø–≥–æ–¥–∏—á–Ω—ã–π –º–æ—Å—Ç",               # –ë–ê–ó–ê
            "–Ø–≥–æ–¥–∏—á–Ω—ã–π –º–æ—Å—Ç –Ω–∞ –æ–¥–Ω–æ–π –Ω–æ–≥–µ",
            "–ì–∏–ø–µ—Ä—ç–∫—Å—Ç–µ–Ω–∑–∏—è –Ω–∞ –ø–æ–ª—É",
            "Good-morning (–±–µ–∑ –≤–µ—Å–∞, —Ç–µ—Ö–Ω–∏–∫–∞)",
            "–†—É–º—ã–Ω—Å–∫–∞—è —Ç—è–≥–∞ —Å –≥–∞–Ω—Ç–µ–ª—è–º–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å)",
        ]
        HPUSH = [
            "–û—Ç–∂–∏–º–∞–Ω–∏—è (–∫–ª–∞—Å—Å–∏–∫–∞)",          # –ë–ê–ó–ê ‚Äî –≤—Å–µ–≥–¥–∞
            "–û—Ç–∂–∏–º–∞–Ω–∏—è —Å –ø–∞—É–∑–æ–π 2 —Å–µ–∫",
            "–û—Ç–∂–∏–º–∞–Ω–∏—è —É–∑–∫–∏–µ (—Ç—Ä–∏—Ü–µ–ø—Å)",     # –ë–ê–ó–ê –¥–ª—è —Ç—Ä–∏—Ü–µ–ø—Å–∞
            "–û—Ç–∂–∏–º–∞–Ω–∏—è –æ—Ç –≤–æ–∑–≤—ã—à–µ–Ω–∏—è (–Ω–æ–≥–∏ –Ω–∞ —Å—Ç—É–ª–µ)",
            "–û—Ç–∂–∏–º–∞–Ω–∏—è —Å —Ö–ª–æ–ø–∫–æ–º (–≤–∑—Ä—ã–≤–Ω—ã–µ)",
        ]
        HPULL = [
            "–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ –ø–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è (–ø–æ–¥ —Å—Ç–æ–ª–æ–º)",  # –ë–ê–ó–ê
            "–¢—è–≥–∞ —Ä–µ–∑–∏–Ω–∫–∏ –∫ –ø–æ—è—Å—É",
            "–¢—è–≥–∞ –≥–∞–Ω—Ç–µ–ª–∏ –æ–¥–Ω–æ–π —Ä—É–∫–æ–π (–≤ –Ω–∞–∫–ª–æ–Ω–µ)",
            "–¢—è–≥–∞ —Ä–µ–∑–∏–Ω–∫–∏ –≤ –Ω–∞–∫–ª–æ–Ω–µ",
        ]
        VPULL = [
            "–ü–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è (–æ–±—Ä–∞—Ç–Ω—ã–π —Ö–≤–∞—Ç)",  # –ë–ê–ó–ê
            "–ü–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è (–ø—Ä—è–º–æ–π —Ö–≤–∞—Ç)",    # –ë–ê–ó–ê
            "–ù–µ–≥–∞—Ç–∏–≤–Ω—ã–µ –ø–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è",
            "–¢—è–≥–∞ —Ä–µ–∑–∏–Ω–∫–∏ —Å–≤–µ—Ä—Ö—É",
            "–ü–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è –Ω–∞ –ø–µ—Ç–ª—è—Ö (TRX-—Å—Ç–∏–ª—å)",
        ]
        VPUSH = [
            "–ü–∞–π–∫-–æ—Ç–∂–∏–º–∞–Ω–∏—è",               # –ë–ê–ó–ê –¥–ª—è –ø–ª–µ—á –¥–æ–º–∞
            "–ñ–∏–º —Ä–µ–∑–∏–Ω–∫–∏ –≤–≤–µ—Ä—Ö (—Å—Ç–æ—è)",
            "–û—Ç–∂–∏–º–∞–Ω–∏—è (–Ω–æ–≥–∏ –≤—ã—Å–æ–∫–æ –Ω–∞ —Å—Ç—É–ª–µ)",
        ]
        SHOULD = [
            "–†–∞–∑–≤–µ–¥–µ–Ω–∏—è –≥–∞–Ω—Ç–µ–ª–µ–π –≤ —Å—Ç–æ—Ä–æ–Ω—ã",
            "–¢—è–≥–∞ —Ä–µ–∑–∏–Ω–∫–∏ –∫ –ª–∏—Ü—É (face pull)",
            "–†–∞–∑–≤–µ–¥–µ–Ω–∏—è –≥–∞–Ω—Ç–µ–ª–µ–π –≤ –Ω–∞–∫–ª–æ–Ω–µ (–∑–∞–¥–Ω—è—è –¥–µ–ª—å—Ç–∞)",
            "–¢—è–≥–∞ —Ä–µ–∑–∏–Ω–∫–∏ –∫ –ø–æ–¥–±–æ—Ä–æ–¥–∫—É",
        ]
        BI = [
            "–°–≥–∏–±–∞–Ω–∏—è –≥–∞–Ω—Ç–µ–ª–µ–π —Å—Ç–æ—è",
            "–ú–æ–ª–æ—Ç–∫–∏ —Å –≥–∞–Ω—Ç–µ–ª—è–º–∏",
            "–°–≥–∏–±–∞–Ω–∏—è –Ω–∞ —Ä–µ–∑–∏–Ω–∫–µ",
        ]
        TRI = [
            "–û—Ç–∂–∏–º–∞–Ω–∏—è —É–∑–∫–∏–µ",
            "–†–∞–∑–≥–∏–±–∞–Ω–∏–µ –≥–∞–Ω—Ç–µ–ª–∏ –∏–∑-–∑–∞ –≥–æ–ª–æ–≤—ã",
            "–û–±—Ä–∞—Ç–Ω—ã–µ –æ—Ç–∂–∏–º–∞–Ω–∏—è –æ—Ç —Å—Ç—É–ª–∞/–ª–∞–≤–∫–∏",
        ]
        CALVES = [
            "–ü–æ–¥—ä—ë–º—ã –Ω–∞ –Ω–æ—Å–∫–∏ —Å—Ç–æ—è",
            "–ü–æ–¥—ä—ë–º—ã –Ω–∞ –Ω–æ—Å–∫–∏ –Ω–∞ –æ–¥–Ω–æ–π –Ω–æ–≥–µ",
            "–ü–æ–¥—ä—ë–º—ã –Ω–∞ –Ω–æ—Å–∫–∏ —Å –≥–∞–Ω—Ç–µ–ª—è–º–∏",
        ]
        CORE = [
            "–ü–ª–∞–Ω–∫–∞ (—Å—Ç–∞—Ç–∏–∫–∞)",
            "–ë–æ–∫–æ–≤–∞—è –ø–ª–∞–Ω–∫–∞",
            "–°–∫—Ä—É—á–∏–≤–∞–Ω–∏—è –Ω–∞ –ø–æ–ª—É",
            "–ü–æ–¥—ä—ë–º—ã –Ω–æ–≥ –ª—ë–∂–∞",
            "–í–µ–ª–æ—Å–∏–ø–µ–¥ (—Å–∫—Ä—É—á–∏–≤–∞–Ω–∏—è —Å –ø–æ–≤–æ—Ä–æ—Ç–æ–º)",
            "–û–±—Ä–∞—Ç–Ω—ã–µ —Å–∫—Ä—É—á–∏–≤–∞–Ω–∏—è",
        ]

    if tags["elbow"]:
        TRI = [x for x in TRI if "—Ñ—Ä–∞–Ω—Ü—É–∑" not in x.lower()]
    if tags["knee"]:
        SQUAT = [x for x in SQUAT if "–≤—ã–ø–∞–¥" not in x.lower() and "–±–æ–ª–≥–∞—Ä" not in x.lower()]
    if tags["back"]:
        HINGE = [x for x in HINGE if "—Ä—É–º—ã–Ω" not in x.lower()]

    if f == 3:
        system = "–§—É–ª–±–∞–¥–∏"
        template = ["FB-A", "FB-B", "FB-C"]
    elif f == 4:
        system = "–í–µ—Ä—Ö/–ù–∏–∑"
        # –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —á–µ—Ä–µ–¥–æ–≤–∞–Ω–∏–µ: –Ω–µ—á—ë—Ç–Ω—ã–π ‚Üí –í–µ—Ä—Ö, —á—ë—Ç–Ω—ã–π ‚Üí –ù–∏–∑
        template = ["UPPER", "LOWER", "UPPER", "LOWER"]
    else:
        system = "PPL + –í–µ—Ä—Ö/–ù–∏–∑"
        template = ["PUSH", "PULL", "LEGS", "UPPER", "LOWER"]

    def fmt(name: str, sets: str, reps: str) -> str:
        return f"{name} ‚Äî {sets}√ó{reps}"

    def day_block(kind: str) -> List[str]:
        lines = [f"RIR: {rir}", ""]
        if kind.startswith("FB"):
            squat = pick(SQUAT, avoid_keys)
            hinge = pick(HINGE, avoid_keys)
            hpush = pick(HPUSH, avoid_keys)
            hpull = pick(HPULL, avoid_keys)
            should = pick(SHOULD, avoid_keys)
            arms = pick(BI if rnd.random() < 0.5 else TRI, avoid_keys)

            lines.append("–ë–∞–∑–∞:")
            lines.append(f"‚Ä¢ {fmt(squat, base_sets, reps_base)}")
            lines.append(f"‚Ä¢ {fmt(hpush, base_sets, reps_base)}")
            lines.append(f"‚Ä¢ {fmt(hpull, base_sets, reps_base)}")
            lines.append(f"‚Ä¢ {fmt(hinge, base_sets, reps_base)}")
            lines.append("")
            lines.append("–ò–∑–æ–ª—è—Ü–∏—è:")
            lines.append(f"‚Ä¢ {fmt(should, iso_sets, reps_iso)}")
            lines.append(f"‚Ä¢ {fmt(arms, iso_sets, reps_iso)}")
            if not is_novice:
                lines.append(f"‚Ä¢ {fmt(pick(CORE, avoid_keys), '2', '30‚Äì60 —Å–µ–∫')}")
            return lines

        if kind == "UPPER":
            # –í–µ—Ä—Ö ‚Äî –§–ò–ö–°–ò–†–û–í–ê–ù–ù–´–ô —à–∞–±–ª–æ–Ω (—á–µ—Ä–µ–¥–æ–≤–∞–Ω–∏–µ –≤–µ—Ä—Ö-–Ω–∏–∑)
            upper_gym = [
                ("–ñ–∏–º —à—Ç–∞–Ω–≥–∏ –ª—ë–∂–∞", base_sets, reps_base),
                ("–í–µ—Ä—Ö–Ω–∏–π –±–ª–æ–∫ —à–∏—Ä–æ–∫–∏–º —Ö–≤–∞—Ç–æ–º", base_sets, reps_base),
                ("–ñ–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π —Å—Ç–æ—è/—Å–∏–¥—è", iso_sets, reps_iso),
                ("–¢—è–≥–∞ —à—Ç–∞–Ω–≥–∏ –≤ –Ω–∞–∫–ª–æ–Ω–µ", base_sets, reps_base),
                ("–°–≥–∏–±–∞–Ω–∏—è –≥–∞–Ω—Ç–µ–ª–µ–π —Å—Ç–æ—è", iso_sets, reps_iso),
                ("–†–∞–∑–≥–∏–±–∞–Ω–∏—è –Ω–∞ –≤–µ—Ä—Ö–Ω–µ–º –±–ª–æ–∫–µ (–ø—Ä—è–º–∞—è —Ä—É–∫–æ—è—Ç—å)", iso_sets, reps_iso),
            ]
            upper_home = [
                ("–û—Ç–∂–∏–º–∞–Ω–∏—è (–∫–ª–∞—Å—Å–∏–∫–∞)", base_sets, reps_base),
                ("–ü–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è (–ø—Ä—è–º–æ–π —Ö–≤–∞—Ç)", base_sets, reps_base),
                ("–ü–∞–π–∫-–æ—Ç–∂–∏–º–∞–Ω–∏—è", iso_sets, reps_iso),
                ("–¢—è–≥–∞ –≥–∞–Ω—Ç–µ–ª–∏ –æ–¥–Ω–æ–π —Ä—É–∫–æ–π (–≤ –Ω–∞–∫–ª–æ–Ω–µ)", base_sets, reps_base),
                ("–°–≥–∏–±–∞–Ω–∏—è –≥–∞–Ω—Ç–µ–ª–µ–π —Å—Ç–æ—è", iso_sets, reps_iso),
                ("–û—Ç–∂–∏–º–∞–Ω–∏—è —É–∑–∫–∏–µ (—Ç—Ä–∏—Ü–µ–ø—Å)", iso_sets, reps_iso),
            ]
            items = upper_gym if is_gym else upper_home
            lines.append("–ë–∞–∑–∞:")
            for name, s, r in items[:4]:
                if tags["shoulder"] and any(x in name.lower() for x in ["–∂–∏–º —Å—Ç–æ—è", "–ø–∞–π–∫", "–∞—Ä–º–µ–π—Å–∫–∏–π"]):
                    continue
                lines.append(f"‚Ä¢ {fmt(name, s, r)}")
            lines.append("")
            lines.append("–ò–∑–æ–ª—è—Ü–∏—è:")
            for name, s, r in items[4:]:
                if tags["elbow"] and "—Ä–∞–∑–≥–∏–±–∞–Ω" in name.lower():
                    continue
                lines.append(f"‚Ä¢ {fmt(name, s, r)}")
            return lines

        if kind == "LOWER":
            # –ù–∏–∑ ‚Äî –§–ò–ö–°–ò–†–û–í–ê–ù–ù–´–ô —à–∞–±–ª–æ–Ω (—á–µ—Ä–µ–¥–æ–≤–∞–Ω–∏–µ –≤–µ—Ä—Ö-–Ω–∏–∑)
            lower_gym = [
                ("–ü—Ä–∏—Å–µ–¥ —Å–æ —à—Ç–∞–Ω–≥–æ–π", base_sets, reps_base),
                ("–†—É–º—ã–Ω—Å–∫–∞—è —Ç—è–≥–∞ —Å–æ —à—Ç–∞–Ω–≥–æ–π", base_sets, reps_base),
                ("–ñ–∏–º –Ω–æ–≥–∞–º–∏ –≤ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–µ", base_sets, reps_base),
                ("–°–≥–∏–±–∞–Ω–∏—è –Ω–æ–≥ –≤ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–µ", iso_sets, reps_iso),
                ("–ü–æ–¥—ä—ë–º—ã –Ω–∞ –Ω–æ—Å–∫–∏ —Å—Ç–æ—è –≤ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–µ", iso_sets, "15‚Äì20"),
                ("–ü–ª–∞–Ω–∫–∞ (—Å—Ç–∞—Ç–∏–∫–∞)", "2", "40‚Äì60 —Å–µ–∫"),
            ]
            lower_home = [
                ("–ü—Ä–∏—Å–µ–¥–∞–Ω–∏—è (—Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–µ—Å)", base_sets, reps_base),
                ("–†—É–º—ã–Ω—Å–∫–∞—è —Ç—è–≥–∞ —Å –≥–∞–Ω—Ç–µ–ª—è–º–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å)", base_sets, reps_base),
                ("–ë–æ–ª–≥–∞—Ä—Å–∫–∏–µ –≤—ã–ø–∞–¥—ã (–Ω–æ–≥–∞ –Ω–∞ —Å—Ç—É–ª–µ)", base_sets, reps_base),
                ("–Ø–≥–æ–¥–∏—á–Ω—ã–π –º–æ—Å—Ç", iso_sets, reps_iso),
                ("–ü–æ–¥—ä—ë–º—ã –Ω–∞ –Ω–æ—Å–∫–∏ —Å—Ç–æ—è", iso_sets, "15‚Äì20"),
                ("–ü–ª–∞–Ω–∫–∞ (—Å—Ç–∞—Ç–∏–∫–∞)", "2", "40‚Äì60 —Å–µ–∫"),
            ]
            items = lower_gym if is_gym else lower_home
            lines.append("–ë–∞–∑–∞:")
            for name, s, r in items[:3]:
                if tags["knee"] and any(x in name.lower() for x in avoid_knee):
                    continue
                if tags["back"] and any(x in name.lower() for x in avoid_back):
                    continue
                lines.append(f"‚Ä¢ {fmt(name, s, r)}")
            lines.append("")
            lines.append("–ò–∑–æ–ª—è—Ü–∏—è:")
            for name, s, r in items[3:]:
                if tags["knee"] and any(x in name.lower() for x in avoid_knee):
                    continue
                lines.append(f"‚Ä¢ {fmt(name, s, r)}")
            return lines

        if kind == "PUSH":
            hpush = pick(HPUSH, avoid_keys)
            vpush = pick(VPUSH, avoid_keys)
            should = pick(SHOULD, avoid_keys)
            tri = pick(TRI, avoid_keys)

            lines.append("–ë–∞–∑–∞:")
            lines.append(f"‚Ä¢ {fmt(hpush, base_sets, reps_base)}")
            if not tags["shoulder"]:
                lines.append(f"‚Ä¢ {fmt(vpush, base_sets, reps_base)}")
            lines.append("")
            lines.append("–ò–∑–æ–ª—è—Ü–∏—è:")
            lines.append(f"‚Ä¢ {fmt(should, iso_sets, reps_iso)}")
            lines.append(f"‚Ä¢ {fmt(tri, iso_sets, reps_iso)}")
            return lines

        if kind == "PULL":
            vpull = pick(VPULL, avoid_keys)
            hpull = pick(HPULL, avoid_keys)
            bi = pick(BI, avoid_keys)
            rear = pick(SHOULD, avoid_keys)

            lines.append("–ë–∞–∑–∞:")
            lines.append(f"‚Ä¢ {fmt(vpull, base_sets, reps_base)}")
            lines.append(f"‚Ä¢ {fmt(hpull, base_sets, reps_base)}")
            lines.append("")
            lines.append("–ò–∑–æ–ª—è—Ü–∏—è:")
            lines.append(f"‚Ä¢ {fmt(rear, iso_sets, reps_iso)}")
            lines.append(f"‚Ä¢ {fmt(bi, iso_sets, reps_iso)}")
            return lines

        if kind == "LEGS":
            squat = pick(SQUAT, avoid_keys)
            hinge = pick(HINGE, avoid_keys)
            calves = pick(CALVES, avoid_keys)

            lines.append("–ë–∞–∑–∞:")
            lines.append(f"‚Ä¢ {fmt(squat, base_sets, reps_base)}")
            lines.append(f"‚Ä¢ {fmt(hinge, base_sets, reps_base)}")
            lines.append("")
            lines.append("–ò–∑–æ–ª—è—Ü–∏—è:")
            lines.append(f"‚Ä¢ {fmt(calves, iso_sets, reps_iso)}")
            return lines

        return ["‚Äî"]

    limits_line = (limits or "").strip() or "–Ω–µ—Ç"

    intro = (
        f"üèãÔ∏è –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ ({where})\n"
        f"–°–∏—Å—Ç–µ–º–∞: {system}\n"
        f"–ß–∞—Å—Ç–æ—Ç–∞: {f}√ó/–Ω–µ–¥ ‚Ä¢ {weekday_schedule(f)}\n"
        f"–¶–µ–ª—å: {goal} ‚Ä¢ –£—Ä–æ–≤–µ–Ω—å: {'–Ω–æ–≤–∏—á–æ–∫' if is_novice else '—Å—Ä–µ–¥–Ω–∏–π+'}\n"
        f"–û–≥—Ä.: {limits_line}\n\n"
        f"–ü—Ä–∞–≤–∏–ª–æ: —Ç–µ—Ö–Ω–∏–∫–∞ > –≤–µ—Å ‚Ä¢ RIR {rir}\n"
        "–í—ã–±–µ—Ä–∏ –¥–µ–Ω—å –∫–Ω–æ–ø–∫–æ–π üëá"
    )

    # –û–ø–∏—Å–∞–Ω–∏—è —Å–∏—Å—Ç–µ–º –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
    KIND_TITLES = {
        "FB-A": ("–§—É–ª–±–∞–¥–∏ –ê", "–í—Å—ë —Ç–µ–ª–æ: –∞–∫—Ü–µ–Ω—Ç –Ω–∞ –Ω–æ–≥–∏ –∏ —Ç–æ–ª—á–æ–∫"),
        "FB-B": ("–§—É–ª–±–∞–¥–∏ –ë", "–í—Å—ë —Ç–µ–ª–æ: –∞–∫—Ü–µ–Ω—Ç –Ω–∞ —Å–ø–∏–Ω—É –∏ —Ç—è–≥—É"),
        "FB-C": ("–§—É–ª–±–∞–¥–∏ –í", "–í—Å—ë —Ç–µ–ª–æ: –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –¥–µ–Ω—å"),
        "UPPER": ("–í–µ—Ä—Ö —Ç–µ–ª–∞", "–ì—Ä—É–¥—å, —Å–ø–∏–Ω–∞, –ø–ª–µ—á–∏, —Ä—É–∫–∏"),
        "LOWER": ("–ù–∏–∑ —Ç–µ–ª–∞", "–ö–≤–∞–¥—Ä–∏—Ü–µ–ø—Å, –±–∏—Ü–µ–ø—Å –±–µ–¥—Ä–∞, —è–≥–æ–¥–∏—Ü—ã, –∏–∫—Ä—ã"),
        "PUSH": ("–¢–æ–ª—á–æ–∫ ‚Äî –ì—Ä—É–¥—å –∏ –ü–ª–µ—á–∏", "–ì—Ä—É–¥—å, –ø–µ—Ä–µ–¥–Ω–∏–µ/—Å—Ä–µ–¥–Ω–∏–µ –¥–µ–ª—å—Ç—ã, —Ç—Ä–∏—Ü–µ–ø—Å"),
        "PULL": ("–¢—è–≥–∞ ‚Äî –°–ø–∏–Ω–∞ –∏ –ë–∏—Ü–µ–ø—Å", "–®–∏—Ä–æ—á–∞–π—à–∏–µ, —Ä–æ–º–±–æ–≤–∏–¥–Ω—ã–µ, –±–∏—Ü–µ–ø—Å, –∑–∞–¥–Ω—è—è –¥–µ–ª—å—Ç–∞"),
        "LEGS": ("–ù–æ–≥–∏", "–ö–≤–∞–¥—Ä–∏—Ü–µ–ø—Å, –±–∏—Ü–µ–ø—Å –±–µ–¥—Ä–∞, —è–≥–æ–¥–∏—Ü—ã, –∏–∫—Ä—ã"),
    }

    UPPER_LOWER_SCHEDULE = {
        1: "–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫",
        2: "–í—Ç–æ—Ä–Ω–∏–∫",
        3: "–ß–µ—Ç–≤–µ—Ä–≥",
        4: "–ü—è—Ç–Ω–∏—Ü–∞",
    }

    PPL_SCHEDULE = {
        1: "–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫",
        2: "–í—Ç–æ—Ä–Ω–∏–∫",
        3: "–°—Ä–µ–¥–∞",
        4: "–ü—è—Ç–Ω–∏—Ü–∞",
        5: "–°—É–±–±–æ—Ç–∞",
    }

    days: Dict[str, str] = {}
    for d in range(1, f + 1):
        kind = template[d - 1]
        kind_title, kind_desc = KIND_TITLES.get(kind, (system, ""))

        if system == "–í–µ—Ä—Ö/–ù–∏–∑":
            day_sched = UPPER_LOWER_SCHEDULE.get(d, f"–î–µ–Ω—å {d}")
            header = (
                f"–î–µ–Ω—å {d} ‚Äî {kind_title}\n"
                f"üìÖ {day_sched}\n"
                f"üí° {kind_desc}\n"
                f"‚è± ~50‚Äì70 –º–∏–Ω\n\n"
            )
        elif system.startswith("PPL"):
            day_sched = PPL_SCHEDULE.get(d, f"–î–µ–Ω—å {d}")
            header = (
                f"–î–µ–Ω—å {d} ‚Äî {kind_title}\n"
                f"üìÖ {day_sched}\n"
                f"üí° {kind_desc}\n"
                f"‚è± ~50‚Äì70 –º–∏–Ω\n\n"
            )
        else:
            header = (
                f"–î–µ–Ω—å {d} ‚Äî {kind_title}\n"
                f"üí° {kind_desc}\n"
                f"‚è± ~45‚Äì60 –º–∏–Ω\n\n"
            )

        body = "\n".join(day_block(kind))
        days[str(d)] = header + body

    plan_struct = {
        "system": system,
        "where": where,
        "freq": f,
        "schedule": weekday_schedule(f),
        "rir": rir,
        "days": days,
        "updated_at": datetime.utcnow().isoformat(),
    }
    return intro, plan_struct


# =========================
# ‚úÖ –ü–ò–¢–ê–ù–ò–ï
# =========================

FOOD_DB = {
    "oats":      {"name": "–û–≤—Å—è–Ω–∫–∞ (—Å—É—Ö–∞—è)",              "kcal": 352, "p": 12.0, "f": 6.2,   "c": 60.0},
    "rice":      {"name": "–†–∏—Å (—Å—É—Ö–æ–π)",                  "kcal": 344, "p": 6.7,  "f": 0.7,   "c": 76.0},
    "buckwheat": {"name": "–ì—Ä–µ—á–∫–∞ (—Å—É—Ö–∞—è)",               "kcal": 313, "p": 12.6, "f": 3.3,   "c": 57.0},
    "pasta":     {"name": "–ú–∞–∫–∞—Ä–æ–Ω—ã (—Å—É—Ö–∏–µ)",             "kcal": 350, "p": 10.4, "f": 1.1,   "c": 73.0},
    "potato":    {"name": "–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å",                    "kcal": 80,  "p": 2.0,  "f": 0.1,   "c": 17.0},
    "bread_rye": {"name": "–•–ª–µ–± —Ä–∂–∞–Ω–æ–π",                  "kcal": 210, "p": 6.6,  "f": 1.2,   "c": 41.0},
    "veg":       {"name": "–û–≤–æ—â–∏ (–æ–≥—É—Ä–µ—Ü/–ø–æ–º–∏–¥–æ—Ä/–∫–∞–ø—É—Å—Ç–∞)", "kcal": 25,  "p": 1.2,  "f": 0.2,   "c": 4.5},
    "chicken":   {"name": "–ö—É—Ä–∏–Ω–∞—è –≥—Ä—É–¥–∫–∞ (–≤–∞—Ä—ë–Ω–∞—è)",     "kcal": 165, "p": 31.0, "f": 3.6,   "c": 0.0},
    "turkey":    {"name": "–ò–Ω–¥–µ–π–∫–∞ (—Ñ–∏–ª–µ, –≤–∞—Ä—ë–Ω–æ–µ)",      "kcal": 158, "p": 29.0, "f": 4.0,   "c": 0.0},
    "fish":      {"name": "–†—ã–±–∞ –±–µ–ª–∞—è (—Ç—Ä–µ—Å–∫–∞/–º–∏–Ω—Ç–∞–π)",   "kcal": 82,  "p": 18.0, "f": 0.7,   "c": 0.0},
    "salmon":    {"name": "–õ–æ—Å–æ—Å—å",                       "kcal": 208, "p": 20.0, "f": 13.0,  "c": 0.0},
    "beef":      {"name": "–ì–æ–≤—è–¥–∏–Ω–∞ (–≤–∞—Ä—ë–Ω–∞—è)",           "kcal": 218, "p": 25.0, "f": 12.5,  "c": 0.0},
    "eggs":      {"name": "–Ø–π—Ü–∞",                         "kcal": 157, "p": 12.7, "f": 11.5,  "c": 0.7},
    "egg_white": {"name": "–ë–µ–ª–æ–∫ —è–∏—á–Ω—ã–π",                 "kcal": 44,  "p": 11.0, "f": 0.0,   "c": 0.0},
    "curd_0":    {"name": "–¢–≤–æ—Ä–æ–≥ 0%",                    "kcal": 71,  "p": 18.0, "f": 0.6,   "c": 1.8},
    "curd_5":    {"name": "–¢–≤–æ—Ä–æ–≥ 5%",                    "kcal": 121, "p": 17.0, "f": 5.0,   "c": 1.8},
    "greek_yog": {"name": "–ô–æ–≥—É—Ä—Ç –≥—Ä–µ—á–µ—Å–∫–∏–π 2%",          "kcal": 66,  "p": 5.0,  "f": 2.0,   "c": 6.5},
    "milk":      {"name": "–ú–æ–ª–æ–∫–æ 2.5%",                  "kcal": 54,  "p": 2.8,  "f": 2.5,   "c": 4.7},
    "oil_olive": {"name": "–ú–∞—Å–ª–æ –æ–ª–∏–≤–∫–æ–≤–æ–µ",              "kcal": 884, "p": 0.0,  "f": 100.0, "c": 0.0},
    "oil_linseed":{"name": "–ú–∞—Å–ª–æ –ª—å–Ω—è–Ω–æ–µ",               "kcal": 884, "p": 0.0,  "f": 100.0, "c": 0.0},
    "nuts_alm":  {"name": "–ú–∏–Ω–¥–∞–ª—å",                      "kcal": 576, "p": 21.2, "f": 49.4,  "c": 6.9},
    "cheese_20": {"name": "–°—ã—Ä –ª—ë–≥–∫–∏–π 20‚Äì30%",           "kcal": 260, "p": 26.0, "f": 16.0,  "c": 1.0},
    "banana":    {"name": "–ë–∞–Ω–∞–Ω",                        "kcal": 89,  "p": 1.1,  "f": 0.3,   "c": 22.0},
    "apple":     {"name": "–Ø–±–ª–æ–∫–æ",                       "kcal": 52,  "p": 0.3,  "f": 0.2,   "c": 12.0},
    "berries":   {"name": "–Ø–≥–æ–¥—ã (–∫–ª—É–±–Ω–∏–∫–∞/—á–µ—Ä–Ω–∏–∫–∞)",     "kcal": 45,  "p": 0.8,  "f": 0.4,   "c": 9.5},
    "avocado":   {"name": "–ê–≤–æ–∫–∞–¥–æ",                      "kcal": 160, "p": 2.0,  "f": 15.0,  "c": 2.0},
}


def _nutr_of(item_key: str, grams: float):
    it = FOOD_DB[item_key]
    k = grams / 100.0
    return {"kcal": it["kcal"] * k, "p": it["p"] * k, "f": it["f"] * k, "c": it["c"] * k}


def _sum_nutr(items: List[Tuple[str, float]]):
    tot = {"kcal": 0.0, "p": 0.0, "f": 0.0, "c": 0.0}
    for key, g in items:
        n = _nutr_of(key, g)
        for kk in tot:
            tot[kk] += n[kk]
    return tot


def _fmt_tot(t):
    return f"{int(round(t['kcal']))} –∫–∫–∞–ª | –ë {int(round(t['p']))}–≥ –ñ {int(round(t['f']))}–≥ –£ {int(round(t['c']))}–≥"


def _flatten(day_meals: List[List[Tuple[str, float]]]) -> List[Tuple[str, float]]:
    return [x for m in day_meals for x in m]


def _totals_of_day(day_meals: List[List[Tuple[str, float]]]) -> Dict[str, float]:
    return _sum_nutr(_flatten(day_meals))


def _add_grams(day_meals: List[List[Tuple[str, float]]], key: str, delta: float):
    if delta == 0:
        return
    for mi in range(len(day_meals)):
        for ii in range(len(day_meals[mi])):
            k, g = day_meals[mi][ii]
            if k == key:
                day_meals[mi][ii] = (k, max(0.0, g + delta))
                return
    day_meals[-1].append((key, max(0.0, float(delta))))


def _adjust_to_target(day_meals: List[List[Tuple[str, float]]], target: Dict[str, float]) -> Dict[str, float]:
    for _ in range(80):
        t = _totals_of_day(day_meals)
        dk = target["kcal"] - t["kcal"]
        dp = target["p"] - t["p"]
        df = target["f"] - t["f"]
        dc = target["c"] - t["c"]

        if abs(dk) <= 40 and abs(dp) <= 5 and abs(df) <= 4 and abs(dc) <= 8:
            return t

        if dp > 5:
            _add_grams(day_meals, "chicken", 25.0)
            continue
        if dp < -8:
            _add_grams(day_meals, "chicken", -25.0)
            continue

        if df > 4:
            _add_grams(day_meals, "oil_olive", 4.0)
            continue
        if df < -5:
            _add_grams(day_meals, "oil_olive", -4.0)
            continue

        if dc > 10 or dk > 80:
            _add_grams(day_meals, "rice", 10.0)
            continue
        if dc < -10 or dk < -80:
            _add_grams(day_meals, "rice", -10.0)
            continue

    return _totals_of_day(day_meals)


def _build_day_variant(variant: int, meals: int) -> List[List[Tuple[str, float]]]:
    meals = max(3, min(int(meals or 3), 5))

    if variant == 1:
        # –ö–ª–∞—Å—Å–∏–∫–∞: –æ–≤—Å—è–Ω–∫–∞ + –∫—É—Ä–∏—Ü–∞ + –≥—Ä–µ—á–∫–∞
        day = [
            [("oats", 80.0), ("eggs", 120.0), ("banana", 100.0)],
            [("rice", 90.0), ("chicken", 180.0), ("veg", 150.0), ("oil_olive", 10.0)],
            [("buckwheat", 80.0), ("fish", 180.0), ("veg", 150.0), ("oil_olive", 8.0)],
        ]
        if meals >= 4:
            day.append([("curd_0", 200.0), ("berries", 100.0)])
        if meals >= 5:
            day.append([("apple", 150.0), ("nuts_alm", 20.0)])
        return day

    if variant == 2:
        # –ì–æ–≤—è–¥–∏–Ω–∞ + –∫–∞—Ä—Ç–æ—Ñ–µ–ª—å + –ø–∞—Å—Ç–∞
        day = [
            [("eggs", 150.0), ("bread_rye", 60.0), ("cheese_20", 30.0)],
            [("potato", 250.0), ("beef", 160.0), ("veg", 150.0), ("oil_olive", 8.0)],
            [("pasta", 80.0), ("turkey", 180.0), ("veg", 150.0), ("oil_olive", 5.0)],
        ]
        if meals >= 4:
            day.append([("greek_yog", 200.0), ("banana", 100.0)])
        if meals >= 5:
            day.append([("curd_5", 150.0), ("nuts_alm", 15.0)])
        return day

    if variant == 3:
        # –õ–æ—Å–æ—Å—å + –≥—Ä–µ—á–µ—Å–∫–∏–π –π–æ–≥—É—Ä—Ç
        day = [
            [("oats", 70.0), ("greek_yog", 150.0), ("berries", 100.0)],
            [("rice", 90.0), ("salmon", 150.0), ("veg", 150.0), ("oil_olive", 5.0)],
            [("buckwheat", 80.0), ("turkey", 160.0), ("avocado", 60.0), ("veg", 150.0)],
        ]
        if meals >= 4:
            day.append([("curd_0", 200.0), ("apple", 120.0)])
        if meals >= 5:
            day.append([("eggs", 60.0), ("nuts_alm", 15.0)])
        return day

    if variant == 4:
        # –õ—ë–≥–∫–∏–π –≤–∞—Ä–∏–∞–Ω—Ç: —Ç–≤–æ—Ä–æ–≥ + –∫—É—Ä–∏–Ω–∞—è –≥—Ä—É–¥–∫–∞ + —Ä–∏—Å (–ª–µ–≥–∫–æ –≥–æ—Ç–æ–≤–∏—Ç—å)
        day = [
            [("curd_0", 250.0), ("banana", 100.0), ("berries", 80.0)],
            [("rice", 100.0), ("chicken", 200.0), ("veg", 200.0)],
            [("eggs", 180.0), ("veg", 150.0), ("bread_rye", 40.0)],
        ]
        if meals >= 4:
            day.append([("greek_yog", 200.0), ("apple", 120.0)])
        if meals >= 5:
            day.append([("curd_5", 150.0), ("berries", 80.0)])
        return day

    # –í–∞—Ä–∏–∞–Ω—Ç 5: –ª—ë–≥–∫–∏–π –±—ã—Å—Ç—Ä—ã–π (–º–∏–Ω–∏–º—É–º –≥–æ—Ç–æ–≤–∫–∏)
    day = [
        [("greek_yog", 200.0), ("oats", 50.0), ("banana", 100.0)],
        [("buckwheat", 90.0), ("fish", 200.0), ("veg", 200.0)],
        [("chicken", 180.0), ("potato", 200.0), ("veg", 150.0), ("oil_olive", 8.0)],
    ]
    if meals >= 4:
        day.append([("curd_0", 200.0), ("nuts_alm", 20.0)])
    if meals >= 5:
        day.append([("apple", 150.0), ("egg_white", 80.0)])
    return day


def build_meal_day_text(day_i: int, calories: int, protein_g: int, fat_g: int, carbs_g: int, meals: int) -> str:
    target = {"kcal": float(calories), "p": float(protein_g), "f": float(fat_g), "c": float(carbs_g)}
    day_meals = _build_day_variant(day_i, meals)
    tot = _adjust_to_target(day_meals, target)

    final_k = int(round(tot["kcal"]))
    final_p = int(round(tot["p"]))
    final_f = int(round(tot["f"]))
    final_c = int(round(tot["c"]))

    dk = final_k - calories
    dk_str = f"{'+' if dk >= 0 else ''}{dk}"

    meal_names = ["üåÖ –ó–∞–≤—Ç—Ä–∞–∫", "üåû –û–±–µ–¥", "üåÜ –£–∂–∏–Ω", "ü•ó –ü–µ—Ä–µ–∫—É—Å 1", "üçé –ü–µ—Ä–µ–∫—É—Å 2"]

    lines = [f"üìÖ –ü—Ä–∏–º–µ—Ä {day_i}  (—Ü–µ–ª—å: {calories} –∫–∫–∞–ª)", ""]
    for mi, m in enumerate(day_meals, start=1):
        # –§–∏–ª—å—Ç—Ä—É–µ–º –ø–æ–∑–∏—Ü–∏–∏ —Å –Ω—É–ª–µ–≤—ã–º–∏ –≥—Ä–∞–º–º–∞–º–∏
        m_filtered = [(k, g) for k, g in m if g > 0.5]
        if not m_filtered:
            continue
        mt = _sum_nutr(m_filtered)
        meal_name = meal_names[mi - 1] if mi <= len(meal_names) else f"–ü—Ä–∏—ë–º {mi}"
        lines.append(f"{meal_name}  ({_fmt_tot(mt)})")
        for k, g in m_filtered:
            if k == "eggs":
                est = max(1, int(round(g / 60.0)))
                lines.append(f"‚Ä¢ {FOOD_DB[k]['name']} ‚Äî {est} —à—Ç (~{int(g)}–≥)")
            elif k in ("oil_olive", "oil_linseed"):
                lines.append(f"‚Ä¢ {FOOD_DB[k]['name']} ‚Äî {int(round(g))} –≥ (1 —Å—Ç.–ª. ‚âà 10–≥)")
            elif k in ("nuts_alm",):
                lines.append(f"‚Ä¢ {FOOD_DB[k]['name']} ‚Äî {int(round(g))} –≥ (~–≥–æ—Ä—Å—Ç—å)")
            else:
                lines.append(f"‚Ä¢ {FOOD_DB[k]['name']} ‚Äî {int(round(g))} –≥")
        lines.append("")

    lines.append(f"‚úÖ –ò—Ç–æ–≥ –¥–Ω—è: {final_k} –∫–∫–∞–ª ({dk_str} –æ—Ç —Ü–µ–ª–∏)")
    lines.append(f"   –ë {final_p}–≥ / –ñ {final_f}–≥ / –£ {final_c}–≥")
    lines.append("")
    lines.append("üí° –ù–µ–±–æ–ª—å—à–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å ¬±5‚Äì10% ‚Äî –∞–±—Å–æ–ª—é—Ç–Ω–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ.")
    lines.append("   –ì–ª–∞–≤–Ω–æ–µ ‚Äî –¥–µ—Ä–∂–∞—Ç—å –æ–±—â–∏–π –≤–µ–∫—Ç–æ—Ä, –∞ –Ω–µ –ª–æ–≤–∏—Ç—å –≥—Ä–∞–º–º—ã.")
    lines.append("")
    lines.append("‚ö†Ô∏è –ó–∞–º–µ—Ç–∫–∏ –ø–æ –ø–æ—Ä—Ü–∏—è–º:")
    lines.append("   ‚Ä¢ –ö—Ä—É–ø—ã –∏ –º–∞–∫–∞—Ä–æ–Ω—ã ‚Äî –≥—Ä–∞–º–º—ã –≤ –°–£–•–û–ú (—Å—ã—Ä–æ–º) –≤–∏–¥–µ")
    lines.append("   ‚Ä¢ –†–∏—Å –ø—Ä–∏ –≤–∞—Ä–∫–µ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è ~–≤ 3 —Ä–∞–∑–∞, –≥—Ä–µ—á–∫–∞ ~–≤ 2.5")
    lines.append("   ‚Ä¢ –ö—É—Ä–∏—Ü–∞, —Ä—ã–±–∞, –º—è—Å–æ ‚Äî –ì–û–¢–û–í–´–ô (–≤–∞—Ä—ë–Ω—ã–π/–∂–∞—Ä–µ–Ω—ã–π) –≤–µ—Å")
    lines.append("   ‚Ä¢ –Ø–π—Ü–∞: 1 —Å—Ä–µ–¥–Ω–µ–µ —è–π—Ü–æ ‚âà 55‚Äì65 –≥")
    return "\n".join(lines)


def nutrition_examples_kb():
    return InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(text="ü•£ –í–∞—Ä–∏–∞–Ω—Ç 1 (–∫–ª–∞—Å—Å–∏–∫–∞)", callback_data="nutr:ex:1")],
        [InlineKeyboardButton(text="üçñ –í–∞—Ä–∏–∞–Ω—Ç 2 (–≥–æ–≤—è–¥–∏–Ω–∞)", callback_data="nutr:ex:2")],
        [InlineKeyboardButton(text="üêü –í–∞—Ä–∏–∞–Ω—Ç 3 (–ª–æ—Å–æ—Å—å)", callback_data="nutr:ex:3")],
        [InlineKeyboardButton(text="ü•ö –í–∞—Ä–∏–∞–Ω—Ç 4 (–ª—ë–≥–∫–∏–π)", callback_data="nutr:ex:4")],
        [InlineKeyboardButton(text="‚ö°Ô∏è –í–∞—Ä–∏–∞–Ω—Ç 5 (–±—ã—Å—Ç—Ä—ã–π)", callback_data="nutr:ex:5")],
        [InlineKeyboardButton(text="üõí –ú–æ—è –∫–æ—Ä–∑–∏–Ω–∞", callback_data="nutr:basket")],
        [InlineKeyboardButton(text="üè† –ú–µ–Ω—é", callback_data="nav:menu")],
    ])


def nutrition_back_kb():
    return InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(text="‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –∫ —Ä–∞—Ü–∏–æ–Ω—É", callback_data="nutr:back")],
        [InlineKeyboardButton(text="üõí –ú–æ—è –∫–æ—Ä–∑–∏–Ω–∞", callback_data="nutr:basket")],
        [InlineKeyboardButton(text="üè† –ú–µ–Ω—é", callback_data="nav:menu")],
    ])


def generate_nutrition_summary(goal: str, sex: str, age: int, height: int, weight: float, exp: str,
                             freq: int = 3, place: str = "—Å–≤–æ–π –≤–µ—Å", meals_pref: Optional[int] = None) -> Tuple[str, int, int, int, int, int]:
    calories = calc_calories(height, weight, age, sex, goal, freq=freq, place=place)
    p, f, c = calc_macros(calories, weight, goal)
    meals = int(meals_pref or 0) if meals_pref else suggest_meals_count(calories)
    meals = max(3, min(meals, 5))

    p_kcal = p * 4
    f_kcal = f * 9
    c_kcal = c * 4
    total_check = p_kcal + f_kcal + c_kcal

    summary = (
        "üçΩ –ü–∏—Ç–∞–Ω–∏–µ (–ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π —Ä–∞—Å—á—ë—Ç)\n\n"
        f"‚ö°Ô∏è –ö–∞–ª–æ—Ä–∏–∏: ~{calories} –∫–∫–∞–ª/–¥–µ–Ω—å\n"
        f"üí™ –ë–µ–ª–æ–∫: {p} –≥  ({int(round(p_kcal/total_check*100))}% –∫–∞–ª–æ—Ä–∏–π)\n"
        f"ü•ë –ñ–∏—Ä—ã: {f} –≥  ({int(round(f_kcal/total_check*100))}%)\n"
        f"üçö –£–≥–ª–µ–≤–æ–¥—ã: {c} –≥  ({int(round(c_kcal/total_check*100))}%)\n"
        f"üçΩ –ü—Ä–∏—ë–º–æ–≤ –ø–∏—â–∏: {meals}\n\n"
        "–í—ã–±–µ—Ä–∏ –≥–æ—Ç–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä —Ä–∞—Ü–∏–æ–Ω–∞ üëá\n"
        "(–í—Å–µ 3 –≤–∞—Ä–∏–∞–Ω—Ç–∞ –ø–æ–¥—Ö–æ–¥—è—Ç –ø–æ–¥ —Ç–≤–æ–∏ —Ü–∏—Ñ—Ä—ã)"
    )
    return summary, calories, p, f, c, meals


# =========================
# –ú–ï–ù–Æ / START
# =========================
FAQ_QUESTIONS = {
    "faq:weight": {
        "q": "‚öñÔ∏è –ü–æ—á–µ–º—É –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è –≤–µ—Å?",
        "a": (
            "‚öñÔ∏è –í–µ—Å —Å—Ç–æ–∏—Ç ‚Äî —á—Ç–æ –¥–µ–ª–∞—Ç—å?\n\n"
            "–ö–æ—Ä–æ—Ç–∫–∏–π –æ—Ç–≤–µ—Ç: —Ç—ã –µ—à—å —Å—Ç–æ–ª—å–∫–æ –∂–µ, —Å–∫–æ–ª—å–∫–æ —Ç—Ä–∞—Ç–∏—à—å.\n\n"
            "–ü–æ—á–µ–º—É —Ç–∞–∫ –±—ã–≤–∞–µ—Ç:\n"
            "‚Äî –°–æ—É—Å—ã, –º–∞—Å–ª–æ, –ø–µ—Ä–µ–∫—É—Å—ã –Ω–µ —Å—á–∏—Ç–∞—é—Ç—Å—è\n"
            "  (–æ–¥–∏–Ω –Ω–µ–∑–∞–º–µ—á–µ–Ω–Ω—ã–π –ø–µ—Ä–µ–∫—É—Å = 300‚Äì500 –∫–∫–∞–ª)\n"
            "‚Äî –í–µ—Å –≤–∑–≤–µ—à–∏–≤–∞–µ—Ç—Å—è –≤ —Ä–∞–∑–Ω–æ–µ –≤—Ä–µ–º—è\n"
            "  (–Ω–æ—Ä–º–∞: —É—Ç—Ä–æ–º, –Ω–∞—Ç–æ—â–∞–∫ ‚Äî —Ç–æ–≥–¥–∞ —Ü–∏—Ñ—Ä–∞ –æ–±—ä–µ–∫—Ç–∏–≤–Ω–∞)\n"
            "‚Äî –ú–∞–ª–æ –±–µ–ª–∫–∞ ‚Üí —Ç–µ–ª–æ —Ç–µ—Ä—è–µ—Ç –º—ã—à—Ü—ã, –∞ –Ω–µ –∂–∏—Ä\n"
            "‚Äî –ú–∞–ª–æ –≤–æ–¥—ã ‚Üí –∑–∞–¥–µ—Ä–∂–∫–∞ –≤–æ–¥—ã —Å–∫—Ä—ã–≤–∞–µ—Ç —É—Ö–æ–¥ –∂–∏—Ä–∞\n\n"
            "–ü—Ä–∏–º–µ—Ä:\n"
            "–ï—Å–ª–∏ —Ü–µ–ª—å ‚Äî –ø–æ—Ö—É–¥–µ—Ç—å, –∏ –≤–µ—Å —Å—Ç–æ–∏—Ç 2 –Ω–µ–¥–µ–ª–∏,\n"
            "–ø—Ä–æ–≤–µ—Ä—å: –∑–∞ 7 –¥–Ω–µ–π –Ω–µ—Ç –º–∏–Ω—É—Å 0.3‚Äì0.5 –∫–≥?\n"
            "–°–Ω–∏–∑—å –ø–∏—Ç–∞–Ω–∏–µ –Ω–∞ 150‚Äì200 –∫–∫–∞–ª –∏ –ø–æ–¥–æ–∂–¥–∏ –µ—â—ë –Ω–µ–¥–µ–ª—é.\n\n"
            "–ß—Ç–æ –¥–µ–ª–∞—Ç—å –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å:\n"
            "1. –í–∑–≤–µ—à–∏–≤–∞–π –≤—Å—é –µ–¥—É 7‚Äì14 –¥–Ω–µ–π –ø–æ–¥—Ä—è–¥\n"
            "2. –í–∑–≤–µ—à–∏–≤–∞–π—Å—è —É—Ç—Ä–æ–º –Ω–∞—Ç–æ—â–∞–∫, 3‚Äì4 —Ä–∞–∑–∞ –≤ –Ω–µ–¥–µ–ª—é\n"
            "3. –°–º–æ—Ç—Ä–∏ –Ω–∞ —Å—Ä–µ–¥–Ω–µ–µ –∑–∞ –Ω–µ–¥–µ–ª—é, –∞ –Ω–µ –Ω–∞ –æ–¥–∏–Ω –¥–µ–Ω—å"
        )
    },
    "faq:muscle": {
        "q": "üí™ –ü–æ—á–µ–º—É –Ω–µ—Ç —Ä–æ—Å—Ç–∞ –º—ã—à—Ü?",
        "a": (
            "üí™ –ú—ã—à—Ü—ã –Ω–µ —Ä–∞—Å—Ç—É—Ç ‚Äî —Ä–∞–∑–±–∏—Ä–∞–µ–º\n\n"
            "–ö–æ—Ä–æ—Ç–∫–∏–π –æ—Ç–≤–µ—Ç: –Ω–µ—Ç —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ–≥–æ –∏–∑ —Ç—Ä—ë—Ö ‚Äî\n"
            "–Ω–∞–≥—Ä—É–∑–∫–∞ / –ø–∏—Ç–∞–Ω–∏–µ / –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ.\n\n"
            "–ß–∞—Å—Ç—ã–µ –ø—Ä–∏—á–∏–Ω—ã:\n\n"
            "1. –ù–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–∏\n"
            "–û–¥–Ω–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –º–µ—Å—è—Ü–∞–º–∏ ‚Üí —Ç–µ–ª–æ –ø—Ä–∏–≤—ã–∫–ª–æ.\n"
            "–ü—Ä–∏–º–µ—Ä: –∂–º—ë—à—å 60 –∫–≥ —É–∂–µ 3 –º–µ—Å—è—Ü–∞?\n"
            "–î–æ–±–∞–≤—å 2.5 –∫–≥ –∏–ª–∏ 1 –ø–æ–≤—Ç–æ—Ä ‚Äî –º—ã—à—Ü–∞ –ø–æ—á—É–≤—Å—Ç–≤—É–µ—Ç —Å—Ç–∏–º—É–ª.\n\n"
            "2. –ú–∞–ª–æ –±–µ–ª–∫–∞\n"
            "–ù–∞ –º–∞—Å—Å—É –Ω—É–∂–Ω–æ 1.8‚Äì2.2 –≥/–∫–≥.\n"
            "–ü—Ä–∏ –≤–µ—Å–µ 75 –∫–≥ ‚Üí 135‚Äì165 –≥ –±–µ–ª–∫–∞ –≤ –¥–µ–Ω—å.\n\n"
            "3. –ú–∞–ª–æ –∫–∞–ª–æ—Ä–∏–π\n"
            "–ù–∞ –¥–µ—Ñ–∏—Ü–∏—Ç–µ –º—ã—à—Ü—ã –Ω–µ —Ä–∞—Å—Ç—É—Ç. –ù—É–∂–µ–Ω –ø—Ä–æ—Ñ–∏—Ü–∏—Ç +200‚Äì400 –∫–∫–∞–ª.\n\n"
            "4. –ü–ª–æ—Ö–æ–π —Å–æ–Ω\n"
            "–ú–µ–Ω–µ–µ 7 —á–∞—Å–æ–≤ = –≥–æ—Ä–º–æ–Ω —Ä–æ—Å—Ç–∞ –Ω–µ –≤—ã–¥–µ–ª—è–µ—Ç—Å—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ.\n\n"
            "–°–æ–≤–µ—Ç –Ω–æ–≤–∏—á–∫—É:\n"
            "–ü–µ—Ä–≤—ã–µ 3‚Äì6 –º–µ—Å—è—Ü–µ–≤ –ø—Ä–æ–≥—Ä–µ—Å—Å –∏–¥—ë—Ç –±—ã—Å—Ç—Ä–æ –¥–∞–∂–µ –±–µ–∑ –∏–¥–µ–∞–ª—å–Ω–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è.\n"
            "–ì–ª–∞–≤–Ω–æ–µ ‚Äî —Ä–µ–≥—É–ª—è—Ä–Ω–æ—Å—Ç—å –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∏—è –≤–µ—Å–æ–≤."
        )
    },
    "faq:plateau": {
        "q": "üìâ –ü–æ—á–µ–º—É –ø—Ä–µ–∫—Ä–∞—Ç–∏–ª—Å—è –ø—Ä–æ–≥—Ä–µ—Å—Å (–ø–ª–∞—Ç–æ)?",
        "a": (
            "üìâ –ü–ª–∞—Ç–æ ‚Äî –∫–∞–∫ –≤—ã–π—Ç–∏?\n\n"
            "–ö–æ—Ä–æ—Ç–∫–∏–π –æ—Ç–≤–µ—Ç: —Ç–µ–ª–æ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–ª–æ—Å—å –∫ –Ω–∞–≥—Ä—É–∑–∫–µ.\n"
            "–≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ ‚Äî –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∫–∞–∂–¥—ã–µ 6‚Äì10 –Ω–µ–¥–µ–ª—å.\n\n"
            "–ü—Ä–∏–∑–Ω–∞–∫–∏ –ø–ª–∞—Ç–æ:\n"
            "‚Äî 3+ –Ω–µ–¥–µ–ª–∏ –±–µ–∑ —Ä–æ—Å—Ç–∞ —Ä–∞–±–æ—á–µ–≥–æ –≤–µ—Å–∞\n"
            "‚Äî –í–µ—Å —Ç–µ–ª–∞ –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –¥–µ—Ñ–∏—Ü–∏—Ç–µ\n"
            "‚Äî –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –æ—â—É—â–∞—é—Ç—Å—è –ª—ë–≥–∫–∏–º–∏\n\n"
            "–ß—Ç–æ –¥–µ–ª–∞—Ç—å:\n\n"
            "1. –°–º–µ–Ω–∏ –ø—Ä–æ–≥—Ä–∞–º–º—É\n"
            "–ö–Ω–æ–ø–∫–∞ ¬´–°–æ—Å—Ç–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –ø–ª–∞–Ω¬ª –≤ –ø—Ä–æ—Ñ–∏–ª–µ ‚Äî –¥—Ä—É–≥–æ–π –Ω–∞–±–æ—Ä —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π.\n\n"
            "2. –†–∞–∑–≥—Ä—É–∑–æ—á–Ω–∞—è –Ω–µ–¥–µ–ª—è\n"
            "-30% –Ω–∞–≥—Ä—É–∑–∫–∏, —Ç–æ–ª—å–∫–æ —Ç–µ—Ö–Ω–∏–∫–∞.\n"
            "–ü–æ—Å–ª–µ ‚Äî –æ–±—ã—á–Ω–æ –∏–¥—ë—Ç –º–æ—â–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å.\n\n"
            "3. –ü—Ä–æ–≤–µ—Ä—å –ø–∏—Ç–∞–Ω–∏–µ\n"
            "–ù–µ–∑–∞–º–µ—Ç–Ω–æ –≤—ã—Ä–æ—Å–ª–∏ –∫–∞–ª–æ—Ä–∏–∏? –ü–µ—Ä–µ—Å—á–∏—Ç–∞–π —Ä–∞—Ü–∏–æ–Ω.\n\n"
            "–ü—Ä–∏–º–µ—Ä:\n"
            "–ü—Ä–∏—Å–µ–¥ 80 –∫–≥ —Å—Ç–æ–∏—Ç 4 –Ω–µ–¥–µ–ª–∏?\n"
            "–ü–æ–ø—Ä–æ–±—É–π 75 –∫–≥, –¥–æ–±–∞–≤—å –ø–∞—É–∑—É 2 —Å–µ–∫ –≤–Ω–∏–∑—É ‚Äî —á–µ—Ä–µ–∑ 2 –Ω–µ–¥–µ–ª–∏ 82.5 –ø–æ–π–¥—É—Ç –ª–µ–≥—á–µ.\n\n"
            "–ü–ª–∞—Ç–æ 2‚Äì3 –Ω–µ–¥–µ–ª–∏ ‚Äî –Ω–æ—Ä–º–∞. –ë–æ–ª—å—à–µ –º–µ—Å—è—Ü–∞ ‚Äî –Ω—É–∂–Ω–æ –º–µ–Ω—è—Ç—å –ø–æ–¥—Ö–æ–¥."
        )
    },
    "faq:diet": {
        "q": "üçΩ –ö–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–∏—Ç–∞—Ç—å—Å—è –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞?",
        "a": (
            "üçΩ –ü–∏—Ç–∞–Ω–∏–µ ‚Äî –≥–ª–∞–≤–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã\n\n"
            "–ö–æ—Ä–æ—Ç–∫–∏–π –æ—Ç–≤–µ—Ç: —Å—á–∏—Ç–∞–π –∫–∞–ª–æ—Ä–∏–∏ –∏ –±–µ–ª–æ–∫.\n"
            "–û—Å—Ç–∞–ª—å–Ω–æ–µ ‚Äî –¥–µ—Ç–∞–ª–∏.\n\n"
            "–û—Å–Ω–æ–≤—ã:\n\n"
            "1. –ö–∞–ª–æ—Ä–∏–∏ ‚Äî —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç\n"
            "–ü–æ—Ö—É–¥–µ–Ω–∏–µ: –¥–µ—Ñ–∏—Ü–∏—Ç 300‚Äì500 –∫–∫–∞–ª.\n"
            "–ú–∞—Å—Å–∞: –ø—Ä–æ—Ñ–∏—Ü–∏—Ç 200‚Äì400 –∫–∫–∞–ª.\n"
            "–ü—Ä–∏–º–µ—Ä: –Ω–æ—Ä–º–∞ 2200 –∫–∫–∞–ª ‚Üí –Ω–∞ —Å—É—à–∫–µ –µ—à—å 1700‚Äì1900.\n\n"
            "2. –ë–µ–ª–æ–∫ ‚Äî –∫–∞–∂–¥—ã–π –¥–µ–Ω—å\n"
            "1.8‚Äì2 –≥/–∫–≥. –ü—Ä–∏ 70 –∫–≥ ‚Üí 126‚Äì140 –≥ –≤ –¥–µ–Ω—å.\n"
            "–ò—Å—Ç–æ—á–Ω–∏–∫–∏: –∫—É—Ä–∏—Ü–∞, —Ä—ã–±–∞, —è–π—Ü–∞, —Ç–≤–æ—Ä–æ–≥.\n\n"
            "3. –£–≥–ª–µ–≤–æ–¥—ã –∏ –∂–∏—Ä—ã ‚Äî –Ω–µ –≤—Ä–∞–≥–∏\n"
            "–ù–µ —É–±–∏—Ä–∞–π –∂–∏—Ä—ã –Ω–∏–∂–µ 0.7 –≥/–∫–≥ ‚Äî —É–ø–∞–¥—É—Ç –≥–æ—Ä–º–æ–Ω—ã.\n"
            "–£–≥–ª–µ–≤–æ–¥—ã –ø–µ—Ä–µ–¥ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–æ–π = —ç–Ω–µ—Ä–≥–∏—è.\n\n"
            "–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Å–æ–≤–µ—Ç:\n"
            "‚Äî –î–ª—è –Ω–∞—á–∞–ª–∞: –ø—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤—å –±–µ–ª–æ–∫ –∫ –∫–∞–∂–¥–æ–º—É –ø—Ä–∏—ë–º—É –ø–∏—â–∏\n"
            "‚Äî –î–ª—è –Ω–æ–≤–∏—á–∫–∞: –Ω–µ –Ω—É–∂–Ω–∞ –∏–¥–µ–∞–ª—å–Ω–∞—è –¥–∏–µ—Ç–∞, –Ω—É–∂–Ω–∞ —Å—Ç–∞–±–∏–ª—å–Ω–∞—è\n"
            "‚Äî –ï—Å–ª–∏ –ø—Ä–æ–ø—É—Å—Ç–∏–ª —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É: –µ—à—å –∫–∞–∫ –æ–±—ã—á–Ω–æ, –Ω–∏—á–µ–≥–æ —Å—Ç—Ä–∞—à–Ω–æ–≥–æ\n\n"
            "–û—Ç–∫—Ä–æ–π ¬´–ü–∏—Ç–∞–Ω–∏–µ¬ª ‚Äî —Ç–∞–º –ö–ë–ñ–£ –ø–æ–¥ —Ç–≤–æ–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –ø—Ä–∏–º–µ—Ä—ã —Ä–∞—Ü–∏–æ–Ω–æ–≤."
        )
    },
    "faq:motivation": {
        "q": "üòî –ö–∞–∫ –Ω–µ –±—Ä–æ—Å–∏—Ç—å –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –º–æ—Ç–∏–≤–∞—Ü–∏—é?",
        "a": (
            "üòî –ú–æ—Ç–∏–≤–∞—Ü–∏—è ‚Äî –∫–∞–∫ –Ω–µ –±—Ä–æ—Å–∏—Ç—å?\n\n"
            "–ö–æ—Ä–æ—Ç–∫–∏–π –æ—Ç–≤–µ—Ç: –Ω–µ –ø–æ–ª–∞–≥–∞–π—Å—è –Ω–∞ –º–æ—Ç–∏–≤–∞—Ü–∏—é.\n"
            "–°—Ç—Ä–æ–π –ø—Ä–∏–≤—ã—á–∫—É.\n\n"
            "–ü–æ—á–µ–º—É –±—Ä–æ—Å–∞—é—Ç:\n"
            "‚Äî –ñ–¥–∞–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞ 2‚Äì4 –Ω–µ–¥–µ–ª–∏ ‚Äî –Ω–µ —É–≤–∏–¥–µ–ª–∏\n"
            "‚Äî –ü—Ä–æ–≥—Ä–∞–º–º–∞ —Å–ª–∏—à–∫–æ–º —Ç—è–∂—ë–ª–∞—è\n"
            "‚Äî –ù–µ—Ç –≤–∏–¥–∏–º–æ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞\n\n"
            "–ß—Ç–æ —Ä–µ–∞–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:\n\n"
            "1. –°–Ω–∏–∑—å –ø–ª–∞–Ω–∫—É\n"
            "3 —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –ø–æ 40 –º–∏–Ω —Å—Ç–∞–±–∏–ª—å–Ω–æ –ª—É—á—à–µ,\n"
            "—á–µ–º 1 —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ 2 —á–∞—Å–∞ —Ä–∞–∑ –≤ 2 –Ω–µ–¥–µ–ª–∏.\n\n"
            "2. –û—Ç—Å–ª–µ–∂–∏–≤–∞–π –ø—Ä–æ–≥—Ä–µ—Å—Å\n"
            "–î–Ω–µ–≤–Ω–∏–∫ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫: —Ä–æ—Å—Ç –≤ —Ü–∏—Ñ—Ä–∞—Ö –≤–∏–¥–µ–Ω —á–µ—Ä–µ–∑ 3‚Äì4 –Ω–µ–¥–µ–ª–∏.\n"
            "–ó–∞–º–µ—Ä—ã: –¥–µ–ª–∞–π —Ñ–æ—Ç–æ —Ä–∞–∑ –≤ 4 –Ω–µ–¥–µ–ª–∏ ‚Äî –≤–µ—Å –ª–∂—ë—Ç, —Ñ–æ—Ç–æ –Ω–µ—Ç.\n\n"
            "3. –ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ –ø—Ä–æ–ø—É—Å—Ç–∏–ª —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É?\n"
            "–ù–∏—á–µ–≥–æ. –ü—Ä–æ—Å—Ç–æ –∏–¥–∏ –Ω–∞ —Å–ª–µ–¥—É—é—â—É—é.\n"
            "–û–¥–Ω–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –Ω–µ –ª–æ–º–∞–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å.\n\n"
            "4. –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ —Å—Ä–æ–∫–∏\n"
            "–í–∏–¥–∏–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: 8‚Äì12 –Ω–µ–¥–µ–ª—å –ø—Ä–∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç–µ.\n"
            "–≠—Ç–æ –Ω–µ –º–µ—Å—è—Ü ‚Äî –Ω–æ –∏ –Ω–µ –≥–æ–¥—ã."
        )
    },
    "faq:sleep": {
        "q": "üò¥ –ü–æ—á–µ–º—É –≤–∞–∂–µ–Ω —Å–æ–Ω –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ?",
        "a": (
            "üò¥ –°–æ–Ω ‚Äî –Ω–µ–¥–æ–æ—Ü–µ–Ω—ë–Ω–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç\n\n"
            "–ö–æ—Ä–æ—Ç–∫–∏–π –æ—Ç–≤–µ—Ç: –º—ã—à—Ü—ã —Ä–∞—Å—Ç—É—Ç –≤–æ —Å–Ω–µ, –∞ –Ω–µ –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–µ.\n"
            "–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ ‚Äî —Å—Ç–∏–º—É–ª. –°–æ–Ω ‚Äî –∫–æ–≥–¥–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ä–æ—Å—Ç.\n\n"
            "–§–∞–∫—Ç—ã:\n"
            "‚Äî 6 —á–∞—Å–æ–≤ —Å–Ω–∞: –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –º—ã—à—Ü —Ö—É–∂–µ –Ω–∞ 60%\n"
            "‚Äî 7‚Äì9 —á–∞—Å–æ–≤: –æ–ø—Ç–∏–º—É–º –¥–ª—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞\n"
            "‚Äî –•—Ä–æ–Ω–∏—á–µ—Å–∫–∏–π –Ω–µ–¥–æ—Å—ã–ø: –∫–æ—Ä—Ç–∏–∑–æ–ª –≤—ã—Å–æ–∫–∏–π ‚Üí –∂–∏—Ä –Ω–∞–∫–∞–ø–ª–∏–≤–∞–µ—Ç—Å—è\n\n"
            "–ö–∞–∫ –ø–æ–Ω—è—Ç—å, —á—Ç–æ –Ω–µ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—à—å—Å—è:\n"
            "‚Äî –í–µ—Å–∞ —Å—Ç–æ—è—Ç 2‚Äì3 –Ω–µ–¥–µ–ª–∏\n"
            "‚Äî –ù–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–µ –±—ã—Å—Ç—Ä–æ —É—Å—Ç–∞—ë—à—å\n"
            "‚Äî –†–∞–∑–¥—Ä–∞–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–ª–∏ —á–∞—Å—Ç—ã–µ –ø—Ä–æ—Å—Ç—É–¥—ã\n\n"
            "–ü—Ä–∏–º–µ—Ä:\n"
            "–¢—Ä–µ–Ω–∏—Ä—É–µ—à—å—Å—è 4 —Ä–∞–∑–∞ –≤ –Ω–µ–¥–µ–ª—é, —Å–ø–∏—à—å 5‚Äì6 —á–∞—Å–æ–≤?\n"
            "–ü–æ–ø—Ä–æ–±—É–π 2 –Ω–µ–¥–µ–ª–∏ —Å –Ω–æ—Ä–º–∞–ª—å–Ω—ã–º —Å–Ω–æ–º ‚Äî –ø–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞\n"
            "–≤–µ—Å–∞ –Ω–∞—á–∏–Ω–∞—é—Ç —Ä–∞—Å—Ç–∏ —Å–Ω–æ–≤–∞.\n\n"
            "–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏:\n"
            "‚Äî –õ–æ–∂–∏—Å—å –≤ –æ–¥–Ω–æ –≤—Ä–µ–º—è\n"
            "‚Äî –ü—Ä–æ—Ö–ª–∞–¥–Ω–∞—è –∫–æ–º–Ω–∞—Ç–∞ (18‚Äì20¬∞C) —É–ª—É—á—à–∞–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ —Å–Ω–∞\n"
            "‚Äî 1 –ø–æ–ª–Ω—ã–π –¥–µ–Ω—å –æ—Ç–¥—ã—Ö–∞ –≤ –Ω–µ–¥–µ–ª—é –ø—Ä–∏ 4‚Äì5 —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞—Ö"
        )
    },
    "faq:technique": {
        "q": "üèãÔ∏è –ü–æ—á–µ–º—É —Ç–∞–∫ –≤–∞–∂–Ω–∞ —Ç–µ—Ö–Ω–∏–∫–∞?",
        "a": (
            "üèãÔ∏è –¢–µ—Ö–Ω–∏–∫–∞ ‚Äî –∑–∞—á–µ–º —Ç—Ä–∞—Ç–∏—Ç—å –Ω–∞ –Ω–µ—ë –≤—Ä–µ–º—è?\n\n"
            "–ö–æ—Ä–æ—Ç–∫–∏–π –æ—Ç–≤–µ—Ç: –ø–ª–æ—Ö–∞—è —Ç–µ—Ö–Ω–∏–∫–∞ = –ª–∏–±–æ —Ç—Ä–∞–≤–º–∞,\n"
            "–ª–∏–±–æ –Ω–∞–≥—Ä—É–∑–∫–∞ –∏–¥—ë—Ç –Ω–µ –≤ —Ç—É –º—ã—à—Ü—É.\n\n"
            "–†–µ–∞–ª—å–Ω—ã–µ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:\n"
            "‚Äî –¢—è–Ω–µ—à—å —Å–ø–∏–Ω–æ–π –≤–º–µ—Å—Ç–æ –Ω–æ–≥ (–ø—Ä–∏—Å–µ–¥)\n"
            "‚Äî –ù–∞–≥—Ä—É–∂–∞–µ—à—å —Ç—Ä–∞–ø–µ—Ü–∏—é –≤–º–µ—Å—Ç–æ —à–∏—Ä–æ—á–∞–π—à–∏—Ö (—Ç—è–≥–∞)\n"
            "‚Äî –ë–æ–ª—è—Ç –∫–æ–ª–µ–Ω–∏, –ø–ª–µ—á–∏, –ø–æ—è—Å–Ω–∏—Ü–∞\n\n"
            "–ü—Ä–∏–º–µ—Ä –¥–ª—è –Ω–æ–≤–∏—á–∫–∞:\n"
            "–ü–µ—Ä–≤—ã–µ 2‚Äì4 –Ω–µ–¥–µ–ª–∏ ‚Äî —Ä–∞–±–æ—Ç–∞–π —Å –≤–µ—Å–æ–º 50‚Äì60% –æ—Ç –º–∞–∫—Å–∏–º—É–º–∞.\n"
            "–û—Å–≤–æ–π —Ç–µ—Ö–Ω–∏–∫—É ‚Üí –ø–æ—Ç–æ–º –¥–æ–±–∞–≤–ª—è–π –Ω–∞–≥—Ä—É–∑–∫—É.\n"
            "–≠—Ç–æ –Ω–µ –ø–æ—Ç–µ—Ä—è –≤—Ä–µ–º–µ–Ω–∏ ‚Äî —ç—Ç–æ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏—è –≤ —Å–ª–µ–¥—É—é—â–∏–µ –≥–æ–¥—ã.\n\n"
            "–ß—Ç–æ –≤—ã–±—Ä–∞—Ç—å –Ω–æ–≤–∏—á–∫—É:\n"
            "‚Äî –°—Ç–∞—Ä—Ç: –ø—Ä–∏—Å–µ–¥, —Ç—è–≥–∞ –≤–µ—Ä—Ö–Ω–µ–≥–æ –±–ª–æ–∫–∞, –∂–∏–º, –æ—Ç–∂–∏–º–∞–Ω–∏—è\n"
            "‚Äî –ò—Å–ø–æ–ª—å–∑—É–π –∫–Ω–æ–ø–∫—É ¬´–¢–µ—Ö–Ω–∏–∫–∞¬ª –ø–æ–¥ –∫–∞–∂–¥—ã–º —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ–º\n"
            "‚Äî –ß–∏—Å—Ç–æ —Å –º–µ–Ω—å—à–∏–º –≤–µ—Å–æ–º –ª—É—á—à–µ, —á–µ–º –∫—Ä–∏–≤–æ —Å –±–æ–ª—å—à–∏–º\n\n"
            "–ö–∞–∫ –ø–æ–Ω—è—Ç—å, —á—Ç–æ –ø—Ä–æ–≥—Ä–µ—Å—Å –µ—Å—Ç—å:\n"
            "‚Äî –í–µ—Å–∞ —Ä–∞—Å—Ç—É—Ç –ø—Ä–∏ —Ç–æ–π –∂–µ —Ç–µ—Ö–Ω–∏–∫–µ\n"
            "‚Äî –ù–µ—Ç –±–æ–ª–∏ –≤ —Å—É—Å—Ç–∞–≤–∞—Ö –ø–æ—Å–ª–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏\n"
            "‚Äî –ß—É–≤—Å—Ç–≤—É–µ—à—å –∏–º–µ–Ω–Ω–æ —Ç—É –º—ã—à—Ü—É, –∫–æ—Ç–æ—Ä—É—é —Ç—Ä–µ–Ω–∏—Ä—É–µ—à—å"
        )
    },
    "faq:cardio": {
        "q": "üèÉ –ù—É–∂–Ω–æ –ª–∏ –∫–∞—Ä–¥–∏–æ?",
        "a": (
            "üèÉ –ö–∞—Ä–¥–∏–æ ‚Äî –Ω—É–∂–Ω–æ –ª–∏?\n\n"
            "–ö–æ—Ä–æ—Ç–∫–∏–π –æ—Ç–≤–µ—Ç: –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, –Ω–æ –ø–æ–ª–µ–∑–Ω–æ.\n"
            "–ó–∞–≤–∏—Å–∏—Ç –æ—Ç —Ü–µ–ª–∏.\n\n"
            "–ö–æ–≥–¥–∞ –ø–æ–º–æ–≥–∞–µ—Ç:\n"
            "‚Äî –°—É—à–∫–∞: —É—Å–∫–æ—Ä—è–µ—Ç –¥–µ—Ñ–∏—Ü–∏—Ç –±–µ–∑ —É—Ä–µ–∑–∞–Ω–∏—è –µ–¥—ã\n"
            "‚Äî –ó–¥–æ—Ä–æ–≤—å–µ —Å–µ—Ä–¥—Ü–∞: –≤–∞–∂–Ω–æ –¥–ª—è –≤—Å–µ—Ö\n"
            "‚Äî –õ—ë–≥–∫–æ–µ –∫–∞—Ä–¥–∏–æ —É—Å–∫–æ—Ä—è–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ —Å–∏–ª–æ–≤–æ–π\n\n"
            "–ö–æ–≥–¥–∞ –º–µ—à–∞–µ—Ç:\n"
            "‚Äî –ú–Ω–æ–≥–æ –∫–∞—Ä–¥–∏–æ –Ω–∞ –º–∞—Å—Å–µ = —Ç–µ–ª–æ –∂–∂—ë—Ç –º—ã—à—Ü—ã\n"
            "‚Äî –°—Ä–∞–∑—É –ø–æ—Å–ª–µ —Å–∏–ª–æ–≤–æ–π 40+ –º–∏–Ω = —Ö—É–∂–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ\n\n"
            "–ü—Ä–∏–º–µ—Ä—ã:\n\n"
            "–î–ª—è —Å—É—à–∫–∏ (3 —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏/–Ω–µ–¥):\n"
            "2 –∫–∞—Ä–¥–∏–æ –ø–æ 25‚Äì35 –º–∏–Ω –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –¥–Ω–∏.\n"
            "–•–æ–¥—å–±–∞ 6‚Äì7 –∫–º/—á, –≤–µ–ª–æ—Å–∏–ø–µ–¥, —ç–ª–ª–∏–ø—Å.\n\n"
            "–î–ª—è –º–∞—Å—Å—ã:\n"
            "1‚Äì2 —Ä–∞–∑–∞ –ø–æ 20 –º–∏–Ω ‚Äî —Ç–æ–ª—å–∫–æ –¥–ª—è –∑–¥–æ—Ä–æ–≤—å—è.\n\n"
            "–°–æ–≤–µ—Ç –Ω–æ–≤–∏—á–∫—É:\n"
            "–ü–µ—Ä–≤—ã–µ 2‚Äì3 –º–µ—Å—è—Ü–∞ ‚Äî —Ñ–æ–∫—É—Å –Ω–∞ —Å–∏–ª–æ–≤—ã–µ.\n"
            "–ö–∞—Ä–¥–∏–æ –¥–æ–±–∞–≤–ª—è–π –ø–æ—Å–ª–µ, –∫–æ–≥–¥–∞ –±–∞–∑–∞ –≤—ã—Å—Ç—Ä–æ–µ–Ω–∞."
        )
    },
}


def faq_kb():
    rows = [
        [
            InlineKeyboardButton(text="‚öñÔ∏è –í–µ—Å –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è", callback_data="faq:weight"),
            InlineKeyboardButton(text="üí™ –ú—ã—à—Ü—ã –Ω–µ —Ä–∞—Å—Ç—É—Ç", callback_data="faq:muscle"),
        ],
        [
            InlineKeyboardButton(text="üìâ –ü—Ä–æ–≥—Ä–µ—Å—Å –≤—Å—Ç–∞–ª", callback_data="faq:plateau"),
            InlineKeyboardButton(text="üçΩ –ö–∞–∫ –ø–∏—Ç–∞—Ç—å—Å—è", callback_data="faq:diet"),
        ],
        [
            InlineKeyboardButton(text="üòî –ù–µ—Ç –º–æ—Ç–∏–≤–∞—Ü–∏–∏", callback_data="faq:motivation"),
            InlineKeyboardButton(text="üò¥ –°–æ–Ω –∏ –æ—Ç–¥—ã—Ö", callback_data="faq:sleep"),
        ],
        [
            InlineKeyboardButton(text="üèãÔ∏è –ó–∞—á–µ–º —Ç–µ—Ö–Ω–∏–∫–∞", callback_data="faq:technique"),
            InlineKeyboardButton(text="üèÉ –ù—É–∂–Ω–æ –ª–∏ –∫–∞—Ä–¥–∏–æ", callback_data="faq:cardio"),
        ],
        [InlineKeyboardButton(text="üè† –ú–µ–Ω—é", callback_data="nav:menu")],
    ]
    return InlineKeyboardMarkup(inline_keyboard=rows)


def faq_back_kb():
    return InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(text="‚¨ÖÔ∏è –í—Å–µ –≤–æ–ø—Ä–æ—Å—ã", callback_data="nav:faq")],
        [InlineKeyboardButton(text="üè† –ú–µ–Ω—é", callback_data="nav:menu")],
    ])


async def open_faq(user_id: int, chat_id: int, bot: Bot, callback: Optional[CallbackQuery] = None):
    text = (
        "‚ùì –ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã\n\n"
        "–†–∞–∑–±–∏—Ä–∞–µ–º –ø—Ä–∏—á–∏–Ω—ã, –ø–æ –∫–æ—Ç–æ—Ä—ã–º –Ω–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞.\n"
        "–í—ã–±–µ—Ä–∏ —Ç–µ–º—É ‚Äî –¥–∞–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –æ—Ç–≤–µ—Ç –±–µ–∑ –≤–æ–¥—ã."
    )
    if callback:
        await clean_edit(callback, user_id, text, reply_markup=faq_kb())
    else:
        await _send_with_image(bot, chat_id, user_id, text, "faq", reply_markup=faq_kb())


async def cb_faq_question(callback: CallbackQuery, bot: Bot):
    key = callback.data  # faq:weight, faq:muscle etc
    item = FAQ_QUESTIONS.get(key)
    if not item:
        await callback.answer("–í–æ–ø—Ä–æ—Å –Ω–µ –Ω–∞–π–¥–µ–Ω", show_alert=True)
        return
    await clean_edit(callback, callback.from_user.id, item["a"], reply_markup=faq_back_kb())
    await callback.answer()


async def show_main_menu(bot: Bot, chat_id: int, user_id: int):
    sub = await get_subscription(user_id)
    tariff_line = format_tariff_line(sub)
    text = (
        "–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é\n\n"
        f"{tariff_line}\n\n"
        "–®–∞–≥–∏ –¥–ª—è —Å—Ç–∞—Ä—Ç–∞:\n"
        "1. ‚öôÔ∏è –ü—Ä–æ—Ñ–∏–ª—å ‚Äî —Ü–µ–ª—å, –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –º–µ—Å—Ç–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫\n"
        "2. üí≥ –û–ø–ª–∞—Ç–∞ ‚Äî –≤—ã–±–µ—Ä–∏ —Ç–∞—Ä–∏—Ñ, –ø—Ä–æ–≥—Ä–∞–º–º–∞ —Å—Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è —Å—Ä–∞–∑—É\n"
        "3. üèãÔ∏è –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ ‚Äî –¥–Ω–∏, —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è, —Ç–µ—Ö–Ω–∏–∫–∞\n"
        "4. üìì –î–Ω–µ–≤–Ω–∏–∫ ‚Äî –∑–∞–ø–∏—Å—ã–≤–∞–π –≤–µ—Å–∞ –∏ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è –ø–æ—Å–ª–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏\n"
        "5. üìè –ó–∞–º–µ—Ä—ã ‚Äî –≤–µ—Å —Ç–µ–ª–∞ –∏ –æ–±—Ö–≤–∞—Ç—ã —Ä–∞–∑ –≤ 1‚Äì2 –Ω–µ–¥–µ–ª–∏\n"
        "6. üçΩ –ü–∏—Ç–∞–Ω–∏–µ ‚Äî –ö–ë–ñ–£ + –ø—Ä–∏–º–µ—Ä—ã —Ä–∞—Ü–∏–æ–Ω–æ–≤\n\n"
        "–ù–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞? –ó–∞–≥–ª—è–Ω–∏ –≤ ¬´–ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã¬ª."
    )
    await _send_with_image(bot, chat_id, user_id, text, "menu", reply_markup=menu_main_inline_kb())


def welcome_kb():
    return InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(text="üìã –ó–∞–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å", callback_data="p:start_wizard")],
    ])


async def cmd_start(message: Message, bot: Bot):
    uid = message.from_user.id
    await ensure_user(uid, message.from_user.username or "")
    await try_delete_user_message(bot, message)

    # –ü—Ä–æ–≤–µ—Ä—è–µ–º: –ø—Ä–æ—Ñ–∏–ª—å –∑–∞–ø–æ–ª–Ω–µ–Ω, –Ω–æ –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–µ—Ç
    u = await get_user(uid)
    profile_complete = bool(
        u.get("goal") and u.get("sex") and u.get("height")
        and u.get("weight") and u.get("freq")
    )
    subscription_active = await is_access_active(uid)

    if profile_complete and not subscription_active:
        await bot.send_message(
            chat_id=message.chat.id,
            text="‚úÖ –Ø –Ω–∞ –º–µ—Å—Ç–µ. –ö–Ω–æ–ø–∫–∏ —Å–Ω–∏–∑—É üëá",
            reply_markup=control_reply_kb()
        )
        spec_text = (
            "üëã –¢—ã —É–∂–µ –∑–∞–ø–æ–ª–Ω–∏–ª –ø—Ä–æ—Ñ–∏–ª—å ‚Äî –æ—Å—Ç–∞–ª–æ—Å—å –æ—Ç–∫—Ä—ã—Ç—å –¥–æ—Å—Ç—É–ø.\n\n"
            "–ß—Ç–æ —É–º–µ–µ—Ç –±–æ—Ç:\n"
            "‚úÖ —Å–æ—Å—Ç–∞–≤–∏—Ç –ø—Ä–æ–≥—Ä–∞–º–º—É –ø–æ–¥ —Ç–≤–æ—é —Ü–µ–ª—å\n"
            "‚úÖ –ø–æ–∫–∞–∂–µ—Ç —Ç–µ—Ö–Ω–∏–∫—É —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π\n"
            "‚úÖ –ø–æ–º–æ–∂–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å\n\n"
            "–ß—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å, –≤—ã–±–µ—Ä–∏ –¥–æ—Å—Ç—É–ø üëá"
        )
        await _send_with_image(
            bot, message.chat.id, uid,
            spec_text, "restart", reply_markup=build_program_tariff_kb()
        )
        return

    await bot.send_message(
        chat_id=message.chat.id,
        text="‚úÖ –Ø –Ω–∞ –º–µ—Å—Ç–µ. –ö–Ω–æ–ø–∫–∏ —Å–Ω–∏–∑—É üëá",
        reply_markup=control_reply_kb()
    )

    welcome_text = (
        "üëãüèª –ü—Ä–∏–≤–µ—Ç! –Ø —Ç–≤–æ–π –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π —Ç—Ä–µ–Ω–µ—Ä.\n\n"
        "–ß—Ç–æ —É–º–µ—é:\n\n"
        "‚Äî –°–æ—Å—Ç–∞–≤–ª—è—é –ø—Ä–æ–≥—Ä–∞–º–º—É –ø–æ–¥ —Ç–≤–æ—é —Ü–µ–ª—å, —É—Ä–æ–≤–µ–Ω—å –∏ –º–µ—Å—Ç–æ (–∑–∞–ª / –¥–æ–º–∞)\n"
        "‚Äî –°—á–∏—Ç–∞—é –ö–ë–ñ–£ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ ‚Äî —Å —É—á—ë—Ç–æ–º –≤–µ—Å–∞, —Ü–µ–ª–∏ –∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏\n"
        "‚Äî –î–∞—é –≥–æ—Ç–æ–≤—ã–π –ø–ª–∞–Ω –ø–∏—Ç–∞–Ω–∏—è\n"
        "‚Äî –í–µ–¥—É –¥–Ω–µ–≤–Ω–∏–∫ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫: –≤–µ—Å–∞, –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è, –∏—Å—Ç–æ—Ä–∏—è\n"
        "‚Äî –ü–æ–∫–∞–∑—ã–≤–∞—é —Ç–µ—Ö–Ω–∏–∫—É —Å –∫–∞—Ä—Ç–∏–Ω–∫–æ–π ‚Äî –∫–Ω–æ–ø–∫–∞ –ø–æ–¥ –∫–∞–∂–¥—ã–º —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ–º\n"
        "‚Äî –û—Ç–≤–µ—á–∞—é –Ω–∞ —á–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã: –ø–ª–∞—Ç–æ, –ø–∏—Ç–∞–Ω–∏–µ, –º–æ—Ç–∏–≤–∞—Ü–∏—è\n\n"
        "–ö–∞–∫ –Ω–∞—á–∞—Ç—å:\n\n"
        "<i>1. –ù–∞–∂–∏–º–∞–π –Ω–∞ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ –∏ –ø—Ä–æ–π–¥–∏ –∫–æ—Ä–æ—Ç–∫–∏–π –æ–ø—Ä–æ—Å</i>\n"
        "<i>2. –í—ã–±–µ—Ä–∏ —Ç–∞—Ä–∏—Ñ ‚Äî –∏ –ø–æ–ª—É—á–∏ –≥–æ—Ç–æ–≤—ã–π –ø–ª–∞–Ω</i>\n"
    )

    await _send_with_image(
        bot, message.chat.id, uid,
        welcome_text, "welcome", reply_markup=welcome_kb()
    )


async def open_upgrade(user_id: int, chat_id: int, bot: Bot, callback: Optional[CallbackQuery] = None, source: str = ""):
    text = (
        "üí≥ –¢–∞—Ä–∏—Ñ—ã\n\n"
        f"üü© 1 –º–µ—Å—è—Ü ‚Äî {TARIFFS['t1']['price']}‚ÇΩ\n"
        "‚Ä¢ –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ + –¥–Ω–µ–≤–Ω–∏–∫ + –∑–∞–º–µ—Ä—ã\n"
        "‚Ä¢ –ü–æ–¥–¥–µ—Ä–∂–∫–∞\n"
        "‚Ä¢ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–ª–∞–Ω–∞: 3 —Ä–∞–∑–∞\n\n"
        f"üü¶ 3 –º–µ—Å—è—Ü–∞ ‚Äî {TARIFFS['t3']['price']}‚ÇΩ\n"
        "‚Ä¢ –í—Å—ë, —á—Ç–æ –≤ 1 –º–µ—Å—è—Ü–µ + –ø–∏—Ç–∞–Ω–∏–µ\n"
        "‚Ä¢ –°–º–µ–Ω–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã\n"
        "‚Ä¢ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–ª–∞–Ω–∞: 10 —Ä–∞–∑\n"
        "‚Ä¢ –í—ã–≥–æ–¥–Ω–µ–µ –ø–æ —Ü–µ–Ω–µ\n\n"
        f"üü® –ù–∞–≤—Å–µ–≥–¥–∞ ‚Äî {TARIFFS['life']['price']}‚ÇΩ\n"
        "‚Ä¢ –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø: —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ + –ø–∏—Ç–∞–Ω–∏–µ + –¥–Ω–µ–≤–Ω–∏–∫\n"
        "‚Ä¢ –°–º–µ–Ω–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã\n"
        "‚Ä¢ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–ª–∞–Ω–∞: –±–µ–∑–ª–∏–º–∏—Ç\n\n"
        "–ü–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º–∞ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏."
    )

    kb = InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(text=f"üü© 1 –º–µ—Å—è—Ü ‚Äî {TARIFFS['t1']['price']}‚ÇΩ", callback_data="tariff:t1")],
        [InlineKeyboardButton(text=f"üü¶ 3 –º–µ—Å—è—Ü–∞ ‚Äî {TARIFFS['t3']['price']}‚ÇΩ", callback_data="tariff:t3")],
        [InlineKeyboardButton(text=f"üü® –ù–∞–≤—Å–µ–≥–¥–∞ ‚Äî {TARIFFS['life']['price']}‚ÇΩ", callback_data="tariff:life")],
        [InlineKeyboardButton(
            text="‚¨ÖÔ∏è –ù–∞–∑–∞–¥" if source == "after_profile" else "üè† –ú–µ–Ω—é",
            callback_data="nav:back_to_program_tariff" if source == "after_profile" else "nav:menu"
        )],
    ])

    if callback:
        await clean_edit(callback, user_id, text, reply_markup=kb)
    else:
        await _send_with_image(bot, chat_id, user_id, text, "upgrade", reply_markup=kb)


# =========================
# –ù–∞–≤–∏–≥–∞—Ü–∏—è
# =========================
async def cb_nav(callback: CallbackQuery, state: FSMContext, bot: Bot):
    await ensure_user(callback.from_user.id, callback.from_user.username or "")
    await state.clear()

    key = callback.data.split(":", 1)[1]
    uid = callback.from_user.id
    chat_id = callback.message.chat.id

    if key == "menu":
        await show_main_menu(bot, chat_id, uid)
    elif key == "workouts":
        await open_workouts(user_id=uid, chat_id=chat_id, bot=bot, callback=callback)
    elif key == "nutrition":
        await open_nutrition(user_id=uid, chat_id=chat_id, bot=bot, callback=callback)
    elif key == "measures":
        await open_measures(user_id=uid, chat_id=chat_id, bot=bot, state=state, callback=callback)
    elif key == "diary":
        await open_diary(user_id=uid, chat_id=chat_id, bot=bot, state=state, callback=callback)
    elif key == "faq":
        await open_faq(user_id=uid, chat_id=chat_id, bot=bot, callback=callback)
    elif key == "upgrade":
        await open_upgrade(user_id=uid, chat_id=chat_id, bot=bot, callback=callback)
    elif key == "upgrade_after_profile":
        await open_upgrade(user_id=uid, chat_id=chat_id, bot=bot, callback=callback, source="after_profile")
    elif key in ("back_to_program_tariff", "back_to_profile_done"):
        # –í–æ–∑–≤—Ä–∞—Ç –Ω–∞ —ç–∫—Ä–∞–Ω ¬´–ü—Ä–æ—Ñ–∏–ª—å –≥–æ—Ç–æ–≤!¬ª –∏–∑ —Ç–∞—Ä–∏—Ñ–æ–≤ –∏–ª–∏ –ø—Ä–æ–±–Ω–æ–≥–æ
        await _show_profile_done_screen(callback, uid)
    else:
        await show_main_menu(bot, chat_id, uid)

    await callback.answer()


# =========================
# –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (ReplyKeyboard)
# =========================
async def open_payment_from_reply(message: Message, state: FSMContext, bot: Bot):
    await ensure_user(message.from_user.id, message.from_user.username or "")
    await state.clear()

    uid = message.from_user.id
    a = await get_access(uid)

    if await is_access_active(uid):
        tariff = a.get("tariff", "")
        if tariff in FULL_ACCESS_TARIFFS:
            text = f"–£ —Ç–µ–±—è –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø.\n{access_status_str(a)}"
            await clean_send(bot, message.chat.id, uid, text)
        else:
            # –ë–∞–∑–æ–≤—ã–π —Ç–∞—Ä–∏—Ñ (trial –∏–ª–∏ t1) ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ª–∏–Ω–µ–π–∫—É —Ç–∞—Ä–∏—Ñ–æ–≤
            await open_upgrade(uid, message.chat.id, bot)
    else:
        # –ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ ‚Äî —Å—Ä–∞–∑—É –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ª–∏–Ω–µ–π–∫—É —Ç–∞—Ä–∏—Ñ–æ–≤
        await open_upgrade(uid, message.chat.id, bot)

    await try_delete_user_message(bot, message)


def _profile_summary_text(u: dict) -> str:
    return (
        "‚öôÔ∏è –ü—Ä–æ—Ñ–∏–ª—å\n\n"
        f"–¶–µ–ª—å: {u.get('goal')}\n"
        f"–ü–æ–ª: {u.get('sex')}\n"
        f"–í–æ–∑—Ä–∞—Å—Ç: {u.get('age')}\n"
        f"–†–æ—Å—Ç: {u.get('height')}\n"
        f"–í–µ—Å: {u.get('weight')}\n"
        f"–ì–¥–µ —Ç—Ä–µ–Ω–∏—Ä—É–µ—à—å—Å—è: {u.get('place')}\n"
        f"–û–ø—ã—Ç: {u.get('exp')}\n"
        f"–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏: {u.get('freq')}√ó/–Ω–µ–¥\n"
        f"–ï–¥–∞: {u.get('meals')}√ó/–¥–µ–Ω—å\n"
        f"–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è: {(u.get('limits') or '–Ω–µ—Ç')}"
    )


async def open_profile_from_reply(message: Message, state: FSMContext, bot: Bot):
    await ensure_user(message.from_user.id, message.from_user.username or "")
    await try_delete_user_message(bot, message)
    await state.clear()

    u = await get_user(message.from_user.id)
    if await ensure_profile_ready(message.from_user.id):
        await _send_with_image(bot, message.chat.id, message.from_user.id, _profile_summary_text(u), "profile", reply_markup=profile_ready_kb())
        return

    await state.set_state(ProfileWizard.goal)
    text = _profile_header(1) + "–ù–∞—Å—Ç—Ä–æ–∏–º –ø—Ä–æ—Ñ–∏–ª—å.\n\nüéØ –¶–µ–ª—å?"
    await _send_with_image(bot, message.chat.id, message.from_user.id, text, "profile", reply_markup=kb_goal())


async def cb_profile_edit(callback: CallbackQuery, state: FSMContext):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–µ–Ω—é –≤—ã–±–æ—Ä–∞ ‚Äî —á—Ç–æ –∏–º–µ–Ω–Ω–æ –º–µ–Ω—è—Ç—å –≤ –ø—Ä–æ—Ñ–∏–ª–µ."""
    await state.clear()
    uid = callback.from_user.id
    u = await get_user(uid)
    regens_left, is_unlimited = await get_plan_regens(uid)

    # –ï—Å–ª–∏ –ª–∏–º–∏—Ç –∏—Å—á–µ—Ä–ø–∞–Ω ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥–ª—É—à–∫—É —Å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ–º –∞–ø–≥—Ä–µ–π–¥–∞
    if not is_unlimited and regens_left is not None and int(regens_left) <= 0:
        a = await get_access(uid)
        tariff_name = TARIFFS.get(a.get("tariff", ""), {}).get("title", "—Ç–µ–∫—É—â–∏–π")
        await clean_edit(callback, uid,
            f"‚ö†Ô∏è –õ–∏–º–∏—Ç —Å–º–µ–Ω—ã –ø–ª–∞–Ω–∞ –∏—Å—á–µ—Ä–ø–∞–Ω.\n\n"
            f"–¢–≤–æ–π —Ç–∞—Ä–∏—Ñ: {tariff_name}\n"
            "–ß—Ç–æ–±—ã –º–µ–Ω—è—Ç—å –ø–ª–∞–Ω —á–∞—â–µ ‚Äî –æ–±–Ω–æ–≤–∏ –ø–æ–¥–ø–∏—Å–∫—É üëá",
            reply_markup=InlineKeyboardMarkup(inline_keyboard=[
                [InlineKeyboardButton(text="üí≥ –¢–∞—Ä–∏—Ñ—ã", callback_data="nav:upgrade")],
                [InlineKeyboardButton(text="‚¨ÖÔ∏è –ù–∞–∑–∞–¥", callback_data="nav:menu")],
            ])
        )
        await callback.answer()
        return

    if is_unlimited:
        regens_str = "–±–µ–∑–ª–∏–º–∏—Ç"
    elif regens_left is not None:
        regens_str = f"–æ—Å—Ç–∞–ª–æ—Å—å: {regens_left}"
    else:
        regens_str = ""

    text = (
        "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è\n\n"
        "–í—ã–±–µ—Ä–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä ‚Äî –≤–≤–µ–¥–∏ –Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ.\n"
        "–ö–æ–≥–¥–∞ –≤—Å—ë –≥–æ—Ç–æ–≤–æ ‚Äî –Ω–∞–∂–º–∏ ¬´–°–æ—Å—Ç–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –ø–ª–∞–Ω¬ª."
    )
    if regens_str:
        text += f"\n\nüîÑ –°–º–µ–Ω –ø–ª–∞–Ω–∞: {regens_str}"
    await clean_edit(callback, uid, text, reply_markup=profile_edit_field_kb(u, regens_str))
    await callback.answer()


async def cb_rebuild_plan(callback: CallbackQuery, bot: Bot):
    """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –Ω–æ–≤—ã–π –ø–ª–∞–Ω —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è —Å —É—á—ë—Ç–æ–º –ª–∏–º–∏—Ç–∞."""
    uid = callback.from_user.id

    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –∞–∫—Ç–∏–≤–Ω—ã–π –¥–æ—Å—Ç—É–ø
    if not await is_access_active(uid):
        await callback.answer("üîí –ù—É–∂–µ–Ω –∞–∫—Ç–∏–≤–Ω—ã–π —Ç–∞—Ä–∏—Ñ.", show_alert=True)
        return

    if not await ensure_profile_ready(uid):
        await clean_edit(callback, uid, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞–ø–æ–ª–Ω–∏ –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª–Ω–æ—Å—Ç—å—é.")
        await callback.answer()
        return

    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–∏–º–∏—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
    regens_left, is_unlimited = await get_plan_regens(uid)
    if not is_unlimited and regens_left is not None and int(regens_left) <= 0:
        a = await get_access(uid)
        tariff_name = TARIFFS.get(a.get("tariff", ""), {}).get("title", "—Ç–µ–∫—É—â–∏–π")
        await clean_edit(callback, uid,
            f"‚ö†Ô∏è –õ–∏–º–∏—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –ø–ª–∞–Ω–∞ –∏—Å—á–µ—Ä–ø–∞–Ω.\n\n–¢–∞—Ä–∏—Ñ: {tariff_name}\n–ß—Ç–æ–±—ã –æ–±–Ω–æ–≤–ª—è—Ç—å –ø–ª–∞–Ω —á–∞—â–µ ‚Äî –ø–µ—Ä–µ–π–¥–∏ –≤ ¬´–û–ø–ª–∞—Ç–∞¬ª.",
            reply_markup=InlineKeyboardMarkup(inline_keyboard=[
                [InlineKeyboardButton(text="üí≥ –û–ø–ª–∞—Ç–∞", callback_data="nav:upgrade")],
                [InlineKeyboardButton(text="‚¨ÖÔ∏è –ù–∞–∑–∞–¥", callback_data="p:edit")],
            ])
        )
        await callback.answer()
        return

    await callback.answer("üîÑ –°–æ—Å—Ç–∞–≤–ª—è—é –Ω–æ–≤—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É‚Ä¶")

    import random as _rnd
    shift = _rnd.randint(1, 9999)
    varied_id = uid + shift * 100

    u = await get_user(uid)
    intro, plan_struct = generate_workout_plan(
        u["goal"], u["place"], u["exp"], int(u["freq"] or 3),
        limits=u.get("limits") or "",
        user_id=varied_id
    )
    await save_workout_plan(uid, intro, dumps_plan(plan_struct))

    # –£–º–µ–Ω—å—à–∞–µ–º —Å—á—ë—Ç—á–∏–∫ (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ –±–µ–∑–ª–∏–º–∏—Ç)
    if not is_unlimited:
        await decrement_plan_regens(uid)

    # –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –¥–Ω–µ–π
    async with db() as conn:
        await conn.execute("DELETE FROM workout_day_progress WHERE user_id=?", (uid,))
        await conn.commit()

    # –ü–æ–ª—É—á–∞–µ–º –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π —Å—á—ë—Ç—á–∏–∫ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
    regens_after, is_unlim_after = await get_plan_regens(uid)
    if is_unlim_after:
        regens_str = "–ë–µ–∑–ª–∏–º–∏—Ç"
    elif regens_after is not None:
        regens_str = f"–û—Å—Ç–∞–ª–æ—Å—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π: {regens_after}"
    else:
        regens_str = ""

    full_access = await is_full_access_active(uid)
    kb = workout_days_kb(int(u.get("freq") or plan_struct.get("freq") or 3), has_full_access=full_access, plan_struct=plan_struct)
    suffix = f"\n\n{regens_str}" if regens_str else ""
    await clean_edit(callback, uid,
        intro + "\n\n‚úÖ –ü—Ä–æ–≥—Ä–∞–º–º–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –ø–æ–¥ —Ç–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å!" + suffix,
        reply_markup=kb
    )


async def cb_profile_start_wizard(callback: CallbackQuery, state: FSMContext):
    """–ó–∞–ø—É—Å–∫ –ø—Ä–æ—Ñ–∏–ª—å-–º–∞—Å—Ç–µ—Ä–∞ –∏–∑ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è."""
    await ensure_user(callback.from_user.id, callback.from_user.username or "")
    await state.clear()

    u = await get_user(callback.from_user.id)
    if await ensure_profile_ready(callback.from_user.id):
        text = _profile_summary_text(u) + "\n\n‚úÖ –ü—Ä–æ—Ñ–∏–ª—å —É–∂–µ –∑–∞–ø–æ–ª–Ω–µ–Ω!"
        await clean_edit(callback, callback.from_user.id, text,
                         reply_markup=profile_ready_kb())
        await callback.answer()
        return

    await state.set_state(ProfileWizard.goal)
    text = _profile_header(1) + "–ù–∞—Å—Ç—Ä–æ–∏–º –ø—Ä–æ—Ñ–∏–ª—å.\n\nüéØ –¶–µ–ª—å?"
    await clean_edit(callback, callback.from_user.id, text, reply_markup=kb_goal())
    await callback.answer()


async def open_support_from_reply(message: Message, state: FSMContext, bot: Bot):
    await ensure_user(message.from_user.id, message.from_user.username or "")
    await state.clear()
    text = "–ü–æ–¥–¥–µ—Ä–∂–∫–∞\n\n–ù–∞–ø–∏—à–∏ –ø—Ä–æ–±–ª–µ–º—É ‚Äî –æ–¥–Ω–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º.\n–ú–æ–∂–Ω–æ –ø—Ä–∏–ª–æ–∂–∏—Ç—å —Å–∫—Ä–∏–Ω—à–æ—Ç."
    await clean_send(bot, message.chat.id, message.from_user.id, text)
    await try_delete_user_message(bot, message)


async def open_menu_from_reply(message: Message, state: FSMContext, bot: Bot):
    await ensure_user(message.from_user.id, message.from_user.username or "")
    await state.clear()
    await show_main_menu(bot, message.chat.id, message.from_user.id)
    await try_delete_user_message(bot, message)


# =========================
# –ü–†–û–§–ò–õ–¨-–ú–ê–°–¢–ï–†
# =========================
async def _show_profile_done_screen(callback: CallbackQuery, uid: int) -> None:
    """–ï–¥–∏–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä —ç–∫—Ä–∞–Ω–∞ '–ü—Ä–æ—Ñ–∏–ª—å –≥–æ—Ç–æ–≤!' —Å –≤—ã–±–æ—Ä–æ–º —Ç–∞—Ä–∏—Ñ–∞."""
    text = (
        "üöÄ –ü—Ä–æ—Ñ–∏–ª—å –≥–æ—Ç–æ–≤!\n\n"
        "–í—ã–±–µ—Ä–∏ —Ñ–æ—Ä–º–∞—Ç –¥–æ—Å—Ç—É–ø–∞:\n\n"
        f"üü¢ –ü—Ä–æ–±–Ω—ã–π –¥–æ—Å—Ç—É–ø ‚Äî {TARIFFS['trial']['price']}‚ÇΩ\n"
        "‚Ä¢ 3 –¥–Ω—è\n"
        "‚Ä¢ –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ + –æ—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã\n"
        "‚Ä¢ –ë–µ–∑ –ø–∏—Ç–∞–Ω–∏—è –∏ –¥–Ω–µ–≤–Ω–∏–∫–∞\n\n"
        "–ò–ª–∏ –ø–æ—Å–º–æ—Ç—Ä–∏ –ø–æ–ª–Ω—É—é –ª–∏–Ω–µ–π–∫—É —Ç–∞—Ä–∏—Ñ–æ–≤ üëá"
    )
    await clean_edit(callback, uid, text, reply_markup=build_program_tariff_kb())


async def cb_build_program(callback: CallbackQuery, state: FSMContext, bot: Bot):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–∞—Ä–∏—Ñ—ã –ø–æ—Å–ª–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è."""
    await state.clear()
    uid = callback.from_user.id

    if not await ensure_profile_ready(uid):
        await clean_edit(callback, uid,
                         "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞–ø–æ–ª–Ω–∏ –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª–Ω–æ—Å—Ç—å—é.",
                         reply_markup=profile_done_kb())
        await callback.answer()
        return

    await _show_profile_done_screen(callback, uid)
    await callback.answer()


async def cb_profile_field_edit(callback: CallbackQuery, state: FSMContext):
    """–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –Ω–∞–∂–∞—Ç–∏–µ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –ø–æ–ª–µ –ø—Ä–æ—Ñ–∏–ª—è –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è."""
    field = callback.data.split("pf:", 1)[1]
    uid = callback.from_user.id
    u = await get_user(uid)

    await state.update_data(editing_field=field)

    if field == "goal":
        await state.set_state(ProfileWizard.goal)
        text = "–í—ã–±–µ—Ä–∏ –Ω–æ–≤—É—é —Ü–µ–ª—å:"
        kb = InlineKeyboardMarkup(inline_keyboard=[
            [InlineKeyboardButton(text="üí™ –ú–∞—Å—Å–∞", callback_data="p:goal:mass"),
             InlineKeyboardButton(text="üî• –°—É—à–∫–∞", callback_data="p:goal:cut")],
            [InlineKeyboardButton(text="üèãÔ∏è –°–∏–ª–∞", callback_data="p:goal:strength"),
             InlineKeyboardButton(text="üèÉ –í—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å", callback_data="p:goal:endurance")],
            [InlineKeyboardButton(text="‚¨ÖÔ∏è –ù–∞–∑–∞–¥", callback_data="p:edit")],
        ])
        await clean_edit(callback, uid, text, reply_markup=kb)
    elif field == "sex":
        await state.set_state(ProfileWizard.sex)
        text = "–í—ã–±–µ—Ä–∏ –ø–æ–ª:"
        kb = InlineKeyboardMarkup(inline_keyboard=[
            [InlineKeyboardButton(text="üë® –ú—É–∂—á–∏–Ω–∞", callback_data="p:sex:m"),
             InlineKeyboardButton(text="üë© –ñ–µ–Ω—â–∏–Ω–∞", callback_data="p:sex:f")],
            [InlineKeyboardButton(text="‚¨ÖÔ∏è –ù–∞–∑–∞–¥", callback_data="p:edit")],
        ])
        await clean_edit(callback, uid, text, reply_markup=kb)
    elif field == "age":
        await state.set_state(ProfileFieldEdit.age)
        text = f"–¢–µ–∫—É—â–∏–π –≤–æ–∑—Ä–∞—Å—Ç: {u.get('age')}\n–í–≤–µ–¥–∏ –Ω–æ–≤—ã–π:"
        await clean_edit(callback, uid, text, reply_markup=InlineKeyboardMarkup(inline_keyboard=[
            [InlineKeyboardButton(text="‚¨ÖÔ∏è –ù–∞–∑–∞–¥", callback_data="p:edit")]
        ]))
    elif field == "height":
        await state.set_state(ProfileFieldEdit.height)
        text = f"–¢–µ–∫—É—â–∏–π —Ä–æ—Å—Ç: {u.get('height')} —Å–º\n–í–≤–µ–¥–∏ –Ω–æ–≤—ã–π:"
        await clean_edit(callback, uid, text, reply_markup=InlineKeyboardMarkup(inline_keyboard=[
            [InlineKeyboardButton(text="‚¨ÖÔ∏è –ù–∞–∑–∞–¥", callback_data="p:edit")]
        ]))
    elif field == "weight":
        await state.set_state(ProfileFieldEdit.weight)
        text = f"–¢–µ–∫—É—â–∏–π –≤–µ—Å: {u.get('weight')} –∫–≥\n–í–≤–µ–¥–∏ –Ω–æ–≤—ã–π:"
        await clean_edit(callback, uid, text, reply_markup=InlineKeyboardMarkup(inline_keyboard=[
            [InlineKeyboardButton(text="‚¨ÖÔ∏è –ù–∞–∑–∞–¥", callback_data="p:edit")]
        ]))
    elif field == "place":
        await state.set_state(ProfileWizard.place)
        text = "–ì–¥–µ —Ç—Ä–µ–Ω–∏—Ä—É–µ—à—å—Å—è?"
        kb = InlineKeyboardMarkup(inline_keyboard=[
            [InlineKeyboardButton(text="üè† –î–æ–º–∞", callback_data="p:place:bodyweight"),
             InlineKeyboardButton(text="üèãÔ∏è –í –∑–∞–ª–µ", callback_data="p:place:gym")],
            [InlineKeyboardButton(text="‚¨ÖÔ∏è –ù–∞–∑–∞–¥", callback_data="p:edit")],
        ])
        await clean_edit(callback, uid, text, reply_markup=kb)
    elif field == "exp":
        await state.set_state(ProfileWizard.exp)
        text = "–û–ø—ã—Ç —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫?"
        kb = InlineKeyboardMarkup(inline_keyboard=[
            [InlineKeyboardButton(text="0 (–Ω–æ–≤–∏—á–æ–∫)", callback_data="p:exp:0")],
            [InlineKeyboardButton(text="1‚Äì2 –≥–æ–¥–∞", callback_data="p:exp:mid"),
             InlineKeyboardButton(text="2+ –≥–æ–¥–∞", callback_data="p:exp:adv")],
            [InlineKeyboardButton(text="‚¨ÖÔ∏è –ù–∞–∑–∞–¥", callback_data="p:edit")],
        ])
        await clean_edit(callback, uid, text, reply_markup=kb)
    elif field == "freq":
        await state.set_state(ProfileWizard.freq)
        text = "–°–∫–æ–ª—å–∫–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –≤ –Ω–µ–¥–µ–ª—é?"
        kb = InlineKeyboardMarkup(inline_keyboard=[
            [InlineKeyboardButton(text="3√ó/–Ω–µ–¥", callback_data="p:freq:3"),
             InlineKeyboardButton(text="4√ó/–Ω–µ–¥", callback_data="p:freq:4")],
            [InlineKeyboardButton(text="5√ó/–Ω–µ–¥", callback_data="p:freq:5")],
            [InlineKeyboardButton(text="‚¨ÖÔ∏è –ù–∞–∑–∞–¥", callback_data="p:edit")],
        ])
        await clean_edit(callback, uid, text, reply_markup=kb)
    elif field == "meals":
        await state.set_state(ProfileWizard.meals)
        text = "–°–∫–æ–ª—å–∫–æ —Ä–∞–∑ –≤ –¥–µ–Ω—å —É–¥–æ–±–Ω–æ –µ—Å—Ç—å?"
        kb = InlineKeyboardMarkup(inline_keyboard=[
            [InlineKeyboardButton(text="3 —Ä–∞–∑–∞", callback_data="p:meals:3"),
             InlineKeyboardButton(text="4 —Ä–∞–∑–∞", callback_data="p:meals:4")],
            [InlineKeyboardButton(text="5 —Ä–∞–∑", callback_data="p:meals:5")],
            [InlineKeyboardButton(text="‚¨ÖÔ∏è –ù–∞–∑–∞–¥", callback_data="p:edit")],
        ])
        await clean_edit(callback, uid, text, reply_markup=kb)
    elif field == "limits":
        await state.set_state(ProfileFieldEdit.limits)
        text = f"–¢–µ–∫—É—â–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è: {u.get('limits') or '–Ω–µ—Ç'}\n–í–≤–µ–¥–∏ –Ω–æ–≤—ã–µ (–∏–ª–∏ ¬´–Ω–µ—Ç¬ª):"
        await clean_edit(callback, uid, text, reply_markup=InlineKeyboardMarkup(inline_keyboard=[
            [InlineKeyboardButton(text="‚¨ÖÔ∏è –ù–∞–∑–∞–¥", callback_data="p:edit")]
        ]))

    await callback.answer()


async def _finish_field_edit(bot: Bot, chat_id: int, user_id: int):
    """–ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ–¥–Ω–æ–≥–æ –ø–æ–ª—è ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ—Ñ–∏–ª—å –±–µ–∑ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏ –ø–ª–∞–Ω–∞.
    –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ '–°–æ—Å—Ç–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –ø–ª–∞–Ω'."""
    u = await get_user(user_id)
    regens_left, is_unlimited = await get_plan_regens(user_id)
    if is_unlimited:
        regens_str = "–±–µ–∑–ª–∏–º–∏—Ç"
    elif regens_left is not None:
        regens_str = f"–æ—Å—Ç–∞–ª–æ—Å—å: {regens_left}"
    else:
        regens_str = ""
    text = _profile_summary_text(u) + "\n\n–ü–∞—Ä–∞–º–µ—Ç—Ä —Å–æ—Ö—Ä–∞–Ω—ë–Ω.\n–ù–∞–∂–º–∏ ¬´–°–æ—Å—Ç–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –ø–ª–∞–Ω¬ª, —á—Ç–æ–±—ã –æ–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É."
    if regens_str:
        text += f"\nüîÑ –°–º–µ–Ω –ø–ª–∞–Ω–∞: {regens_str}"
    await clean_send(bot, chat_id, user_id, text, reply_markup=profile_edit_field_kb(u, regens_str))


async def profile_field_age(message: Message, state: FSMContext, bot: Bot):
    age = _parse_int_from_text(message.text or "")
    if age is None or age < 10 or age > 90:
        await message.answer("–í–æ–∑—Ä–∞—Å—Ç —á–∏—Å–ª–æ–º üôÇ –ù–∞–ø—Ä–∏–º–µ—Ä: 23")
        await try_delete_user_message(bot, message)
        return
    await update_user(message.from_user.id, age=age)
    await state.clear()
    await try_delete_user_message(bot, message)
    await _finish_field_edit(bot, message.chat.id, message.from_user.id)


async def profile_field_height(message: Message, state: FSMContext, bot: Bot):
    h = _parse_int_from_text(message.text or "")
    if h is None or h < 120 or h > 230:
        await message.answer("–†–æ—Å—Ç –≤ —Å–º üôÇ –ù–∞–ø—Ä–∏–º–µ—Ä: 178")
        await try_delete_user_message(bot, message)
        return
    await update_user(message.from_user.id, height=h)
    await state.clear()
    await try_delete_user_message(bot, message)
    await _finish_field_edit(bot, message.chat.id, message.from_user.id)


async def profile_field_weight(message: Message, state: FSMContext, bot: Bot):
    w = _parse_float_from_text(message.text or "")
    if w is None or w < 30 or w > 250:
        await message.answer("–í–µ—Å –≤ –∫–≥ üôÇ –ù–∞–ø—Ä–∏–º–µ—Ä: 72.5")
        await try_delete_user_message(bot, message)
        return
    await update_user(message.from_user.id, weight=w)
    await state.clear()
    await try_delete_user_message(bot, message)
    await _finish_field_edit(bot, message.chat.id, message.from_user.id)


async def profile_field_limits(message: Message, state: FSMContext, bot: Bot):
    limits = (message.text or "").strip()
    if not limits:
        await message.answer("–ù–∞–ø–∏—à–∏ —Ç–µ–∫—Å—Ç–æ–º –∏–ª–∏ ¬´–Ω–µ—Ç¬ª.")
        await try_delete_user_message(bot, message)
        return
    if limits.lower() in ("–Ω–µ—Ç", "–Ω–µ—Ç—É", "–Ω–∏–∫–∞–∫–∏—Ö", "no"):
        limits = ""
    await update_user(message.from_user.id, limits=limits)
    await state.clear()
    await try_delete_user_message(bot, message)
    await _finish_field_edit(bot, message.chat.id, message.from_user.id)


async def cb_profile_back(callback: CallbackQuery, state: FSMContext):
    step = callback.data.split(":")[2]
    uid = callback.from_user.id

    if step == "goal":
        await state.set_state(ProfileWizard.goal)
        text = _profile_header(1) + "üéØ –¶–µ–ª—å?"
        await clean_edit(callback, uid, text, reply_markup=kb_goal())
    elif step == "sex":
        await state.set_state(ProfileWizard.sex)
        text = _profile_header(2) + "üë§ –ü–æ–ª?"
        await clean_edit(callback, uid, text, reply_markup=kb_sex())
    elif step == "age":
        await state.set_state(ProfileWizard.age)
        text = _profile_header(3) + "üéÇ –í–æ–∑—Ä–∞—Å—Ç (—á–∏—Å–ª–æ–º):"
        await clean_edit(callback, uid, text, reply_markup=kb_text_step("sex"))
    elif step == "height":
        await state.set_state(ProfileWizard.height)
        text = _profile_header(4) + "üìè –†–æ—Å—Ç –≤ —Å–º:"
        await clean_edit(callback, uid, text, reply_markup=kb_text_step("age"))
    elif step == "weight":
        await state.set_state(ProfileWizard.weight)
        text = _profile_header(5) + "‚öñÔ∏è –í–µ—Å –≤ –∫–≥:"
        await clean_edit(callback, uid, text, reply_markup=kb_text_step("height"))
    elif step == "place":
        await state.set_state(ProfileWizard.place)
        text = _profile_header(6) + "üè† –ì–¥–µ —Ç—Ä–µ–Ω–∏—Ä—É–µ—à—å—Å—è?"
        await clean_edit(callback, uid, text, reply_markup=kb_place())
    elif step == "exp":
        await state.set_state(ProfileWizard.exp)
        text = _profile_header(7) + "üìà –û–ø—ã—Ç?"
        await clean_edit(callback, uid, text, reply_markup=kb_exp())
    elif step == "freq":
        await state.set_state(ProfileWizard.freq)
        text = _profile_header(8) + "üìÖ –°–∫–æ–ª—å–∫–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –≤ –Ω–µ–¥–µ–ª—é?"
        await clean_edit(callback, uid, text, reply_markup=kb_freq())
    elif step == "meals":
        await state.set_state(ProfileWizard.meals)
        text = _profile_header(9) + "üçΩ –°–∫–æ–ª—å–∫–æ —Ä–∞–∑ –≤ –¥–µ–Ω—å —É–¥–æ–±–Ω–æ –µ—Å—Ç—å?"
        await clean_edit(callback, uid, text, reply_markup=kb_meals())
    elif step == "limits":
        await state.set_state(ProfileWizard.limits)
        text = _profile_header(10) + "‚õîÔ∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è/—Ç—Ä–∞–≤–º—ã? (–∏–ª–∏ ¬´–Ω–µ—Ç¬ª):"
        await clean_edit(callback, uid, text, reply_markup=kb_text_step("meals"))
    else:
        await clean_send(callback.bot, callback.message.chat.id, uid, "üè† –ú–µ–Ω—é", reply_markup=menu_main_inline_kb())

    await callback.answer()


async def cb_profile_goal(callback: CallbackQuery, state: FSMContext, bot: Bot):
    v = callback.data.split(":")[2]
    goal = {
        "mass": "–º–∞—Å—Å–∞",
        "cut": "—Å—É—à–∫–∞",
        "strength": "—Å–∏–ª–∞",
        "endurance": "–≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å",
    }.get(v, v)

    await update_user(callback.from_user.id, goal=goal)

    data = await state.get_data()
    if data.get("editing_field") == "goal":
        await state.clear()
        await _finish_field_edit(bot, callback.message.chat.id, callback.from_user.id)
        await callback.answer()
        return

    await state.set_state(ProfileWizard.sex)
    text = _profile_header(2) + "üë§ –ü–æ–ª?"
    await clean_edit(callback, callback.from_user.id, text, reply_markup=kb_sex())
    await callback.answer()


async def cb_profile_sex(callback: CallbackQuery, state: FSMContext, bot: Bot):
    v = callback.data.split(":")[2]
    sex = "–º" if v == "m" else "–∂"
    await update_user(callback.from_user.id, sex=sex)

    data = await state.get_data()
    if data.get("editing_field") == "sex":
        await state.clear()
        await _finish_field_edit(bot, callback.message.chat.id, callback.from_user.id)
        await callback.answer()
        return

    await state.set_state(ProfileWizard.age)
    text = _profile_header(3) + "üéÇ –í–æ–∑—Ä–∞—Å—Ç (—á–∏—Å–ª–æ–º):"
    await clean_edit(callback, callback.from_user.id, text, reply_markup=kb_text_step("sex"))
    await callback.answer()


def _parse_int_from_text(s: str) -> Optional[int]:
    s = (s or "").strip()
    m = re.search(r"(\d+)", s)
    if not m:
        return None
    try:
        return int(m.group(1))
    except Exception:
        return None


def _parse_float_from_text(s: str) -> Optional[float]:
    s = (s or "").strip().replace(",", ".")
    m = re.search(r"(\d+(\.*\d+)?)", s)
    if not m:
        return None
    try:
        return float(m.group(1))
    except Exception:
        return None


async def profile_age_text(message: Message, state: FSMContext, bot: Bot):
    age = _parse_int_from_text(message.text or "")
    if age is None or age < 10 or age > 90:
        await message.answer("–í–æ–∑—Ä–∞—Å—Ç —á–∏—Å–ª–æ–º üôÇ –ù–∞–ø—Ä–∏–º–µ—Ä: 23")
        await try_delete_user_message(bot, message)
        return
    await update_user(message.from_user.id, age=age)

    await state.set_state(ProfileWizard.height)
    text = _profile_header(4) + "üìè –†–æ—Å—Ç –≤ —Å–º:"
    await clean_send(bot, message.chat.id, message.from_user.id, text, reply_markup=kb_text_step("age"))
    await try_delete_user_message(bot, message)


async def profile_height_text(message: Message, state: FSMContext, bot: Bot):
    h = _parse_int_from_text(message.text or "")
    if h is None or h < 120 or h > 230:
        await message.answer("–†–æ—Å—Ç –≤ —Å–º üôÇ –ù–∞–ø—Ä–∏–º–µ—Ä: 178")
        await try_delete_user_message(bot, message)
        return
    await update_user(message.from_user.id, height=h)

    await state.set_state(ProfileWizard.weight)
    text = _profile_header(5) + "‚öñÔ∏è –í–µ—Å –≤ –∫–≥:"
    await clean_send(bot, message.chat.id, message.from_user.id, text, reply_markup=kb_text_step("height"))
    await try_delete_user_message(bot, message)


async def profile_weight_text(message: Message, state: FSMContext, bot: Bot):
    w = _parse_float_from_text(message.text or "")
    if w is None or w < 30 or w > 250:
        await message.answer("–í–µ—Å –≤ –∫–≥ üôÇ –ù–∞–ø—Ä–∏–º–µ—Ä: 72.5")
        await try_delete_user_message(bot, message)
        return
    await update_user(message.from_user.id, weight=w)

    await state.set_state(ProfileWizard.place)
    text = _profile_header(6) + "üè† –ì–¥–µ —Ç—Ä–µ–Ω–∏—Ä—É–µ—à—å—Å—è?"
    await clean_send(bot, message.chat.id, message.from_user.id, text, reply_markup=kb_place())
    await try_delete_user_message(bot, message)


async def cb_profile_place(callback: CallbackQuery, state: FSMContext, bot: Bot):
    v = callback.data.split(":")[2]
    place = "–¥–æ–º–∞" if v == "bodyweight" else "–∑–∞–ª"
    await update_user(callback.from_user.id, place=place)

    data = await state.get_data()
    if data.get("editing_field") == "place":
        await state.clear()
        await _finish_field_edit(bot, callback.message.chat.id, callback.from_user.id)
        await callback.answer()
        return

    await state.set_state(ProfileWizard.exp)
    text = _profile_header(7) + "üìà –û–ø—ã—Ç?"
    await clean_edit(callback, callback.from_user.id, text, reply_markup=kb_exp())
    await callback.answer()


async def cb_profile_exp(callback: CallbackQuery, state: FSMContext, bot: Bot):
    v = callback.data.split(":")[2]
    if v == "0":
        await update_user(callback.from_user.id, exp="0", freq=3)

        data = await state.get_data()
        if data.get("editing_field") in ("exp", "freq"):
            await state.clear()
            await _finish_field_edit(bot, callback.message.chat.id, callback.from_user.id)
            await callback.answer()
            return

        await state.set_state(ProfileWizard.meals)
        text = _profile_header(9) + "üçΩ –°–∫–æ–ª—å–∫–æ —Ä–∞–∑ –≤ –¥–µ–Ω—å —É–¥–æ–±–Ω–æ –µ—Å—Ç—å?"
        await clean_edit(callback, callback.from_user.id, text, reply_markup=kb_meals())
        await callback.answer()
        return

    exp_text = "1-2 –≥–æ–¥–∞" if v == "mid" else "2+ –≥–æ–¥–∞"
    await update_user(callback.from_user.id, exp=exp_text)

    data = await state.get_data()
    if data.get("editing_field") == "exp":
        await state.clear()
        await _finish_field_edit(bot, callback.message.chat.id, callback.from_user.id)
        await callback.answer()
        return

    await state.set_state(ProfileWizard.freq)
    text = _profile_header(8) + "üìÖ –°–∫–æ–ª—å–∫–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –≤ –Ω–µ–¥–µ–ª—é?"
    await clean_edit(callback, callback.from_user.id, text, reply_markup=kb_freq())
    await callback.answer()


async def cb_profile_freq(callback: CallbackQuery, state: FSMContext, bot: Bot):
    f = int(callback.data.split(":")[2])
    await update_user(callback.from_user.id, freq=f)

    data = await state.get_data()
    if data.get("editing_field") == "freq":
        await state.clear()
        await _finish_field_edit(bot, callback.message.chat.id, callback.from_user.id)
        await callback.answer()
        return

    await state.set_state(ProfileWizard.meals)
    text = _profile_header(9) + "üçΩ –°–∫–æ–ª—å–∫–æ —Ä–∞–∑ –≤ –¥–µ–Ω—å —É–¥–æ–±–Ω–æ –µ—Å—Ç—å?"
    await clean_edit(callback, callback.from_user.id, text, reply_markup=kb_meals())
    await callback.answer()


async def cb_profile_meals(callback: CallbackQuery, state: FSMContext, bot: Bot):
    m = int(callback.data.split(":")[2])
    m = max(3, min(m, 5))
    await update_user(callback.from_user.id, meals=m)

    data = await state.get_data()
    if data.get("editing_field") == "meals":
        await state.clear()
        await _finish_field_edit(bot, callback.message.chat.id, callback.from_user.id)
        await callback.answer()
        return

    await state.set_state(ProfileWizard.limits)
    text = _profile_header(10) + "‚õîÔ∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è/—Ç—Ä–∞–≤–º—ã? (–∏–ª–∏ ¬´–Ω–µ—Ç¬ª):"
    await clean_edit(callback, callback.from_user.id, text, reply_markup=kb_text_step("meals"))
    await callback.answer()


async def profile_limits_text(message: Message, state: FSMContext, bot: Bot):
    limits = (message.text or "").strip()
    if not limits:
        await message.answer("–ù–∞–ø–∏—à–∏ —Ç–µ–∫—Å—Ç–æ–º –∏–ª–∏ ¬´–Ω–µ—Ç¬ª.")
        await try_delete_user_message(bot, message)
        return
    if limits.lower() in ("–Ω–µ—Ç", "–Ω–µ—Ç—É", "–Ω–∏–∫–∞–∫–∏—Ö", "no"):
        limits = ""

    await update_user(message.from_user.id, limits=limits)
    await state.clear()

    u = await get_user(message.from_user.id)
    summary = (
        "‚úÖ –ü—Ä–æ—Ñ–∏–ª—å —Å–æ—Ö—Ä–∞–Ω—ë–Ω!\n\n"
        f"–¶–µ–ª—å: {u.get('goal')} ‚Ä¢ {u.get('freq')}√ó/–Ω–µ–¥\n"
        f"–ì–¥–µ —Ç—Ä–µ–Ω–∏—Ä—É–µ—à—å—Å—è: {u.get('place')}\n"
        f"–ï–¥–∞: {u.get('meals')}√ó/–¥–µ–Ω—å\n"
        f"–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è: {(u.get('limits') or '–Ω–µ—Ç')}\n\n"
        "–¢–µ–ø–µ—Ä—å –≤—ã–±–µ—Ä–∏ —Ç–∞—Ä–∏—Ñ –∏ —è —Å–æ–±–µ—Ä—É —Ç–≤–æ—é –ø—Ä–æ–≥—Ä–∞–º–º—É üëá"
    )
    await clean_send(bot, message.chat.id, message.from_user.id, summary, reply_markup=profile_done_kb())
    await try_delete_user_message(bot, message)


# =========================
# ‚úÖ –û–ü–õ–ê–¢–ê –ß–ï–†–ï–ó –Æ–ö–ê–°–°–ê REST API
# =========================
def access_status_str(a: dict) -> str:
    if not a or a.get("paid") != 1:
        return "–°—Ç–∞—Ç—É—Å: ‚ùå –¥–æ—Å—Ç—É–ø–∞ –Ω–µ—Ç"
    if a.get("tariff") == "life":
        return "–°—Ç–∞—Ç—É—Å: ‚úÖ –¥–æ—Å—Ç—É–ø –Ω–∞–≤—Å–µ–≥–¥–∞"
    exp = a.get("expires_at")
    return f"–°—Ç–∞—Ç—É—Å: ‚úÖ –¥–æ {exp[:10]}" if exp else "–°—Ç–∞—Ç—É—Å: ‚úÖ –∞–∫—Ç–∏–≤–µ–Ω"


async def yukassa_create_payment(tariff_code: str, user_id: int):
    """
    –°–æ–∑–¥–∞—ë–º –ø–ª–∞—Ç—ë–∂ —á–µ—Ä–µ–∑ –Æ–ö–∞—Å—Å–∞ REST API.
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç (data_dict, error_str). –ü—Ä–∏ —É—Å–ø–µ—Ö–µ error_str == None.
    """
    import uuid
    import base64
    import aiohttp

    t = TARIFFS[tariff_code]
    amount_str = f"{t['price']:.2f}"
    idempotence_key = str(uuid.uuid4())

    credentials = base64.b64encode(
        f"{YUKASSA_SHOP_ID}:{YUKASSA_SECRET}".encode()
    ).decode()

    return_url = BOT_PUBLIC_URL if BOT_PUBLIC_URL else "https://t.me/"

    payload = {
        "amount": {"value": amount_str, "currency": "RUB"},
        "confirmation": {"type": "redirect", "return_url": return_url},
        "capture": True,
        "description": f"Tarif {tariff_code} user_id={user_id}",
        "metadata": {"tariff": tariff_code, "user_id": str(user_id)},
    }

    try:
        logger.info(f"YooKassa: creating payment user={user_id} tariff={tariff_code} amount={amount_str}")
        logger.info(f"YooKassa: shop_id={YUKASSA_SHOP_ID[:4]}**** return_url={return_url}")
        async with aiohttp.ClientSession() as session:
            async with session.post(
                "https://api.yookassa.ru/v3/payments",
                json=payload,
                headers={
                    "Authorization": f"Basic {credentials}",
                    "Idempotence-Key": idempotence_key,
                    "Content-Type": "application/json",
                },
                timeout=aiohttp.ClientTimeout(total=20),
            ) as resp:
                data = await resp.json()
                if resp.status == 200:
                    logger.info(f"YooKassa: payment created id={data.get('id')}")
                    return data, None
                else:
                    err_code = data.get("code", "?")
                    err_desc = data.get("description", "?")
                    err_msg = f"HTTP {resp.status} | code={err_code} | {err_desc}"
                    logger.error(f"YooKassa API error: {err_msg} | full={data}")
                    return None, err_msg
    except Exception as e:
        err_msg = f"{type(e).__name__}: {e}"
        logger.error(f"YooKassa request failed: {err_msg}")
        return None, err_msg


async def yukassa_get_payment(payment_id: str) -> Optional[dict]:
    """–ü–æ–ª—É—á–∞–µ–º —Å—Ç–∞—Ç—É—Å –ø–ª–∞—Ç–µ–∂–∞ –∏–∑ –Æ–ö–∞—Å—Å–∞."""
    import base64
    import aiohttp

    credentials = base64.b64encode(
        f"{YUKASSA_SHOP_ID}:{YUKASSA_SECRET}".encode()
    ).decode()

    try:
        async with aiohttp.ClientSession() as session:
            async with session.get(
                f"https://api.yookassa.ru/v3/payments/{payment_id}",
                headers={"Authorization": f"Basic {credentials}"},
                timeout=aiohttp.ClientTimeout(total=10),
            ) as resp:
                if resp.status == 200:
                    return await resp.json()
                return None
    except Exception as e:
        logger.error(f"YooKassa get_payment failed: {e}")
        return None


async def save_yukassa_payment_id(payment_db_id: int, yukassa_id: str):
    """–°–æ—Ö—Ä–∞–Ω—è–µ–º –Æ–ö–∞—Å—Å–∞ payment_id –≤ –∫–æ–ª–æ–Ω–∫—É receipt_file_id."""
    async with db() as conn:
        await conn.execute(
            "UPDATE payments SET receipt_file_id=? WHERE id=?",
            (yukassa_id, payment_db_id)
        )
        await conn.commit()


async def cb_tariff(callback: CallbackQuery, state: FSMContext, bot: Bot):
    """
    –°–æ–∑–¥–∞—ë–º –ø–ª–∞—Ç—ë–∂ —á–µ—Ä–µ–∑ –Æ–ö–∞—Å—Å–∞ REST API –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É —Å–æ —Å—Å—ã–ª–∫–æ–π.
    –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –Æ–ö–∞—Å—Å–∞, –±–æ—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç–∞—Ç—É—Å.
    """
    parts = callback.data.split(":")
    tariff_code = parts[1]
    # from_profile=True –µ—Å–ª–∏ –ø—Ä–∏—à–ª–∏ —Å —ç–∫—Ä–∞–Ω–∞ "–ü—Ä–æ—Ñ–∏–ª—å –≥–æ—Ç–æ–≤!" ‚Äî –∫–Ω–æ–ø–∫–∞ –ù–∞–∑–∞–¥ –≤–µ–¥—ë—Ç —Ç—É–¥–∞ –∂–µ
    from_profile = len(parts) > 2 and parts[2] == "from_profile"
    back_cb = "nav:back_to_profile_done" if from_profile else "nav:upgrade"
    back_label = "‚¨ÖÔ∏è –ù–∞–∑–∞–¥" if from_profile else "‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –∫ —Ç–∞—Ä–∏—Ñ–∞–º"

    if tariff_code not in TARIFFS:
        await callback.answer("–ù–µ –ø–æ–Ω—è–ª —Ç–∞—Ä–∏—Ñ üòÖ", show_alert=True)
        return

    t = TARIFFS[tariff_code]
    uid = callback.from_user.id

    if not YUKASSA_SHOP_ID or not YUKASSA_SECRET:
        await callback.message.answer(
            "‚ö†Ô∏è –û–ø–ª–∞—Ç–∞ –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞.\n"
            "–°–≤—è–∂–∏—Ç–µ—Å—å —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π."
        )
        await callback.answer()
        return

    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ "—Å–æ–∑–¥–∞—ë–º –ø–ª–∞—Ç—ë–∂"
    await callback.answer("‚è≥ –°–æ–∑–¥–∞—é —Å—Å—ã–ª–∫—É –Ω–∞ –æ–ø–ª–∞—Ç—É‚Ä¶")

    # –°–æ–∑–¥–∞—ë–º –ø–ª–∞—Ç—ë–∂ –≤ –Æ–ö–∞—Å—Å–∞
    yk_data, yk_err = await yukassa_create_payment(tariff_code, uid)

    if not yk_data:
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏ —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
        err_detail = f"\n\nüîç –î–µ—Ç–∞–ª–∏: {yk_err}" if yk_err else ""
        # –£–≤–µ–¥–æ–º–ª—è–µ–º –∞–¥–º–∏–Ω–∞ –æ–± –æ—à–∏–±–∫–µ
        if ADMIN_ID:
            try:
                await bot.send_message(
                    ADMIN_ID,
                    f"‚ö†Ô∏è –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø–ª–∞—Ç–µ–∂–∞\nuser={uid} tariff={tariff_code}\n{yk_err}"
                )
            except Exception:
                pass
        await clean_edit(callback, uid,
            f"‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å —Å—á—ë—Ç –Ω–∞ –æ–ø–ª–∞—Ç—É.{err_detail}\n\n"
            "–ù–∞–ø–∏—à–∏ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É –∏–ª–∏ –ø–æ–ø—Ä–æ–±—É–π –ø–æ–∑–∂–µ.",
            reply_markup=InlineKeyboardMarkup(inline_keyboard=[
                [InlineKeyboardButton(text=back_label, callback_data=back_cb)]
            ])
        )
        return

    yk_payment_id = yk_data.get("id", "")
    confirmation_url = (yk_data.get("confirmation") or {}).get("confirmation_url", "")

    if not confirmation_url:
        await clean_edit(callback, uid,
            "‚ùå –ù–µ –ø–æ–ª—É—á–∏–ª —Å—Å—ã–ª–∫—É –Ω–∞ –æ–ø–ª–∞—Ç—É.\n–ü–æ–ø—Ä–æ–±—É–π –ø–æ–∑–∂–µ.",
            reply_markup=InlineKeyboardMarkup(inline_keyboard=[
                [InlineKeyboardButton(text=back_label, callback_data=back_cb)]
            ])
        )
        return

    # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –≤ –ë–î –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
    now = datetime.utcnow().isoformat()
    async with db() as conn:
        cur = await conn.execute("""
            INSERT INTO payments (user_id, tariff, amount, last4, code, status, receipt_file_id, created_at)
            VALUES (?, ?, ?, ?, ?, 'pending', ?, ?)
        """, (uid, tariff_code, t["price"], "yukassa", yk_payment_id, yk_payment_id, now))
        await conn.commit()
        payment_db_id = cur.lastrowid

    # –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
    desc = (
        "–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ + –ø–∏—Ç–∞–Ω–∏–µ + –¥–Ω–µ–≤–Ω–∏–∫ + –∑–∞–º–µ—Ä—ã"
        if tariff_code in FULL_ACCESS_TARIFFS
        else "–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ + –¥–Ω–µ–≤–Ω–∏–∫ + –∑–∞–º–µ—Ä—ã"
    )
    days_str = f"{t['days']} –¥–Ω." if t["days"] else "–±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π"

    text = (
        f"–û–ø–ª–∞—Ç–∞: {t['title']}\n\n"
        f"–°—É–º–º–∞: {t['price']}‚ÇΩ\n"
        f"–í–∫–ª—é—á–∞–µ—Ç: {desc}\n"
        f"–°—Ä–æ–∫: {days_str}\n\n"
        "–ù–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ ‚Äî –æ—Ç–∫—Ä–æ–µ—Ç—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –æ–ø–ª–∞—Ç—ã.\n"
        "–ü–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã –≤–µ—Ä–Ω–∏—Å—å –≤ –±–æ—Ç: –¥–æ—Å—Ç—É–ø –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏."
    )

    pay_kb = InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(text="üí≥ –ü–µ—Ä–µ–π—Ç–∏ –∫ –æ–ø–ª–∞—Ç–µ", url=confirmation_url)],
        [InlineKeyboardButton(text="‚úÖ –Ø –æ–ø–ª–∞—Ç–∏–ª", callback_data=f"check_pay:{yk_payment_id}:{tariff_code}")],
        [InlineKeyboardButton(text=back_label, callback_data=back_cb)],
    ])

    await clean_edit(callback, uid, text, reply_markup=pay_kb)


async def cb_check_payment(callback: CallbackQuery, bot: Bot):
    """
    –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∞–ª ¬´–Ø –æ–ø–ª–∞—Ç–∏–ª¬ª ‚Äî –ø—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å –≤ –Æ–ö–∞—Å—Å–∞ API.
    """
    parts = callback.data.split(":")
    yk_payment_id = parts[1]
    tariff_code = parts[2] if len(parts) > 2 else ""
    uid = callback.from_user.id

    await callback.answer("üîç –ü—Ä–æ–≤–µ—Ä—è—é –æ–ø–ª–∞—Ç—É‚Ä¶")

    yk_data = await yukassa_get_payment(yk_payment_id)

    if not yk_data:
        await callback.message.answer(
            "‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å.\n–ü–æ–ø—Ä–æ–±—É–π —á–µ—Ä–µ–∑ –º–∏–Ω—É—Ç—É –∏–ª–∏ –Ω–∞–ø–∏—à–∏ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É."
        )
        return

    status = yk_data.get("status", "")
    metadata = yk_data.get("metadata") or {}

    if not tariff_code:
        tariff_code = metadata.get("tariff", "")

    if status == "succeeded":
        # –û–ø–ª–∞—Ç–∞ –ø—Ä–æ—à–ª–∞ ‚Äî –≤—ã–¥–∞—ë–º –¥–æ—Å—Ç—É–ø
        if tariff_code and tariff_code in TARIFFS:
            await set_paid_tariff(uid, tariff_code)
            # –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –≤ –ë–î
            async with db() as conn:
                await conn.execute(
                    "UPDATE payments SET status='approved' WHERE receipt_file_id=? AND user_id=?",
                    (yk_payment_id, uid)
                )
                await conn.commit()

            t = TARIFFS[tariff_code]
            a = await get_access(uid)

            await clean_edit(callback, uid,
                f"‚úÖ –û–ø–ª–∞—Ç–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞!\n"
                f"–¢–∞—Ä–∏—Ñ: {t['title']}\n"
                f"{access_status_str(a)}\n\n"
                "–¢–µ–ø–µ—Ä—å –∏–¥–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å—Å—è üí™",
                reply_markup=menu_main_inline_kb()
            )

            # –£–≤–µ–¥–æ–º–ª—è–µ–º –∞–¥–º–∏–Ω–∞
            if ADMIN_ID:
                try:
                    await bot.send_message(
                        chat_id=ADMIN_ID,
                        text=(
                            f"üí∞ –û–ø–ª–∞—Ç–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞ (–Æ–ö–∞—Å—Å–∞)\n"
                            f"user_id: {uid}\n"
                            f"tariff: {tariff_code} ({t['title']})\n"
                            f"amount: {t['price']}‚ÇΩ\n"
                            f"yukassa_id: {yk_payment_id}"
                        )
                    )
                except Exception:
                    pass
        else:
            await clean_edit(callback, uid,
                "‚úÖ –û–ø–ª–∞—Ç–∞ –ø—Ä–æ—à–ª–∞! –°–≤—è–∂–∏—Ç–µ—Å—å —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏.",
                reply_markup=menu_main_inline_kb()
            )

    elif status == "pending":
        await callback.message.answer(
            "‚è≥ –ü–ª–∞—Ç—ë–∂ –µ—â—ë –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è.\n"
            "–ü–æ–¥–æ–∂–¥–∏ 1‚Äì2 –º–∏–Ω—É—Ç—ã –∏ –Ω–∞–∂–º–∏ ¬´–Ø –æ–ø–ª–∞—Ç–∏–ª¬ª —Å–Ω–æ–≤–∞."
        )
    elif status in ("canceled", "cancelled"):
        await callback.message.answer(
            "‚ùå –ü–ª–∞—Ç—ë–∂ –æ—Ç–º–µ–Ω—ë–Ω.\n"
            "–ù–∞–∂–º–∏ ¬´‚¨ÖÔ∏è –ù–∞–∑–∞–¥¬ª –∏ –ø–æ–ø—Ä–æ–±—É–π —Å–Ω–æ–≤–∞."
        )
    else:
        await callback.message.answer(
            f"‚ö†Ô∏è –°—Ç–∞—Ç—É—Å –ø–ª–∞—Ç–µ–∂–∞: {status}\n"
            "–ï—Å–ª–∏ –¥–µ–Ω—å–≥–∏ —Å–ø–∏—Å–∞–ª–∏—Å—å ‚Äî –Ω–∞–ø–∏—à–∏ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É."
        )


async def admin_actions(callback: CallbackQuery, bot: Bot):
    """–†—É—á–Ω–æ–µ –æ–¥–æ–±—Ä–µ–Ω–∏–µ/–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ (–¥–ª—è —Å–ª—É—á–∞–µ–≤ –±–µ–∑ –Æ–ö–∞—Å—Å–∞)."""
    if callback.from_user.id != ADMIN_ID:
        await callback.answer("–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞", show_alert=True)
        return

    action, pid = callback.data.split(":")
    pid = int(pid)

    p = await get_payment(pid)
    if not p:
        await callback.answer("–ü–ª–∞—Ç—ë–∂ –Ω–µ –Ω–∞–π–¥–µ–Ω", show_alert=True)
        return
    if p["status"] != "pending":
        await callback.answer(f"–£–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ: {p['status']}", show_alert=True)
        return

    user_id = p["user_id"]
    tariff = p.get("tariff")

    if action == "admin_approve":
        if tariff not in TARIFFS:
            await callback.answer("–£ –ø–ª–∞—Ç–µ–∂–∞ –Ω–µ—Ç —Ç–∞—Ä–∏—Ñ–∞", show_alert=True)
            return
        await set_payment_status(pid, "approved")
        await set_paid_tariff(user_id, tariff)

        a = await get_access(user_id)
        await bot.send_message(
            chat_id=user_id,
            text=f"‚úÖ –û–ø–ª–∞—Ç–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞.\n–¢–∞—Ä–∏—Ñ: {TARIFFS[tariff]['title']}\n{access_status_str(a)}",
            reply_markup=menu_main_inline_kb()
        )
        await callback.answer("–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ ‚úÖ")
    else:
        await set_payment_status(pid, "rejected")
        await bot.send_message(
            chat_id=user_id,
            text="‚ùå –û—Ç–∫–ª–æ–Ω–∏–ª. –ü—Ä–æ–≤–µ—Ä—å –ø–µ—Ä–µ–≤–æ–¥/—Å–∫—Ä–∏–Ω –∏ –ø–æ–ø—Ä–æ–±—É–π –µ—â—ë —Ä–∞–∑ (üí≥ –û–ø–ª–∞—Ç–∞/–¥–æ—Å—Ç—É–ø)."
        )
        await callback.answer("–û—Ç–∫–ª–æ–Ω–µ–Ω–æ ‚ùå")


# =========================
# –†–ê–ó–î–ï–õ–´
# =========================
async def ensure_profile_ready(user_id: int) -> bool:
    u = await get_user(user_id)
    need = ["goal", "sex", "age", "height", "weight", "place", "exp", "freq", "meals"]
    return not any(not u.get(k) for k in need)


async def build_plans_if_needed(user_id: int, force: bool = False):
    u = await get_user(user_id)

    intro, plan_struct = generate_workout_plan(
        u["goal"], u["place"], u["exp"], int(u["freq"]),
        limits=u.get("limits") or "",
        user_id=user_id
    )

    summary, cal, p, f, c, meals = generate_nutrition_summary(
        u["goal"], u["sex"], int(u["age"]), int(u["height"]), float(u["weight"]), u["exp"],
        freq=int(u["freq"]), place=u["place"], meals_pref=int(u.get("meals") or 0)
    )

    nutrition_full = (
        summary
        + "\n\n–ó–∞–º–µ–Ω—ã (—Ä–∞–≤–Ω–æ—Ü–µ–Ω–Ω—ã–µ):\n"
          "‚Ä¢ –∫—É—Ä–∏—Ü–∞ ‚Üî –∏–Ω–¥–µ–π–∫–∞ ‚Üî —Ä—ã–±–∞ –±–µ–ª–∞—è\n"
          "‚Ä¢ —Ä–∏—Å ‚Üî –≥—Ä–µ—á–∫–∞ ‚Üî –º–∞–∫–∞—Ä–æ–Ω—ã\n"
          "‚Ä¢ —Ç–≤–æ—Ä–æ–≥ 0% ‚Üî –≥—Ä–µ—á–µ—Å–∫–∏–π –π–æ–≥—É—Ä—Ç\n"
          "‚Ä¢ –±–∞–Ω–∞–Ω ‚Üî —è–±–ª–æ–∫–æ ‚Üî —è–≥–æ–¥—ã"
    )

    if force:
        await save_workout_plan(user_id, intro, dumps_plan(plan_struct))
        await save_nutrition_plan(user_id, nutrition_full)
        return

    plan_text, plan_json = await get_workout_plan(user_id)
    nutr_text = await get_nutrition_plan(user_id)

    if not plan_text or not plan_json:
        await save_workout_plan(user_id, intro, dumps_plan(plan_struct))
    if not nutr_text:
        await save_nutrition_plan(user_id, nutrition_full)


TRACK_EXERCISES = [
    "–ñ–∏–º –ª—ë–∂–∞",
    "–ü—Ä–∏—Å–µ–¥",
    "–û—Ç–∂–∏–º–∞–Ω–∏—è",
    "–í–µ—Ä—Ö–Ω–∏–π –±–ª–æ–∫",
    "–ü–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è",
    "–†—É–º—ã–Ω—Å–∫–∞—è —Ç—è–≥–∞",
    "–ñ–∏–º –≤–≤–µ—Ä—Ö",
    "–ñ–∏–º –Ω–æ–≥–∞–º–∏",
]


def diary_exercises_kb():
    rows = []
    for i in range(0, len(TRACK_EXERCISES), 2):
        left = InlineKeyboardButton(text=TRACK_EXERCISES[i], callback_data=f"d:ex:{TRACK_EXERCISES[i]}")
        if i + 1 < len(TRACK_EXERCISES):
            right = InlineKeyboardButton(text=TRACK_EXERCISES[i+1], callback_data=f"d:ex:{TRACK_EXERCISES[i+1]}")
            rows.append([left, right])
        else:
            rows.append([left])

    rows.append([InlineKeyboardButton(text="üìú –ò—Å—Ç–æ—Ä–∏—è", callback_data="d:history")])
    rows.append([InlineKeyboardButton(text="üè† –ú–µ–Ω—é", callback_data="nav:menu")])
    return InlineKeyboardMarkup(inline_keyboard=rows)


MEASURE_TYPES = [
    ("weight", "–í–µ—Å (–∫–≥)"),
    ("waist", "–¢–∞–ª–∏—è (—Å–º)"),
    ("arm", "–†—É–∫–∞ (—Å–º)"),
    ("chest", "–ì—Ä—É–¥—å (—Å–º)"),
    ("thigh", "–ë–µ–¥—Ä–æ (—Å–º)"),
]


def measures_kb():
    rows = []
    for i in range(0, len(MEASURE_TYPES), 2):
        k1, t1 = MEASURE_TYPES[i]
        b1 = InlineKeyboardButton(text=t1, callback_data=f"mtype:{k1}")
        if i + 1 < len(MEASURE_TYPES):
            k2, t2 = MEASURE_TYPES[i+1]
            b2 = InlineKeyboardButton(text=t2, callback_data=f"mtype:{k2}")
            rows.append([b1, b2])
        else:
            rows.append([b1])

    rows.append([InlineKeyboardButton(text="üìú –ò—Å—Ç–æ—Ä–∏—è", callback_data="m:history")])
    rows.append([InlineKeyboardButton(text="üè† –ú–µ–Ω—é", callback_data="nav:menu")])
    return InlineKeyboardMarkup(inline_keyboard=rows)


async def get_week_progress(user_id: int, freq: int) -> str:
    """–ë–ª–æ–∫ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –Ω–µ–¥–µ–ª–∏: –≤—ã–ø–æ–ª–Ω–µ–Ω–æ/–æ—Å—Ç–∞–ª–æ—Å—å."""
    today = datetime.now().date()
    # –ù–∞—á–∞–ª–æ —Ç–µ–∫—É—â–µ–π –Ω–µ–¥–µ–ª–∏ (–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫)
    week_start = today - timedelta(days=today.weekday())
    week_end = week_start + timedelta(days=6)

    async with db() as conn:
        async with conn.execute("""
            SELECT completed_date FROM workout_completions
            WHERE user_id=? AND completed_date >= ? AND completed_date <= ?
            ORDER BY completed_date
        """, (user_id, week_start.strftime("%Y-%m-%d"), week_end.strftime("%Y-%m-%d"))) as cur:
            rows = await cur.fetchall()

    # –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –¥–Ω–∏ (–æ–¥–∏–Ω –¥–µ–Ω—å = –æ–¥–Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞)
    done_dates = list(set(r[0] for r in rows))
    done_count = len(done_dates)
    remaining = max(0, freq - done_count)

    # –°—Ç—Ä–æ–∏–º –≤–∏–∑—É–∞–ª—å–Ω—É—é —Å—Ç—Ä–æ–∫—É –¥–Ω–µ–π –Ω–µ–¥–µ–ª–∏
    day_names = ["–ü–Ω", "–í—Ç", "–°—Ä", "–ß—Ç", "–ü—Ç", "–°–±", "–í—Å"]
    done_set = set(done_dates)
    day_cells = []
    for i in range(7):
        d = week_start + timedelta(days=i)
        mark = "‚úÖ" if d.strftime("%Y-%m-%d") in done_set else "‚¨ú"
        day_cells.append(f"{mark} {day_names[i]}")
    # –¢–æ–ª—å–∫–æ —Ä–∞–±–æ—á–∏–µ –¥–Ω–∏ –ø–æ freq (–ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–µ freq –¥–Ω–µ–π –∏–ª–∏ –≤—Å—é –Ω–µ–¥–µ–ª—é)
    row_str = "  ".join(day_cells)

    lines = [
        "üìä –ü—Ä–æ–≥—Ä–µ—Å—Å –Ω–µ–¥–µ–ª–∏",
        "",
        f"–í—ã–ø–æ–ª–Ω–µ–Ω–æ: {done_count}/{freq}",
        f"–û—Å—Ç–∞–ª–æ—Å—å: {remaining}",
        "",
        row_str,
    ]
    return "\n".join(lines)


async def open_workouts(user_id: int, chat_id: int, bot: Bot, callback: Optional[CallbackQuery] = None):
    if not await is_access_active(user_id):
        await clean_send(bot, chat_id, user_id, locked_text())
        return

    if not await ensure_profile_ready(user_id):
        await clean_send(bot, chat_id, user_id, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞–ø–æ–ª–Ω–∏ –ø—Ä–æ—Ñ–∏–ª—å (‚öôÔ∏è –ü—Ä–æ—Ñ–∏–ª—å).")
        return

    plan_text, plan_struct = await get_workout_plan(user_id)
    if not plan_text or not plan_struct:
        await build_plans_if_needed(user_id, force=True)
        plan_text, plan_struct = await get_workout_plan(user_id)

    u = await get_user(user_id)
    freq = int(u.get("freq") or plan_struct.get("freq") or 3)
    full_access = await is_full_access_active(user_id)
    kb = workout_days_kb(freq, has_full_access=full_access, plan_struct=plan_struct)

    week_progress = await get_week_progress(user_id, freq)
    display_text = (plan_text or "üèãÔ∏è –ü–ª–∞–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω.") + "\n\n" + week_progress

    if callback:
        await send_section(
            bot, chat_id, user_id,
            IMAGE_PATHS["workouts"], display_text, reply_markup=kb,
            callback=callback,
        )
    else:
        await send_section(
            bot, chat_id, user_id,
            IMAGE_PATHS["workouts"], display_text, reply_markup=kb,
        )


# =========================
# ‚úÖ –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –¥–Ω—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ ‚Äî —Ç–æ–ª—å–∫–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏ —Ç–µ—Ö–Ω–∏–∫–∏
# —É–±—Ä–∞–Ω—ã –∫–Ω–æ–ø–∫–∏ ¬´–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞¬ª –∏ ¬´–ú–µ–Ω—é¬ª
# =========================
def workout_day_exercises_kb(day: int, exercises: List[str], done: List[int]) -> InlineKeyboardMarkup:
    """–ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π –¥–Ω—è —Å —á–µ–∫–±–æ–∫—Å–∞–º–∏ –∏ –∫–Ω–æ–ø–∫–æ–π —Ç–µ—Ö–Ω–∏–∫–∏."""
    rows = []
    for idx, name in enumerate(exercises):
        is_done = idx in done
        short_name = name[:22] + "‚Ä¶" if len(name) > 22 else name
        if is_done:
            btn_text = f"‚úÖ {short_name}"
        else:
            btn_text = f"‚¨úÔ∏è {short_name}"

        done_btn = InlineKeyboardButton(
            text=btn_text,
            callback_data=f"wex:done:{day}:{idx}"
        )
        tech_key = get_tech_key_for_exercise(name)
        if tech_key:
            tech_btn = InlineKeyboardButton(
                text="üìö –¢–µ—Ö–Ω–∏–∫–∞",
                callback_data=f"wex:tech:{day}:{tech_key}"
            )
            rows.append([done_btn, tech_btn])
        else:
            rows.append([done_btn])

    # –¢–æ–ª—å–∫–æ –∫–Ω–æ–ø–∫–∞ ¬´–ù–∞–∑–∞–¥ –∫ –ø—Ä–æ–≥—Ä–∞–º–º–µ¬ª
    rows.append([InlineKeyboardButton(text="üìã –ü—Ä–æ–≥—Ä–∞–º–º–∞", callback_data="nav:workouts")])
    return InlineKeyboardMarkup(inline_keyboard=rows)


async def cb_workout_day(callback: CallbackQuery, bot: Bot):
    # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (–∏–∑ –≥–ª–∞–≤–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫)
    parts = callback.data.split(":")
    if len(parts) == 3 and parts[1] == "stats":
        await cb_workout_stats(callback, bot)
        return

    if not await is_access_active(callback.from_user.id):
        await clean_edit(callback, callback.from_user.id, locked_text())
        await callback.answer()
        return

    plan_text, plan_struct = await get_workout_plan(callback.from_user.id)
    if not plan_struct:
        await build_plans_if_needed(callback.from_user.id, force=True)
        plan_text, plan_struct = await get_workout_plan(callback.from_user.id)

    day = callback.data.split(":", 1)[1]
    day_text = (plan_struct.get("days") or {}).get(str(day))
    if not day_text:
        await callback.answer("–î–µ–Ω—å –Ω–µ –Ω–∞–π–¥–µ–Ω üòÖ", show_alert=True)
        return

    day_num = int(day)
    uid = callback.from_user.id

    exercises = parse_exercises_from_day_text(day_text)
    if not exercises:
        u = await get_user(uid)
        full_access = await is_full_access_active(uid)
        kb = workout_days_kb(int(u.get("freq") or plan_struct.get("freq") or 3), has_full_access=full_access, plan_struct=plan_struct)
        await clean_edit(callback, uid, day_text, reply_markup=kb)
        await callback.answer()
        return

    done = await get_day_done_exercises(uid, day_num)
    already_done_today = await is_day_completed_today(uid, day_num)

    text = build_day_display_text(day_num, day_text, exercises, done)
    if already_done_today:
        text += "\n\nüéâ –î–µ–Ω—å —É–∂–µ –∑–∞—Å—á–∏—Ç–∞–Ω —Å–µ–≥–æ–¥–Ω—è! –ú–æ–∂–µ—à—å –ø—Ä–æ–π—Ç–∏ —Å–Ω–æ–≤–∞."
    kb = workout_day_exercises_kb(day_num, exercises, done)
    await clean_edit(callback, uid, text, reply_markup=kb)
    await callback.answer()


async def cb_workout_ex_done(callback: CallbackQuery, bot: Bot):
    """–û—Ç–º–µ—á–∞–µ–º/—Å–Ω–∏–º–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è."""
    parts = callback.data.split(":")
    day_num = int(parts[2])
    ex_idx = int(parts[3])
    uid = callback.from_user.id

    if not await is_access_active(uid):
        await callback.answer("–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞", show_alert=True)
        return

    plan_text, plan_struct = await get_workout_plan(uid)
    if not plan_struct:
        await callback.answer("–ù–µ—Ç –ø–ª–∞–Ω–∞ üòÖ", show_alert=True)
        return

    day_text = (plan_struct.get("days") or {}).get(str(day_num))
    if not day_text:
        await callback.answer("–î–µ–Ω—å –Ω–µ –Ω–∞–π–¥–µ–Ω", show_alert=True)
        return

    exercises = parse_exercises_from_day_text(day_text)
    done = await get_day_done_exercises(uid, day_num)

    if ex_idx in done:
        done.remove(ex_idx)
    else:
        done.append(ex_idx)

    await set_day_done_exercises(uid, day_num, done)

    total = len(exercises)
    done_count = len(done)
    all_done = total > 0 and done_count == total

    if all_done:
        day_title = get_day_display_name(day_num, day_text)
        await mark_day_completed(uid, day_num, day_title)
        await clear_day_progress(uid, day_num)
        text = build_day_display_text(day_num, day_text, exercises, list(range(total)), all_done=True)
        kb = workout_day_exercises_kb(day_num, exercises, list(range(total)))
        await clean_edit(callback, uid, text, reply_markup=kb)
        await callback.answer("üéâ –î–µ–Ω—å –∑–∞–≤–µ—Ä—à—ë–Ω!", show_alert=True)
    else:
        text = build_day_display_text(day_num, day_text, exercises, done)
        kb = workout_day_exercises_kb(day_num, exercises, done)
        await clean_edit(callback, uid, text, reply_markup=kb)
        await callback.answer(f"{'‚úÖ' if ex_idx in done else '‚Ü©Ô∏è'} {done_count}/{total}")


async def cb_workout_stats(callback: CallbackQuery, bot: Bot):
    """–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫: –¥–Ω–∏ –ø–æ –ø–æ—Ä—è–¥–∫—É + –∑–∞–∫—Ä—ã—Ç–∏–µ –Ω–µ–¥–µ–ª–∏."""
    uid = callback.from_user.id
    async with db() as conn:
        try:
            async with conn.execute("""
                SELECT day_num, completed_date, created_at, day_title
                FROM workout_completions
                WHERE user_id=?
                ORDER BY completed_date ASC, day_num ASC, id ASC
                LIMIT 60
            """, (uid,)) as cur:
                rows = await cur.fetchall()
        except Exception:
            async with conn.execute("""
                SELECT day_num, completed_date, created_at
                FROM workout_completions
                WHERE user_id=?
                ORDER BY completed_date ASC, day_num ASC, id ASC
                LIMIT 60
            """, (uid,)) as cur:
                raw = await cur.fetchall()
            rows = [(r[0], r[1], r[2], "") for r in raw]

    if not rows:
        await callback.answer("–ü–æ–∫–∞ –Ω–µ—Ç –∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ üí™", show_alert=True)
        return

    total = len(rows)
    plan_text, plan_struct = await get_workout_plan(uid)
    u = await get_user(uid)
    freq = int(u.get("freq") or 3)

    lines = ["\U0001f4ca –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫\n"]
    lines.append(f"–í—Å–µ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ: {total} —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫\n")

    # –ü–æ—Å–ª–µ–¥–Ω–∏–µ 10 ‚Äî –æ—Ç —Å—Ç–∞—Ä—ã—Ö –∫ –Ω–æ–≤—ã–º (rows —É–∂–µ –≤ –ø–æ—Ä—è–¥–∫–µ ASC)
    recent = rows[-10:]
    lines.append("üóì –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏:")
    for row in recent:
        day_num = row[0]
        completed_date = row[1]
        saved_title = row[3] if len(row) > 3 else ""
        if saved_title:
            day_label = f"–î–µ–Ω—å {day_num} ‚Ä¢ {saved_title}"
        elif plan_struct:
            day_text_str = (plan_struct.get("days") or {}).get(str(day_num), "")
            day_name = get_day_display_name(day_num, day_text_str)
            day_label = f"–î–µ–Ω—å {day_num} ‚Ä¢ {day_name}"
        else:
            day_label = f"–î–µ–Ω—å {day_num}"
        lines.append(f"‚úÖ {completed_date}  ‚Äî  {day_label}")

    # –°–µ—Ä–∏—è (streak) –ø–æ –≤—Å–µ–º –¥–∞—Ç–∞–º
    all_dates = sorted(set(r[1] for r in rows), reverse=True)
    streak = 0
    prev = None
    for d in all_dates:
        try:
            dt = datetime.strptime(d, "%Y-%m-%d").date()
        except Exception:
            continue
        if prev is None:
            streak = 1
        elif (prev - dt).days == 1:
            streak += 1
        else:
            break
        prev = dt

    lines.append(f"\n\U0001f525 –¢–µ–∫—É—â–∞—è —Å–µ—Ä–∏—è: {streak} –¥–Ω. –ø–æ–¥—Ä—è–¥")

    # –ó–∞–∫—Ä—ã—Ç–∏–µ –Ω–µ–¥–µ–ª–∏
    today = datetime.now().date()
    week_start = today - timedelta(days=today.weekday())
    week_end = week_start + timedelta(days=6)
    ws_str = week_start.strftime("%Y-%m-%d")
    we_str = week_end.strftime("%Y-%m-%d")
    done_this_week = len(set(
        r[1] for r in rows if ws_str <= r[1] <= we_str
    ))
    lines.append("")
    if done_this_week >= freq:
        lines.append(f"‚úÖ –ù–µ–¥–µ–ª—è –∑–∞–∫—Ä—ã—Ç–∞: –≤—ã–ø–æ–ª–Ω–µ–Ω–æ {done_this_week}/{freq}")
    else:
        lines.append(f"üìå –û—Å—Ç–∞–ª–æ—Å—å: {freq - done_this_week} —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –Ω–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ")

    text = "\n".join(lines)
    back_kb = InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(text="‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –∫ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞–º", callback_data="nav:workouts")],
    ])
    await clean_edit(callback, uid, text, reply_markup=back_kb)
    await callback.answer()


async def cb_workout_ex_tech(callback: CallbackQuery, bot: Bot):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–µ—Ö–Ω–∏–∫—É –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –∏–∑ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–Ω—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏.
    callback_data: wex:tech:{day_num}:{tech_key}
    –ò—Å–ø–æ–ª—å–∑—É–µ—Ç GIF –∏–∑ TECH_GIFS, –µ—Å–ª–∏ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.
    """
    parts = callback.data.split(":")
    tech_key = parts[3] if len(parts) > 3 else ""
    day_num  = parts[2] if len(parts) > 2 else "1"

    back_kb = InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(
            text=f"‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –∫ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–µ (–î–µ–Ω—å {day_num})",
            callback_data=f"wday:{day_num}"
        )]
    ])

    item = TECH.get(tech_key)
    if not item:
        await clean_edit(
            callback,
            callback.from_user.id,
            (
                "‚ö†Ô∏è –¢–µ—Ö–Ω–∏–∫–∞ –¥–ª—è —ç—Ç–æ–≥–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –ø–æ–∫–∞ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω–∞.\n\n"
                "–ù–∞–ø–∏—à–∏ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É ‚Äî –¥–æ–±–∞–≤–∏–º."
            ),
            reply_markup=back_kb,
        )
        await callback.answer()
        return

    text = item["text"]
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º GIF (–Ω–µ –∫–∞—Ä—Ç–∏–Ω–∫—É)
    await _send_tech_with_gif(
        bot, callback.message.chat.id, callback.from_user.id,
        tech_key, text, reply_markup=back_kb
    )
    await callback.answer()


async def open_nutrition(user_id: int, chat_id: int, bot: Bot, callback: Optional[CallbackQuery] = None):
    if not await is_access_active(user_id):
        text = locked_text()
        if callback:
            await clean_edit(callback, user_id, text)
        else:
            await clean_send(bot, chat_id, user_id, text)
        return

    if not await is_full_access_active(user_id):
        text = (
            "–ü–∏—Ç–∞–Ω–∏–µ\n\n"
            "–†–∞–∑–¥–µ–ª ¬´–ü–∏—Ç–∞–Ω–∏–µ¬ª –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ —Ç–∞—Ä–∏—Ñ–∞—Ö 3 –º–µ—Å—è—Ü–∞ –∏ –ù–∞–≤—Å–µ–≥–¥–∞.\n\n"
            "–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —ç—Ç–∏ —Ç–∞—Ä–∏—Ñ—ã?\n"
            "90 –¥–Ω–µ–π ‚Äî –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Å—Ä–æ–∫, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ—Ç –ø–∏—Ç–∞–Ω–∏—è.\n"
            "–ú–µ—Å—è—Ü ‚Äî —Å–ª–∏—à–∫–æ–º –º–∞–ª–æ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–∞–≤–∞ —Ç–µ–ª–∞.\n\n"
            "–í—ã–±–µ—Ä–∏ —Ç–∞—Ä–∏—Ñ:"
        )
        upgrade_kb = InlineKeyboardMarkup(inline_keyboard=[
            [InlineKeyboardButton(text=f"üî• 3 –º–µ—Å—è—Ü–∞ ‚Äî {TARIFFS['t3']['price']}‚ÇΩ", callback_data="tariff:t3")],
            [InlineKeyboardButton(text=f"üèÜ –ù–∞–≤—Å–µ–≥–¥–∞ ‚Äî {TARIFFS['life']['price']}‚ÇΩ", callback_data="tariff:life")],
            [InlineKeyboardButton(text="üè† –ú–µ–Ω—é", callback_data="nav:menu")],
        ])
        if callback:
            await clean_edit(callback, user_id, text, reply_markup=upgrade_kb)
        else:
            await clean_send(bot, chat_id, user_id, text, reply_markup=upgrade_kb)
        return

    if not await ensure_profile_ready(user_id):
        text = "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞–ø–æ–ª–Ω–∏ –ø—Ä–æ—Ñ–∏–ª—å (‚öôÔ∏è –ü—Ä–æ—Ñ–∏–ª—å)."
        if callback:
            await clean_edit(callback, user_id, text)
        else:
            await clean_send(bot, chat_id, user_id, text)
        return

    u = await get_user(user_id)
    summary, _, _, _, _, _ = generate_nutrition_summary(
        u["goal"], u["sex"], int(u["age"]), int(u["height"]), float(u["weight"]), u["exp"],
        freq=int(u["freq"]), place=u["place"], meals_pref=int(u.get("meals") or 0)
    )

    if callback:
        await send_section(
            bot, chat_id, user_id,
            IMAGE_PATHS["nutrition"], summary, reply_markup=nutrition_examples_kb(),
            callback=callback,
        )
    else:
        await send_section(
            bot, chat_id, user_id,
            IMAGE_PATHS["nutrition"], summary, reply_markup=nutrition_examples_kb(),
        )


async def open_measures(user_id: int, chat_id: int, bot: Bot, state: FSMContext, callback: Optional[CallbackQuery] = None):
    if not await is_access_active(user_id):
        if callback:
            await clean_edit(callback, user_id, locked_text())
        else:
            await clean_send(bot, chat_id, user_id, locked_text())
        return

    await state.set_state(MeasureFlow.choose_type)
    text = "–ó–∞–º–µ—Ä—ã\n\n–í—ã–±–µ—Ä–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä ‚Äî –¥–∞—Ç—É –ø–æ—Å—Ç–∞–≤–ª—é —Å–∞–º."
    if callback:
        await send_section(
            bot, chat_id, user_id,
            IMAGE_PATHS["measurements"], text, reply_markup=measures_kb(),
            callback=callback,
        )
    else:
        await send_section(
            bot, chat_id, user_id,
            IMAGE_PATHS["measurements"], text, reply_markup=measures_kb(),
        )


async def open_diary(user_id: int, chat_id: int, bot: Bot, state: FSMContext, callback: Optional[CallbackQuery] = None):
    if not await is_access_active(user_id):
        if callback:
            await clean_edit(callback, user_id, locked_text())
        else:
            await clean_send(bot, chat_id, user_id, locked_text())
        return

    await state.set_state(DiaryFlow.choosing_exercise)
    text = (
        "–î–Ω–µ–≤–Ω–∏–∫ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫\n\n"
        "–ö–∞–∫ –≤–µ—Å—Ç–∏:\n"
        "‚Äî –í—ã–±–µ—Ä–∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–æ–π\n"
        "‚Äî –í–≤–µ–¥–∏ –ø–æ–¥—Ö–æ–¥—ã: –≤–µ—Å √ó –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è\n"
        "   –ü—Ä–∏–º–µ—Ä: 60x8, 62x8, 65x6\n"
        "‚Äî –î–∞—Ç–∞ —Å—Ç–∞–≤–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏\n\n"
        "–ü–æ—á–µ–º—É –Ω–µ –≤—Å–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è?\n"
        "–î–Ω–µ–≤–Ω–∏–∫ —Å–æ–¥–µ—Ä–∂–∏—Ç –±–∞–∑–æ–≤—ã–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è ‚Äî –∂–∏–º, –ø—Ä–∏—Å–µ–¥, —Ç—è–≥—É, –ø–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è.\n"
        "–ü—Ä–æ–≥—Ä–µ—Å—Å –≤ –±–∞–∑–µ –æ—Ç—Ä–∞–∂–∞–µ—Ç –æ–±—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å —Ç–æ—á–Ω–µ–µ –≤—Å–µ–≥–æ.\n\n"
        "–ó–∞–ø–∏—Å—ã–≤–∞–π –∫–∞–∂–¥—É—é —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É ‚Äî —á–µ—Ä–µ–∑ 4‚Äì8 –Ω–µ–¥–µ–ª—å —É–≤–∏–¥–∏—à—å —Ä–æ—Å—Ç –≤ —Ü–∏—Ñ—Ä–∞—Ö."
    )
    if callback:
        await send_section(
            bot, chat_id, user_id,
            IMAGE_PATHS["diary"], text, reply_markup=diary_exercises_kb(),
            callback=callback,
        )
    else:
        await send_section(
            bot, chat_id, user_id,
            IMAGE_PATHS["diary"], text, reply_markup=diary_exercises_kb(),
        )


# =========================
# –î–ù–ï–í–ù–ò–ö
# =========================
async def diary_pick_ex(callback: CallbackQuery, state: FSMContext, bot: Bot):
    exercise = callback.data.split("d:ex:", 1)[1].strip()
    await state.update_data(exercise=exercise)
    await state.set_state(DiaryFlow.enter_sets)

    old_prompt_id = await get_diary_prompt_msg_id(callback.from_user.id)
    if old_prompt_id:
        try:
            await bot.delete_message(chat_id=callback.message.chat.id, message_id=old_prompt_id)
        except Exception:
            pass

    today = datetime.now().strftime("%Y-%m-%d")
    text = (
        f"üóì {today}\n"
        f"‚úÖ {exercise}\n\n"
        "–ù–∞–ø–∏—à–∏ –ø–æ–¥—Ö–æ–¥—ã: –≤–µ—Åx–ø–æ–≤—Ç–æ—Ä—ã\n"
        "–ü—Ä–∏–º–µ—Ä: 60x8, 60x8, 60x7"
    )

    m = await bot.send_message(chat_id=callback.message.chat.id, text=text)
    await set_diary_prompt_msg_id(callback.from_user.id, m.message_id)
    await callback.answer()


async def diary_enter_sets(message: Message, state: FSMContext, bot: Bot):
    txt = (message.text or "").strip()
    data = await state.get_data()
    exercise = (data.get("exercise") or "").strip()
    if not exercise:
        await clean_send(bot, message.chat.id, message.from_user.id, "–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –≤ ¬´–î–Ω–µ–≤–Ω–∏–∫–µ¬ª.")
        await try_delete_user_message(bot, message)
        await state.clear()
        return

    parts = [p.strip() for p in txt.split(",") if p.strip()]
    if not parts:
        await message.answer("–§–æ—Ä–º–∞—Ç: 60x8, 60x8")
        await try_delete_user_message(bot, message)
        return

    session_id = await get_or_create_today_session(message.from_user.id)

    parsed = []
    for p in parts:
        m = re.match(r"^(\d+(\.\d+)?)\s*[x—Ö]\s*(\d+)$", p.lower())
        if not m:
            await message.answer(f"–ù–µ –ø–æ–Ω—è–ª: '{p}'. –ü—Ä–∏–º–µ—Ä: 60x8")
            await try_delete_user_message(bot, message)
            return
        w = float(m.group(1))
        r = int(m.group(3))
        parsed.append((w, r))

    for i, (w, r) in enumerate(parsed, start=1):
        await add_set(session_id, exercise, i, w, r)

    today = datetime.now().strftime("%Y-%m-%d")
    msg = f"‚úÖ –ó–∞–ø–∏—Å–∞–ª.\nüóì {today}\nüè∑ {exercise}\n–ü–æ–¥—Ö–æ–¥–æ–≤: {len(parsed)}"
    await clean_send(bot, message.chat.id, message.from_user.id, msg, reply_markup=diary_exercises_kb())
    await try_delete_user_message(bot, message)

    prompt_id = await get_diary_prompt_msg_id(message.from_user.id)
    if prompt_id:
        try:
            await bot.delete_message(chat_id=message.chat.id, message_id=prompt_id)
        except Exception:
            pass
        await set_diary_prompt_msg_id(message.from_user.id, None)

    await state.set_state(DiaryFlow.choosing_exercise)


async def diary_history(callback: CallbackQuery):
    history = await get_diary_history(callback.from_user.id, 10)
    if not history:
        await callback.message.answer("–ò—Å—Ç–æ—Ä–∏–∏ –ø–æ–∫–∞ –Ω–µ—Ç üôÇ")
        await callback.answer()
        return

    msg = "üìú –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏:\n\n"
    for (s, sets) in history:
        sid, session_date, title = s
        msg += f"üóì {session_date}\n"
        cur_ex = None
        line = ""
        for ex, set_no, w, reps in sets:
            if cur_ex != ex:
                if line:
                    msg += line + "\n"
                cur_ex = ex
                line = f"‚Ä¢ {ex}: "
            line += f"{w:g}x{reps}  "
        if line:
            msg += line + "\n"
        msg += "\n"

    await safe_send(callback.message, msg, reply_markup=simple_back_to_menu_inline_kb())
    await callback.answer()


# =========================
# –ó–ê–ú–ï–†–´
# =========================
async def cb_measure_type(callback: CallbackQuery, state: FSMContext):
    mtype = callback.data.split(":")[1]
    await state.update_data(mtype=mtype)
    await state.set_state(MeasureFlow.enter_value)

    name = dict(MEASURE_TYPES).get(mtype, mtype)
    text = f"–ó–∞–º–µ—Ä—ã\n\n\U0001f4dd {name}\n\n–í–≤–µ–¥–∏ –∑–Ω–∞—á–µ–Ω–∏–µ —á–∏—Å–ª–æ–º:"
    back_kb = InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(text="‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –∫ –∑–∞–º–µ—Ä–∞–º", callback_data="nav:measures")]
    ])
    await clean_edit(callback, callback.from_user.id, text, reply_markup=back_kb)
    await callback.answer()


async def measure_value(message: Message, state: FSMContext, bot: Bot):
    txt = (message.text or "").strip().replace(",", ".")
    try:
        val = float(txt)
    except Exception:
        await message.answer("–ù—É–∂–Ω–æ —á–∏—Å–ª–æ üôÇ")
        await try_delete_user_message(bot, message)
        return

    data = await state.get_data()
    mtype = data.get("mtype")
    uid = message.from_user.id

    await add_measure(uid, mtype, val)
    await try_delete_user_message(bot, message)

    rows = await get_last_measures(uid, mtype, 6)
    name = dict(MEASURE_TYPES).get(mtype, mtype)
    hist = "\n".join([f"‚Ä¢ {r[0]:g} ({r[1][:10]})" for r in rows])
    out = (
        f"–ó–∞–º–µ—Ä—ã\n\n"
        f"‚úÖ {name} –∑–∞–ø–∏—Å–∞–Ω: {val:g}\n\n"
        f"–ü–æ—Å–ª–µ–¥–Ω–∏–µ {name}:\n{hist}\n\n"
        "–í—ã–±–µ—Ä–∏ —Å–ª–µ–¥—É—é—â–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä:"
    )
    await state.set_state(MeasureFlow.choose_type)
    # –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç–∞ ‚Äî –±–µ–∑ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ
    await clean_send(bot, message.chat.id, uid, out, reply_markup=measures_kb())


async def measures_history(callback: CallbackQuery):
    rows = await get_last_measures_any(callback.from_user.id, 30)
    if not rows:
        await callback.message.answer("–ò—Å—Ç–æ—Ä–∏–∏ –ø–æ–∫–∞ –Ω–µ—Ç üôÇ")
        await callback.answer()
        return

    name_map = dict(MEASURE_TYPES)
    grouped: Dict[str, List[Tuple[float, str]]] = {}
    for mtype, val, created_at in rows:
        grouped.setdefault(mtype, []).append((val, created_at))

    msg = "üìú –ò—Å—Ç–æ—Ä–∏—è –∑–∞–º–µ—Ä–æ–≤:\n\n"
    for mtype, items in grouped.items():
        msg += f"{name_map.get(mtype, mtype)}:\n"
        for val, ts in items[:6]:
            msg += f"‚Ä¢ {val:g} ({ts[:10]})\n"
        msg += "\n"

    await safe_send(callback.message, msg, reply_markup=measures_kb())
    await callback.answer()


# =========================
# –ü–ò–¢–ê–ù–ò–ï: 3 –≤–∞—Ä–∏–∞–Ω—Ç–∞
# =========================
def build_shopping_basket(goal: str, calories: int, protein_g: int, fat_g: int, carbs_g: int, meals: int) -> str:
    """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –Ω–∞ –Ω–µ–¥–µ–ª—é –ø–æ–¥ —Ü–µ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""
    g = (goal or "").lower()
    is_cut = "—Å—É—à" in g
    is_mass = "–º–∞—Å" in g

    # –ë–∞–∑–æ–≤—ã–µ –Ω–µ–¥–µ–ª—å–Ω—ã–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ (–Ω–∞ 7 –¥–Ω–µ–π)
    # –ë–µ–ª–æ–∫: –æ—Å–Ω–æ–≤–Ω–æ–π –∏—Å—Ç–æ—á–Ω–∏–∫
    chicken_week = int(round(protein_g * 0.45 * 7 / 0.31))   # 45% –±–µ–ª–∫–∞ –∏–∑ –∫—É—Ä–∏—Ü—ã
    fish_week    = int(round(protein_g * 0.25 * 7 / 0.18))   # 25% –∏–∑ —Ä—ã–±—ã
    eggs_week    = max(7, int(round(protein_g * 0.15 * 7 / 0.127 / 60)))  # ~15% –∏–∑ —è–∏—Ü (—à—Ç)
    curd_week    = int(round(protein_g * 0.15 * 7 / 0.18))   # ~15% –∏–∑ —Ç–≤–æ—Ä–æ–≥–∞

    # –£–≥–ª–µ–≤–æ–¥—ã
    rice_week    = int(round(carbs_g * 0.35 * 7 / 0.76))
    buckwheat_w  = int(round(carbs_g * 0.25 * 7 / 0.57))
    oats_week    = int(round(carbs_g * 0.15 * 7 / 0.60))
    potato_week  = int(round(carbs_g * 0.10 * 7 / 0.17))
    fruit_week   = int(round(carbs_g * 0.15 * 7 / 0.17))   # —Ñ—Ä—É–∫—Ç—ã ~17% —É–≥–ª–µ–≤–æ–¥–æ–≤

    # –ñ–∏—Ä—ã
    oil_week     = int(round(fat_g * 0.4 * 7 / 1.0))         # –º–∞—Å–ª–æ 40% –∂–∏—Ä–æ–≤
    nuts_week    = int(round(fat_g * 0.3 * 7 / 0.5))         # –æ—Ä–µ—Ö–∏ ~50% –∂–∏—Ä–æ–≤

    # –û–≤–æ—â–∏ ‚Äî –≤—Å–µ–≥–¥–∞
    veg_week     = 1400  # 200–≥ –≤ –¥–µ–Ω—å √ó 7

    lines = [
        f"üõí –ö–æ—Ä–∑–∏–Ω–∞ –Ω–∞ –Ω–µ–¥–µ–ª—é",
        f"–¶–µ–ª—å: {goal} | {calories} –∫–∫–∞–ª/–¥–µ–Ω—å",
        f"–ë {protein_g}–≥ / –ñ {fat_g}–≥ / –£ {carbs_g}–≥",
        "",
        "ü•© –ë–ï–õ–û–ö:",
        f"‚Ä¢ –ö—É—Ä–∏–Ω–∞—è –≥—Ä—É–¥–∫–∞ ‚Äî {chicken_week} –≥ (~{chicken_week//1000:.1f} –∫–≥)" if chicken_week >= 1000 else f"‚Ä¢ –ö—É—Ä–∏–Ω–∞—è –≥—Ä—É–¥–∫–∞ ‚Äî {chicken_week} –≥",
        f"‚Ä¢ –†—ã–±–∞ –±–µ–ª–∞—è (—Ç—Ä–µ—Å–∫–∞/–º–∏–Ω—Ç–∞–π) ‚Äî {fish_week} –≥" + (" (~{:.1f} –∫–≥)".format(fish_week/1000) if fish_week >= 1000 else ""),
        f"‚Ä¢ –Ø–π—Ü–∞ ‚Äî {eggs_week} —à—Ç",
        f"‚Ä¢ –¢–≤–æ—Ä–æ–≥ 0‚Äì5% ‚Äî {curd_week} –≥",
    ]

    if is_mass:
        beef_week = int(round(protein_g * 0.10 * 7 / 0.25))
        lines.append(f"‚Ä¢ –ì–æ–≤—è–¥–∏–Ω–∞ (–≤–∞—Ä—ë–Ω–∞—è) ‚Äî {beef_week} –≥  (–¥–ª—è —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è)")

    lines += [
        "",
        "üçö –£–ì–õ–ï–í–û–î–´:",
        f"‚Ä¢ –†–∏—Å (—Å—É—Ö–æ–π) ‚Äî {rice_week} –≥",
        f"‚Ä¢ –ì—Ä–µ—á–∫–∞ (—Å—É—Ö–∞—è) ‚Äî {buckwheat_w} –≥",
        f"‚Ä¢ –û–≤—Å—è–Ω–∫–∞ (—Å—É—Ö–∞—è) ‚Äî {oats_week} –≥",
        f"‚Ä¢ –ö–∞—Ä—Ç–æ—Ñ–µ–ª—å ‚Äî {potato_week} –≥" if not is_cut else f"‚Ä¢ –ö–∞—Ä—Ç–æ—Ñ–µ–ª—å ‚Äî {potato_week//2} –≥  (–Ω–∞ —Å—É—à–∫–µ –º–µ–Ω—å—à–µ)",
        f"‚Ä¢ –§—Ä—É–∫—Ç—ã (—è–±–ª–æ–∫–æ/–±–∞–Ω–∞–Ω/—è–≥–æ–¥—ã) ‚Äî ~{fruit_week} –≥/–Ω–µ–¥",
        "",
        "ü•¶ –û–í–û–©–ò:",
        f"‚Ä¢ –û–≤–æ—â–∏ (–æ–≥—É—Ä–µ—Ü, –ø–æ–º–∏–¥–æ—Ä, –∫–∞–ø—É—Å—Ç–∞) ‚Äî ~{veg_week} –≥/–Ω–µ–¥",
        "  (–ø–æ–∫—É–ø–∞–π –ª—é–±—ã–µ —Å–≤–µ–∂–∏–µ –∏–ª–∏ –∑–∞–º–æ—Ä–æ–∂–µ–Ω–Ω—ã–µ)",
        "",
        "ü´í –ñ–ò–†–´:",
        f"‚Ä¢ –ú–∞—Å–ª–æ –æ–ª–∏–≤–∫–æ–≤–æ–µ/–ø–æ–¥—Å–æ–ª–Ω–µ—á–Ω–æ–µ ‚Äî {oil_week} –≥  (~{oil_week//10} —Å—Ç.–ª.)",
        f"‚Ä¢ –û—Ä–µ—Ö–∏ (–º–∏–Ω–¥–∞–ª—å/–≥—Ä–µ—Ü–∫–∏–π) ‚Äî {nuts_week} –≥",
    ]

    if not is_cut:
        lines += [
            f"‚Ä¢ –ì—Ä–µ—á–µ—Å–∫–∏–π –π–æ–≥—É—Ä—Ç 2% ‚Äî 500‚Äì700 –≥",
        ]

    lines += [
        "",
        "üí° –ó–∞–º–µ–Ω—ã:",
        "  –∫—É—Ä–∏—Ü–∞ ‚Üî –∏–Ω–¥–µ–π–∫–∞ ‚Üî —Ä—ã–±–∞",
        "  —Ä–∏—Å ‚Üî –≥—Ä–µ—á–∫–∞ ‚Üî –º–∞–∫–∞—Ä–æ–Ω—ã",
        "  —Ç–≤–æ—Ä–æ–≥ ‚Üî –≥—Ä–µ—á–µ—Å–∫–∏–π –π–æ–≥—É—Ä—Ç",
        "",
        "‚ö†Ô∏è –≠—Ç–æ –ø—Ä–∏–º–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫. –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–π –ø–æ–¥",
        "   —Å–≤–æ–π –≤–∫—É—Å –∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø—Ä–æ–¥—É–∫—Ç–æ–≤.",
    ]

    return "\n".join(lines)


async def cb_nutr_example(callback: CallbackQuery, bot: Bot):
    if not await is_full_access_active(callback.from_user.id):
        text = (
            "üçΩ –ü–∏—Ç–∞–Ω–∏–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –Ω–∞ —Ç–∞—Ä–∏—Ñ–∞—Ö 3 –º–µ—Å—è—Ü–∞ –∏ –ù–∞–≤—Å–µ–≥–¥–∞.\n\n"
            f"–í—ã–±–µ—Ä–∏ —Ç–∞—Ä–∏—Ñ üëá"
        )
        upgrade_kb = InlineKeyboardMarkup(inline_keyboard=[
            [InlineKeyboardButton(text=f"üî• 3 –º–µ—Å—è—Ü–∞ ‚Äî {TARIFFS['t3']['price']}‚ÇΩ", callback_data="tariff:t3")],
            [InlineKeyboardButton(text=f"üèÜ –ù–∞–≤—Å–µ–≥–¥–∞ ‚Äî {TARIFFS['life']['price']}‚ÇΩ", callback_data="tariff:life")],
            [InlineKeyboardButton(text="üè† –ú–µ–Ω—é", callback_data="nav:menu")],
        ])
        await clean_edit(callback, callback.from_user.id, text, reply_markup=upgrade_kb)
        await callback.answer()
        return

    if not await ensure_profile_ready(callback.from_user.id):
        await clean_edit(callback, callback.from_user.id, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞–ø–æ–ª–Ω–∏ –ø—Ä–æ—Ñ–∏–ª—å (‚öôÔ∏è –ü—Ä–æ—Ñ–∏–ª—å).")
        await callback.answer()
        return

    day_i = int(callback.data.split(":")[2])
    u = await get_user(callback.from_user.id)
    summary, calories, p, f, c, meals = generate_nutrition_summary(
        u["goal"], u["sex"], int(u["age"]), int(u["height"]), float(u["weight"]), u["exp"],
        freq=int(u["freq"]), place=u["place"], meals_pref=int(u.get("meals") or 0)
    )
    day_text = build_meal_day_text(day_i, calories, p, f, c, meals)
    await clean_edit(callback, callback.from_user.id, day_text, reply_markup=nutrition_back_kb())
    await callback.answer()


async def cb_nutr_back(callback: CallbackQuery, bot: Bot):
    await open_nutrition(callback.from_user.id, callback.message.chat.id, bot, callback=callback)
    await callback.answer()


async def cb_nutr_basket(callback: CallbackQuery, bot: Bot):
    """–ö–æ—Ä–∑–∏–Ω–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –Ω–∞ –Ω–µ–¥–µ–ª—é."""
    if not await is_full_access_active(callback.from_user.id):
        await callback.answer("üîí –î–æ—Å—Ç—É–ø–Ω–æ –Ω–∞ —Ç–∞—Ä–∏—Ñ–∞—Ö 3 –º–µ—Å—è—Ü–∞ –∏ –ù–∞–≤—Å–µ–≥–¥–∞.", show_alert=True)
        return

    if not await ensure_profile_ready(callback.from_user.id):
        await clean_edit(callback, callback.from_user.id, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞–ø–æ–ª–Ω–∏ –ø—Ä–æ—Ñ–∏–ª—å.")
        await callback.answer()
        return

    u = await get_user(callback.from_user.id)
    _, calories, p, f, c, meals = generate_nutrition_summary(
        u["goal"], u["sex"], int(u["age"]), int(u["height"]), float(u["weight"]), u["exp"],
        freq=int(u["freq"]), place=u["place"], meals_pref=int(u.get("meals") or 0)
    )

    basket_text = build_shopping_basket(u["goal"], calories, p, f, c, meals)
    back_kb = InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(text="‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –∫ —Ä–∞—Ü–∏–æ–Ω—É", callback_data="nutr:back")],
        [InlineKeyboardButton(text="üè† –ú–µ–Ω—é", callback_data="nav:menu")],
    ])
    await clean_edit(callback, callback.from_user.id, basket_text, reply_markup=back_kb)
    await callback.answer()


# =========================
# ‚úÖ –¢–ï–•–ù–ò–ö–ò: –•–ï–ù–î–õ–ï–†–´ (—Å GIF-–∞–Ω–∏–º–∞—Ü–∏—è–º–∏)
# =========================
async def cb_tech_list(callback: CallbackQuery, state: FSMContext):
    await state.clear()
    await clean_edit(callback, callback.from_user.id, "üìö –¢–µ—Ö–Ω–∏–∫–∏ ‚Äî –≤—ã–±–µ—Ä–∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ:", reply_markup=tech_kb())
    await callback.answer()


async def cb_tech_show(callback: CallbackQuery, bot: Bot):
    """–ü–æ–∫–∞–∑ —Ç–µ—Ö–Ω–∏–∫–∏ —Å GIF-–∞–Ω–∏–º–∞—Ü–∏–µ–π –∏–∑ TECH_GIFS (–µ—Å–ª–∏ —Ñ–∞–π–ª –µ—Å—Ç—å), –∏–Ω–∞—á–µ ‚Äî —Ç–µ–∫—Å—Ç."""
    key = callback.data.split("tech:", 1)[1]
    item = TECH.get(key)
    if not item:
        await callback.answer("–ù–µ –Ω–∞—à—ë–ª üòÖ", show_alert=True)
        return

    text = item["text"]
    await _send_tech_with_gif(
        bot, callback.message.chat.id, callback.from_user.id,
        key, text, reply_markup=tech_back_kb()
    )
    await callback.answer()


# =========================
# –ü–û–°–¢–´ –° –ö–ê–†–¢–ò–ù–ö–ê–ú–ò (–ê–î–ú–ò–ù)
# =========================
def admin_posts_kb():
    return InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(text="‚ûï –°–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç", callback_data="post:new")],
        [InlineKeyboardButton(text="üè† –ú–µ–Ω—é", callback_data="nav:menu")],
    ])


def post_confirm_kb(post_id: int):
    return InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(text="‚úÖ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤—Å–µ–º", callback_data=f"post:send:{post_id}")],
        [InlineKeyboardButton(text="‚ùå –û—Ç–º–µ–Ω–∞", callback_data="post:cancel")],
    ])


async def cmd_posts(message: Message, state: FSMContext):
    if message.from_user.id != ADMIN_ID:
        return
    await state.clear()
    await message.answer("üóû –ü–æ—Å—Ç—ã (–∞–¥–º–∏–Ω):", reply_markup=admin_posts_kb())


async def cb_post_new(callback: CallbackQuery, state: FSMContext):
    if callback.from_user.id != ADMIN_ID:
        await callback.answer("–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞", show_alert=True)
        return

    await state.clear()
    txt = (
        "üìù –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å—Ç–∞\n\n"
        "–ü—Ä–∏—à–ª–∏ —Ç–µ–∫—Å—Ç\n"
        "–∏–ª–∏ —Ñ–æ—Ç–æ/–≤–∏–¥–µ–æ —Å –ø–æ–¥–ø–∏—Å—å—é.\n\n"
        "–ü–æ—Ç–æ–º –ø–æ–∫–∞–∂—É –ø—Ä–µ–≤—å—é."
    )
    await callback.message.answer(txt, reply_markup=InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(text="‚ùå –û—Ç–º–µ–Ω–∞", callback_data="post:cancel")]
    ]))
    await state.set_state(PostFlow.waiting_content)
    await callback.answer()


async def cb_post_cancel(callback: CallbackQuery, state: FSMContext):
    if callback.from_user.id != ADMIN_ID:
        await callback.answer()
        return
    await state.clear()
    await callback.message.answer("–û–∫.", reply_markup=admin_posts_kb())
    await callback.answer()


async def post_waiting_content(message: Message, state: FSMContext, bot: Bot):
    if message.from_user.id != ADMIN_ID:
        return

    media_type = "none"
    media_file_id = ""
    text = ""

    if message.photo:
        media_type = "photo"
        media_file_id = message.photo[-1].file_id
        text = (message.caption or "").strip()
    elif message.video:
        media_type = "video"
        media_file_id = message.video.file_id
        text = (message.caption or "").strip()
    else:
        text = (message.text or "").strip()
        if not text:
            await message.answer("–ù—É–∂–Ω–æ —Ç–µ–∫—Å—Ç –∏–ª–∏ –º–µ–¥–∏–∞ üôÇ")
            return

    post_id = await create_post_draft(ADMIN_ID, media_type, media_file_id, text)
    await state.update_data(post_id=post_id)
    await state.set_state(PostFlow.waiting_confirm)

    preview_title = f"‚úÖ –ü—Ä–µ–≤—å—é (id={post_id})\n\n"
    chat_id = message.chat.id
    uid = message.from_user.id

    caption = (preview_title + (text or "")).strip()
    if len(caption) > 1024:
        caption = caption[:1020] + "‚Ä¶"

    last_id = await get_last_bot_msg_id(uid)
    if last_id:
        try:
            await bot.delete_message(chat_id=chat_id, message_id=last_id)
        except Exception:
            pass

    if media_type == "photo":
        m = await bot.send_photo(chat_id=chat_id, photo=media_file_id, caption=caption, reply_markup=post_confirm_kb(post_id))
        await set_last_bot_msg_id(uid, m.message_id)
    elif media_type == "video":
        m = await bot.send_video(chat_id=chat_id, video=media_file_id, caption=caption, reply_markup=post_confirm_kb(post_id))
        await set_last_bot_msg_id(uid, m.message_id)
    else:
        mid = await clean_send(bot, chat_id, uid, preview_title + text, reply_markup=post_confirm_kb(post_id))
        await set_last_bot_msg_id(uid, mid)

    await try_delete_user_message(bot, message)


async def cb_post_send(callback: CallbackQuery, bot: Bot, state: FSMContext):
    if callback.from_user.id != ADMIN_ID:
        await callback.answer("–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞", show_alert=True)
        return

    post_id = int(callback.data.split(":")[2])

    post = await get_post(post_id)
    if not post:
        await callback.answer("–ü–æ—Å—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω", show_alert=True)
        return
    if post.get("status") == "sent":
        await callback.answer("–£–∂–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω", show_alert=True)
        return

    await callback.message.answer("üì§ –†–∞—Å—Å—ã–ª–∞—é‚Ä¶")
    await callback.answer()

    user_ids = await get_all_user_ids()
    ok = 0
    fail = 0

    caption = (post.get("text") or "").strip()
    if len(caption) > 1024:
        caption = caption[:1020] + "‚Ä¶"

    for uid in user_ids:
        try:
            if post["media_type"] == "photo":
                await bot.send_photo(chat_id=uid, photo=post["media_file_id"], caption=caption if caption else None)
            elif post["media_type"] == "video":
                await bot.send_video(chat_id=uid, video=post["media_file_id"], caption=caption if caption else None)
            else:
                await bot.send_message(chat_id=uid, text=post.get("text") or "")
            ok += 1
        except Exception as e:
            fail += 1
            try:
                async with db() as conn:
                    await conn.execute("""
                        INSERT INTO post_sends (post_id, user_id, status, error, created_at)
                        VALUES (?, ?, 'fail', ?, ?)
                    """, (post_id, uid, str(e)[:500], datetime.utcnow().isoformat()))
                    await conn.commit()
            except Exception:
                pass

        await asyncio.sleep(0.03)

    await set_post_status(post_id, "sent")
    await callback.message.answer(f"‚úÖ –ì–æ—Ç–æ–≤–æ. –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ: {ok} ‚Ä¢ –û—à–∏–±–æ–∫: {fail}", reply_markup=admin_posts_kb())
    await state.clear()


# =========================
# –ü–û–î–î–ï–†–ñ–ö–ê: –ª—é–±–æ–π —Ç–µ–∫—Å—Ç -> –∞–¥–º–∏–Ω—É
# =========================
async def forward_to_admin(message: Message, bot: Bot):
    if message.from_user.id == ADMIN_ID:
        return
    if not message.text or message.text.startswith("/"):
        return

    await bot.send_message(
        chat_id=ADMIN_ID,
        text=f"üì© –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –æ—Ç @{message.from_user.username or 'no_username'} (id={message.from_user.id}):\n\n{message.text}"
    )
    await try_delete_user_message(bot, message)
    await clean_send(bot, message.chat.id, message.from_user.id, "‚úÖ –ü—Ä–∏–Ω—è–ª. –û—Ç–≤–µ—á—É —Ç—É—Ç.")


# =========================
# ‚úÖ –°–ú–ï–ù–ê –ü–†–û–ì–†–ê–ú–ú–´ –¢–†–ï–ù–ò–†–û–í–û–ö (–¥–ª—è full access)
# =========================
async def cb_workout_rebuild(callback: CallbackQuery, bot: Bot):
    """–ü–µ—Ä–µ—Å–æ–±–∏—Ä–∞–µ—Ç –ø–ª–∞–Ω —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ (—Ç–æ–ª—å–∫–æ –¥–ª—è –º–µ—Å—è—á–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏ –∏ –≤—ã—à–µ)."""
    uid = callback.from_user.id
    if not await is_full_access_active(uid):
        await callback.answer(
            "üîí –°–º–µ–Ω–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã –¥–æ—Å—Ç—É–ø–Ω–∞ –Ω–∞ —Ç–∞—Ä–∏—Ñ–∞—Ö 3 –º–µ—Å—è—Ü–∞ –∏ –ù–∞–≤—Å–µ–≥–¥–∞.",
            show_alert=True
        )
        return

    await callback.answer("üîÑ –ü–µ—Ä–µ—Å–æ–±–∏—Ä–∞—é –ø—Ä–æ–≥—Ä–∞–º–º—É‚Ä¶")

    # –ú–µ–Ω—è–µ–º seed (—Å–¥–≤–∏–≥–∞–µ–º –Ω–∞ —Å–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ) —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –¥—Ä—É–≥–æ–π —Ä–∞–Ω–¥–æ–º
    u = await get_user(uid)
    import random as _rnd
    shift = _rnd.randint(1, 9999)
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–¥–≤–∏–≥ –≤ –ø–æ–ª–µ state (–≤—Ä–µ–º–µ–Ω–Ω–æ), —á—Ç–æ–±—ã gen —Ñ—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–∏–ª–∞ –¥—Ä—É–≥–æ–π seed
    original_id = uid
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å –∏–∑–º–µ–Ω—ë–Ω–Ω—ã–º user_id (seed) –¥–ª—è —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è
    varied_id = uid + shift * 100

    intro, plan_struct = generate_workout_plan(
        u["goal"], u["place"], u["exp"], int(u["freq"] or 3),
        limits=u.get("limits") or "",
        user_id=varied_id
    )
    await save_workout_plan(uid, intro, dumps_plan(plan_struct))

    # –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –¥–Ω–µ–π
    async with db() as conn:
        await conn.execute("DELETE FROM workout_day_progress WHERE user_id=?", (uid,))
        await conn.commit()

    full_access = await is_full_access_active(uid)
    kb = workout_days_kb(int(u.get("freq") or plan_struct.get("freq") or 3), has_full_access=full_access, plan_struct=plan_struct)
    await clean_edit(callback, uid,
        intro + "\n\n‚úÖ –ü—Ä–æ–≥—Ä–∞–º–º–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞! –ü—Ä–æ–≥—Ä–µ—Å—Å –¥–Ω–µ–π —Å–±—Ä–æ—à–µ–Ω.",
        reply_markup=kb
    )


# =========================
# –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –û–ü–õ–ê–¢–´ (–ê–î–ú–ò–ù)
# =========================
async def cmd_testpay(message: Message, bot: Bot):
    """–ö–æ–º–∞–Ω–¥–∞ /testpay ‚Äî –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –Æ–ö–∞—Å—Å–∞ API (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∞)."""
    if message.from_user.id != ADMIN_ID:
        return

    lines = ["üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –Æ–ö–∞—Å—Å–∞\n"]
    lines.append(f"YUKASSA_SHOP_ID: {'‚úÖ ' + YUKASSA_SHOP_ID[:4] + '****' if YUKASSA_SHOP_ID else '‚ùå –Ω–µ –∑–∞–¥–∞–Ω'}")
    lines.append(f"YUKASSA_SECRET: {'‚úÖ –∑–∞–¥–∞–Ω' if YUKASSA_SECRET else '‚ùå –Ω–µ –∑–∞–¥–∞–Ω'}")
    lines.append(f"BOT_PUBLIC_URL: {BOT_PUBLIC_URL or '‚ùå –Ω–µ –∑–∞–¥–∞–Ω'}\n")

    if not YUKASSA_SHOP_ID or not YUKASSA_SECRET:
        lines.append("‚ùå –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–µ –∑–∞–¥–∞–Ω—ã!")
        await message.answer("\n".join(lines))
        return

    lines.append("‚è≥ –ü—Ä–æ–±—É—é —Å–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π –ø–ª–∞—Ç—ë–∂ (1‚ÇΩ)...")
    await message.answer("\n".join(lines))

    yk_data, yk_err = await yukassa_create_payment("trial", message.from_user.id)

    if yk_data:
        pay_id = yk_data.get("id", "?")
        conf_url = (yk_data.get("confirmation") or {}).get("confirmation_url", "?")
        await message.answer(
            f"‚úÖ –£—Å–ø–µ—à–Ω–æ! –ü–ª–∞—Ç—ë–∂ —Å–æ–∑–¥–∞–Ω.\n"
            f"ID: {pay_id}\n"
            f"URL: {conf_url[:60]}..."
        )
    else:
        await message.answer(
            f"‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø–ª–∞—Ç–µ–∂–∞:\n{yk_err}\n\n"
            "–ü—Ä–æ–≤–µ—Ä—å:\n"
            "1. YUKASSA_SHOP_ID –∏ YUKASSA_SECRET –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ\n"
            "2. –ú–∞–≥–∞–∑–∏–Ω –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω –≤ yukassa.ru\n"
            "3. IP —Å–µ—Ä–≤–µ—Ä–∞ –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –Æ–ö–∞—Å—Å–∞"
        )


# =========================
# –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø –•–ï–ù–î–õ–ï–†–û–í
# =========================
def setup_handlers(dp: Dispatcher):
    from aiogram.types import PreCheckoutQuery

    dp.message.register(cmd_start, CommandStart())

    dp.callback_query.register(cb_nav, F.data.startswith("nav:"))

    dp.callback_query.register(cb_profile_edit, F.data == "p:edit")
    dp.callback_query.register(cb_rebuild_plan, F.data == "p:rebuild_plan")
    dp.callback_query.register(cb_profile_start_wizard, F.data == "p:start_wizard")
    dp.callback_query.register(cb_build_program, F.data == "p:build_program")
    dp.callback_query.register(cb_profile_field_edit, F.data.startswith("pf:"))
    dp.callback_query.register(cb_profile_back, F.data.startswith("p:back:"))
    dp.callback_query.register(cb_profile_goal, F.data.startswith("p:goal:"))
    dp.callback_query.register(cb_profile_sex, F.data.startswith("p:sex:"))
    dp.callback_query.register(cb_profile_place, F.data.startswith("p:place:"))
    dp.callback_query.register(cb_profile_exp, F.data.startswith("p:exp:"))
    dp.callback_query.register(cb_profile_freq, F.data.startswith("p:freq:"))
    dp.callback_query.register(cb_profile_meals, F.data.startswith("p:meals:"))

    dp.message.register(profile_age_text, ProfileWizard.age)
    dp.message.register(profile_height_text, ProfileWizard.height)
    dp.message.register(profile_weight_text, ProfileWizard.weight)
    dp.message.register(profile_limits_text, ProfileWizard.limits)

    # –û–¥–∏–Ω–æ—á–Ω–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–µ–π
    dp.message.register(profile_field_age, ProfileFieldEdit.age)
    dp.message.register(profile_field_height, ProfileFieldEdit.height)
    dp.message.register(profile_field_weight, ProfileFieldEdit.weight)
    dp.message.register(profile_field_limits, ProfileFieldEdit.limits)

    # –Æ–ö–∞—Å—Å–∞ REST API
    dp.callback_query.register(cb_tariff, F.data.startswith("tariff:"))
    dp.callback_query.register(cb_check_payment, F.data.startswith("check_pay:"))

    # –†—É—á–Ω–æ–µ –æ–¥–æ–±—Ä–µ–Ω–∏–µ (–∑–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç)
    dp.callback_query.register(admin_actions, F.data.startswith("admin_approve:") | F.data.startswith("admin_reject:"))

    dp.callback_query.register(cb_measure_type, F.data.startswith("mtype:"))
    dp.callback_query.register(measures_history, F.data == "m:history")
    dp.message.register(measure_value, MeasureFlow.enter_value)

    dp.callback_query.register(diary_pick_ex, F.data.startswith("d:ex:"))
    dp.callback_query.register(diary_history, F.data == "d:history")
    dp.message.register(diary_enter_sets, DiaryFlow.enter_sets)

    dp.callback_query.register(cb_tech_list, F.data == "tech:list")
    dp.callback_query.register(cb_tech_show, F.data.startswith("tech:"))

    dp.callback_query.register(cb_nutr_example, F.data.startswith("nutr:ex:"))
    dp.callback_query.register(cb_nutr_back, F.data == "nutr:back")
    dp.callback_query.register(cb_nutr_basket, F.data == "nutr:basket")

    dp.callback_query.register(cb_faq_question, F.data.startswith("faq:"))

    dp.callback_query.register(cb_workout_day, F.data.startswith("wday:"))
    dp.callback_query.register(cb_workout_ex_done, F.data.startswith("wex:done:"))
    dp.callback_query.register(cb_workout_ex_tech, F.data.startswith("wex:tech:"))
    dp.callback_query.register(cb_workout_rebuild, F.data == "workout:rebuild")

    dp.message.register(cmd_testpay, Command("testpay"))
    dp.message.register(cmd_posts, Command("posts"))
    dp.callback_query.register(cb_post_new, F.data == "post:new")
    dp.callback_query.register(cb_post_cancel, F.data == "post:cancel")
    dp.callback_query.register(cb_post_send, F.data.startswith("post:send:"))
    dp.message.register(post_waiting_content, PostFlow.waiting_content)

    dp.message.register(open_payment_from_reply, F.text == "üí≥ –û–ø–ª–∞—Ç–∞/–¥–æ—Å—Ç—É–ø")
    dp.message.register(open_profile_from_reply, F.text == "‚öôÔ∏è –ü—Ä–æ—Ñ–∏–ª—å")
    dp.message.register(open_support_from_reply, F.text == "üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞")
    dp.message.register(open_menu_from_reply, F.text == "üè† –ú–µ–Ω—é")

    dp.message.register(forward_to_admin)


# =========================
# WEB SERVER (Render/health)
# =========================
async def run_web_server():
    app = web.Application()

    async def health(request):
        return web.Response(text="ok")

    app.router.add_get("/", health)

    runner = web.AppRunner(app)
    await runner.setup()

    port = int(os.getenv("PORT", 10000))
    site = web.TCPSite(runner, "0.0.0.0", port)
    await site.start()

    print(f"Web server started on port {port}")

    while True:
        await asyncio.sleep(3600)


# =========================
# MAIN
# =========================

# =========================
# –ù–ê–ü–û–ú–ò–ù–ê–ù–ò–Ø –û–ë –û–ö–û–ù–ß–ê–ù–ò–ò –ü–û–î–ü–ò–°–ö–ò
# =========================
async def _check_and_remind_subscriptions(bot: Bot):
    """–ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–ø–∏—Å–∫–∏ –∏ —Ä–∞—Å—Å—ã–ª–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏."""
    today = datetime.utcnow().date()
    async with db() as conn:
        async with conn.execute(
            """SELECT user_id, tariff, tariff_name, expires_at, remind_stage
               FROM access WHERE paid=1 AND expires_at IS NOT NULL"""
        ) as cur:
            rows = await cur.fetchall()

    for row in rows:
        user_id, tariff, tariff_name, expires_at, remind_stage = row
        remind_stage = remind_stage if remind_stage is not None else -1
        try:
            exp_dt = datetime.fromisoformat(expires_at)
            exp_date = exp_dt.date()
        except Exception:
            continue

        days_left = (exp_date - today).days

        # –ü–æ–¥–ø–∏—Å–∫–∞ –∏—Å—Ç–µ–∫–ª–∞ ‚Äî –¥–µ–∞–∫—Ç–∏–≤–∏—Ä—É–µ–º
        if days_left < 0:
            async with db() as conn:
                await conn.execute(
                    "UPDATE access SET paid=0 WHERE user_id=?", (user_id,)
                )
                await conn.commit()
            continue

        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –Ω—É–∂–Ω—É—é —Å—Ç–∞–¥–∏—é –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è
        send_stage = None
        if days_left == 3 and remind_stage < 3:
            send_stage = 3
        elif days_left == 1 and remind_stage < 1:
            send_stage = 1
        elif days_left == 0 and remind_stage < 0:
            send_stage = 0

        if send_stage is None:
            continue

        if days_left == 0:
            days_str = "—Å–µ–≥–æ–¥–Ω—è"
        elif days_left == 1:
            days_str = "–∑–∞–≤—Ç—Ä–∞"
        else:
            days_str = f"—á–µ—Ä–µ–∑ {days_left} –¥–Ω."

        text = (
            f"\u23f3 –ü–æ–¥–ø–∏—Å–∫–∞ —Å–∫–æ—Ä–æ –∑–∞–∫–æ–Ω—á–∏—Ç—Å—è: –æ—Å—Ç–∞–ª–æ—Å—å {days_left} –¥–Ω.\n\n"
            "–ß—Ç–æ–±—ã –Ω–µ –ø–æ—Ç–µ—Ä—è—Ç—å –¥–æ—Å—Ç—É–ø –∫ –ø–ª–∞–Ω—É –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ ‚Äî –ø—Ä–æ–¥–ª–∏ –ø–æ–¥–ø–∏—Å–∫—É \U0001f447"
        )
        kb = InlineKeyboardMarkup(inline_keyboard=[
            [InlineKeyboardButton(
                text="\U0001f4b3 –ü—Ä–æ–¥–ª–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É",
                callback_data="nav:upgrade"
            )]
        ])
        try:
            await bot.send_message(user_id, text, reply_markup=kb)
            async with db() as conn:
                await conn.execute(
                    "UPDATE access SET remind_stage=? WHERE user_id=?",
                    (send_stage, user_id)
                )
                await conn.commit()
        except Exception:
            pass  # –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª –±–æ—Ç–∞


async def subscription_reminder_loop(bot: Bot):
    """–§–æ–Ω–æ–≤–∞—è –∑–∞–¥–∞—á–∞: —Ä–∞–∑ –≤ 12 —á–∞—Å–æ–≤ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ø–∏—Å–∫–∏ –∏ —à–ª—ë—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è."""
    logger.info("subscription_reminder_loop started")
    while True:
        try:
            await _check_and_remind_subscriptions(bot)
        except Exception:
            logger.exception("subscription_reminder_loop error")
        await asyncio.sleep(12 * 3600)


async def main():
    if "PASTE_NEW_TOKEN_HERE" in BOT_TOKEN or not BOT_TOKEN or BOT_TOKEN == "0":
        raise RuntimeError("–ù—É–∂–Ω–æ –∑–∞–¥–∞—Ç—å BOT_TOKEN —á–µ—Ä–µ–∑ ENV.")

    if ADMIN_ID == 0:
        logger.warning("ADMIN_ID –Ω–µ –∑–∞–¥–∞–Ω. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –æ–ø–ª–∞—Ç–∞—Ö –Ω–µ –±—É–¥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è.")

    if not YUKASSA_SHOP_ID or not YUKASSA_SECRET:
        logger.warning("YUKASSA_SHOP_ID –∏–ª–∏ YUKASSA_SECRET –Ω–µ –∑–∞–¥–∞–Ω—ã. –û–ø–ª–∞—Ç–∞ —á–µ—Ä–µ–∑ –Æ–ö–∞—Å—Å–∞ –Ω–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å.")

    await init_db()

    bot = Bot(token=BOT_TOKEN)
    await bot.delete_webhook(drop_pending_updates=True)
    logger.info("Webhook cleared, starting polling...")

    dp = Dispatcher()
    setup_handlers(dp)

    async def bot_loop():
        backoff = 2
        while True:
            try:
                logger.info("Bot polling started.")
                await dp.start_polling(bot, allowed_updates=dp.resolve_used_update_types())
            except Exception:
                logger.exception("Polling crashed. Restarting...")
                await asyncio.sleep(backoff)
                backoff = min(backoff * 2, 60)
            else:
                backoff = 2
                await asyncio.sleep(2)

    await asyncio.gather(
        bot_loop(),
        run_web_server(),
        subscription_reminder_loop(bot),
    )

if __name__ == "__main__":
    try:
        asyncio.run(main())
    except KeyboardInterrupt:
        pass



